2025-05-03 04:56:18.741 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 04:56:18.837 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 04:56:20.509 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 04:56:59.591 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 04:56:59.784 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 04:57:01.211 +03:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 04:57:01.360 +03:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 04:57:01.372 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 04:57:01.380 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 04:57:01.565 +03:00 [INF] Executed DbCommand (98ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 04:57:01.597 +03:00 [INF] Applying migration '20250503015621_addLessons'.
2025-05-03 04:57:02.355 +03:00 [INF] Executed DbCommand (366ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] DROP CONSTRAINT [FK_Payments_Courses_CourseId];
2025-05-03 04:57:02.374 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] DROP CONSTRAINT [FK_Payments_Courses_CourseId1];
2025-05-03 04:57:02.416 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] DROP CONSTRAINT [FK_Payments_Users_UserId];
2025-05-03 04:57:02.441 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] DROP CONSTRAINT [FK_QuizResults_Quizzes_QuizId];
2025-05-03 04:57:02.466 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] DROP CONSTRAINT [FK_QuizResults_Quizzes_QuizId1];
2025-05-03 04:57:02.508 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] DROP CONSTRAINT [FK_QuizResults_Users_UserId];
2025-05-03 04:57:02.542 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] DROP CONSTRAINT [FK_Quizzes_Courses_CourseId];
2025-05-03 04:57:02.706 +03:00 [INF] Executed DbCommand (136ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Reviews] DROP CONSTRAINT [FK_Reviews_Courses_CourseId];
2025-05-03 04:57:02.748 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Reviews] DROP CONSTRAINT [FK_Reviews_Users_UserId];
2025-05-03 04:57:02.766 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [UserRefreshTokens] DROP CONSTRAINT [FK_UserRefreshTokens_Users_UserId];
2025-05-03 04:57:02.834 +03:00 [INF] Executed DbCommand (59ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP TABLE [Choices];
2025-05-03 04:57:02.869 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_UserRefreshTokens_UserId] ON [UserRefreshTokens];
2025-05-03 04:57:02.885 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_QuizResults_QuizId] ON [QuizResults];
2025-05-03 04:57:02.905 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_QuizResults_QuizId1] ON [QuizResults];
2025-05-03 04:57:02.924 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_QuizResults_UserId] ON [QuizResults];
2025-05-03 04:57:02.956 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Payments_CourseId1] ON [Payments];
2025-05-03 04:57:03.049 +03:00 [INF] Executed DbCommand (79ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Lessons_CourseId] ON [Lessons];
2025-05-03 04:57:03.327 +03:00 [INF] Executed DbCommand (257ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[QuizResults]') AND [c].[name] = N'CorrectAnswers');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [QuizResults] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [QuizResults] DROP COLUMN [CorrectAnswers];
2025-05-03 04:57:03.375 +03:00 [INF] Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var1 sysname;
SELECT @var1 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[QuizResults]') AND [c].[name] = N'QuizId1');
IF @var1 IS NOT NULL EXEC(N'ALTER TABLE [QuizResults] DROP CONSTRAINT [' + @var1 + '];');
ALTER TABLE [QuizResults] DROP COLUMN [QuizId1];
2025-05-03 04:57:03.447 +03:00 [INF] Executed DbCommand (67ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var2 sysname;
SELECT @var2 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Payments]') AND [c].[name] = N'CourseId1');
IF @var2 IS NOT NULL EXEC(N'ALTER TABLE [Payments] DROP CONSTRAINT [' + @var2 + '];');
ALTER TABLE [Payments] DROP COLUMN [CourseId1];
2025-05-03 04:57:03.572 +03:00 [INF] Executed DbCommand (115ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var3 sysname;
SELECT @var3 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Lessons]') AND [c].[name] = N'AttachmentUrl');
IF @var3 IS NOT NULL EXEC(N'ALTER TABLE [Lessons] DROP CONSTRAINT [' + @var3 + '];');
ALTER TABLE [Lessons] DROP COLUMN [AttachmentUrl];
2025-05-03 04:57:05.118 +03:00 [INF] Executed DbCommand (1,515ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[QuizResults].[TotalQuestions]', N'Status', N'COLUMN';
2025-05-03 04:57:05.136 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[QuizResults].[SubmittedAt]', N'StartedAt', N'COLUMN';
2025-05-03 04:57:05.323 +03:00 [INF] Executed DbCommand (183ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var4 sysname;
SELECT @var4 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Users]') AND [c].[name] = N'Email');
IF @var4 IS NOT NULL EXEC(N'ALTER TABLE [Users] DROP CONSTRAINT [' + @var4 + '];');
ALTER TABLE [Users] ALTER COLUMN [Email] nvarchar(450) NULL;
2025-05-03 04:57:05.374 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD [UserGuid] nvarchar(36) NOT NULL DEFAULT N'';
2025-05-03 04:57:05.387 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [UserRefreshTokens] ADD [UserGuid] nvarchar(36) NOT NULL DEFAULT N'';
2025-05-03 04:57:05.471 +03:00 [INF] Executed DbCommand (80ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var5 sysname;
SELECT @var5 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Quizzes]') AND [c].[name] = N'Title');
IF @var5 IS NOT NULL EXEC(N'ALTER TABLE [Quizzes] DROP CONSTRAINT [' + @var5 + '];');
UPDATE [Quizzes] SET [Title] = N'' WHERE [Title] IS NULL;
ALTER TABLE [Quizzes] ALTER COLUMN [Title] nvarchar(max) NOT NULL;
ALTER TABLE [Quizzes] ADD DEFAULT N'' FOR [Title];
2025-05-03 04:57:05.551 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var6 sysname;
SELECT @var6 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Quizzes]') AND [c].[name] = N'CourseId');
IF @var6 IS NOT NULL EXEC(N'ALTER TABLE [Quizzes] DROP CONSTRAINT [' + @var6 + '];');
ALTER TABLE [Quizzes] ALTER COLUMN [CourseId] int NULL;
2025-05-03 04:57:05.585 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE());
2025-05-03 04:57:05.602 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [CreatedBy] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 04:57:05.634 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [Description] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 04:57:05.654 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [IsMandatory] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 04:57:05.667 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [LessonId] int NOT NULL DEFAULT 0;
2025-05-03 04:57:05.685 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [LessonId1] int NULL;
2025-05-03 04:57:05.704 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [MaxAttempts] int NOT NULL DEFAULT 0;
2025-05-03 04:57:05.722 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [PassingScore] int NOT NULL DEFAULT 70;
2025-05-03 04:57:05.740 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [Status] int NOT NULL DEFAULT 0;
2025-05-03 04:57:05.786 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [TimeLimitMinutes] int NOT NULL DEFAULT 0;
2025-05-03 04:57:05.890 +03:00 [INF] Executed DbCommand (100ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var7 sysname;
SELECT @var7 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[QuizResults]') AND [c].[name] = N'UserId');
IF @var7 IS NOT NULL EXEC(N'ALTER TABLE [QuizResults] DROP CONSTRAINT [' + @var7 + '];');
ALTER TABLE [QuizResults] ALTER COLUMN [UserId] nvarchar(450) NOT NULL;
2025-05-03 04:57:05.923 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [CompletedAt] datetime2 NULL;
2025-05-03 04:57:05.951 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [IsPassed] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 04:57:05.967 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [Score] decimal(5,2) NOT NULL DEFAULT 0.0;
2025-05-03 04:57:05.982 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [UserGuid] nvarchar(36) NOT NULL DEFAULT N'';
2025-05-03 04:57:06.085 +03:00 [INF] Executed DbCommand (99ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var8 sysname;
SELECT @var8 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Questions]') AND [c].[name] = N'Text');
IF @var8 IS NOT NULL EXEC(N'ALTER TABLE [Questions] DROP CONSTRAINT [' + @var8 + '];');
UPDATE [Questions] SET [Text] = N'' WHERE [Text] IS NULL;
ALTER TABLE [Questions] ALTER COLUMN [Text] nvarchar(max) NOT NULL;
ALTER TABLE [Questions] ADD DEFAULT N'' FOR [Text];
2025-05-03 04:57:06.111 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Questions] ADD [Points] int NOT NULL DEFAULT 0;
2025-05-03 04:57:06.122 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Questions] ADD [Type] int NOT NULL DEFAULT 0;
2025-05-03 04:57:06.198 +03:00 [INF] Executed DbCommand (66ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var9 sysname;
SELECT @var9 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Lessons]') AND [c].[name] = N'VideoUrl');
IF @var9 IS NOT NULL EXEC(N'ALTER TABLE [Lessons] DROP CONSTRAINT [' + @var9 + '];');
UPDATE [Lessons] SET [VideoUrl] = N'' WHERE [VideoUrl] IS NULL;
ALTER TABLE [Lessons] ALTER COLUMN [VideoUrl] nvarchar(max) NOT NULL;
ALTER TABLE [Lessons] ADD DEFAULT N'' FOR [VideoUrl];
2025-05-03 04:57:06.261 +03:00 [INF] Executed DbCommand (56ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var10 sysname;
SELECT @var10 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Lessons]') AND [c].[name] = N'Title');
IF @var10 IS NOT NULL EXEC(N'ALTER TABLE [Lessons] DROP CONSTRAINT [' + @var10 + '];');
UPDATE [Lessons] SET [Title] = N'' WHERE [Title] IS NULL;
ALTER TABLE [Lessons] ALTER COLUMN [Title] nvarchar(200) NOT NULL;
ALTER TABLE [Lessons] ADD DEFAULT N'' FOR [Title];
2025-05-03 04:57:06.278 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Content] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 04:57:06.291 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE());
2025-05-03 04:57:06.315 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [CreatedBy] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 04:57:06.334 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Description] nvarchar(1000) NOT NULL DEFAULT N'';
2025-05-03 04:57:06.400 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Duration] int NOT NULL DEFAULT 0;
2025-05-03 04:57:06.409 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [IsFree] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 04:57:06.423 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [IsSequential] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 04:57:06.434 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Order] int NOT NULL DEFAULT 0;
2025-05-03 04:57:06.445 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [PdfUrl] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 04:57:06.454 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Type] nvarchar(20) NOT NULL DEFAULT N'';
2025-05-03 04:57:06.469 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [UpdatedAt] datetime2 NULL;
2025-05-03 04:57:06.589 +03:00 [INF] Executed DbCommand (117ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var11 sysname;
SELECT @var11 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Courses]') AND [c].[name] = N'Title');
IF @var11 IS NOT NULL EXEC(N'ALTER TABLE [Courses] DROP CONSTRAINT [' + @var11 + '];');
ALTER TABLE [Courses] ALTER COLUMN [Title] nvarchar(450) NULL;
2025-05-03 04:57:06.626 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Courses] ADD [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE());
2025-05-03 04:57:06.689 +03:00 [INF] Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Courses] ADD [CreatedBy] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 04:57:06.713 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Courses] ADD [UpdatedAt] datetime2 NULL;
2025-05-03 04:57:06.872 +03:00 [ERR] Failed executing DbCommand (142ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD CONSTRAINT [AK_Users_UserGuid] UNIQUE ([UserGuid]);
2025-05-03 05:06:13.406 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 05:06:13.517 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 05:06:14.027 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 05:08:03.382 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 05:08:03.507 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 05:08:04.350 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 05:08:04.400 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 05:08:04.414 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 05:08:04.424 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 05:08:04.494 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 05:08:04.528 +03:00 [INF] Applying migration '20250503015621_addLessons'.
2025-05-03 05:08:04.784 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] DROP CONSTRAINT [FK_Payments_Courses_CourseId];
2025-05-03 05:08:04.794 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] DROP CONSTRAINT [FK_Payments_Courses_CourseId1];
2025-05-03 05:08:04.808 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] DROP CONSTRAINT [FK_Payments_Users_UserId];
2025-05-03 05:08:04.829 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] DROP CONSTRAINT [FK_QuizResults_Quizzes_QuizId];
2025-05-03 05:08:04.843 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] DROP CONSTRAINT [FK_QuizResults_Quizzes_QuizId1];
2025-05-03 05:08:04.858 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] DROP CONSTRAINT [FK_QuizResults_Users_UserId];
2025-05-03 05:08:04.873 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] DROP CONSTRAINT [FK_Quizzes_Courses_CourseId];
2025-05-03 05:08:04.897 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Reviews] DROP CONSTRAINT [FK_Reviews_Courses_CourseId];
2025-05-03 05:08:04.910 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Reviews] DROP CONSTRAINT [FK_Reviews_Users_UserId];
2025-05-03 05:08:04.940 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [UserRefreshTokens] DROP CONSTRAINT [FK_UserRefreshTokens_Users_UserId];
2025-05-03 05:08:05.001 +03:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP TABLE [Choices];
2025-05-03 05:08:05.050 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_UserRefreshTokens_UserId] ON [UserRefreshTokens];
2025-05-03 05:08:05.073 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_QuizResults_QuizId] ON [QuizResults];
2025-05-03 05:08:05.109 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_QuizResults_QuizId1] ON [QuizResults];
2025-05-03 05:08:05.135 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_QuizResults_UserId] ON [QuizResults];
2025-05-03 05:08:05.146 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Payments_CourseId1] ON [Payments];
2025-05-03 05:08:05.156 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Lessons_CourseId] ON [Lessons];
2025-05-03 05:08:05.214 +03:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[QuizResults]') AND [c].[name] = N'CorrectAnswers');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [QuizResults] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [QuizResults] DROP COLUMN [CorrectAnswers];
2025-05-03 05:08:05.254 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var1 sysname;
SELECT @var1 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[QuizResults]') AND [c].[name] = N'QuizId1');
IF @var1 IS NOT NULL EXEC(N'ALTER TABLE [QuizResults] DROP CONSTRAINT [' + @var1 + '];');
ALTER TABLE [QuizResults] DROP COLUMN [QuizId1];
2025-05-03 05:08:05.279 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var2 sysname;
SELECT @var2 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Payments]') AND [c].[name] = N'CourseId1');
IF @var2 IS NOT NULL EXEC(N'ALTER TABLE [Payments] DROP CONSTRAINT [' + @var2 + '];');
ALTER TABLE [Payments] DROP COLUMN [CourseId1];
2025-05-03 05:08:05.306 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var3 sysname;
SELECT @var3 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Lessons]') AND [c].[name] = N'AttachmentUrl');
IF @var3 IS NOT NULL EXEC(N'ALTER TABLE [Lessons] DROP CONSTRAINT [' + @var3 + '];');
ALTER TABLE [Lessons] DROP COLUMN [AttachmentUrl];
2025-05-03 05:08:05.729 +03:00 [INF] Executed DbCommand (418ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[QuizResults].[TotalQuestions]', N'Status', N'COLUMN';
2025-05-03 05:08:05.743 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[QuizResults].[SubmittedAt]', N'StartedAt', N'COLUMN';
2025-05-03 05:08:05.785 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var4 sysname;
SELECT @var4 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Users]') AND [c].[name] = N'Email');
IF @var4 IS NOT NULL EXEC(N'ALTER TABLE [Users] DROP CONSTRAINT [' + @var4 + '];');
ALTER TABLE [Users] ALTER COLUMN [Email] nvarchar(450) NULL;
2025-05-03 05:08:05.793 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD [UserGuid] nvarchar(36) NOT NULL DEFAULT N'';
2025-05-03 05:08:05.800 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [UserRefreshTokens] ADD [UserGuid] nvarchar(36) NOT NULL DEFAULT N'';
2025-05-03 05:08:05.827 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var5 sysname;
SELECT @var5 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Quizzes]') AND [c].[name] = N'Title');
IF @var5 IS NOT NULL EXEC(N'ALTER TABLE [Quizzes] DROP CONSTRAINT [' + @var5 + '];');
UPDATE [Quizzes] SET [Title] = N'' WHERE [Title] IS NULL;
ALTER TABLE [Quizzes] ALTER COLUMN [Title] nvarchar(max) NOT NULL;
ALTER TABLE [Quizzes] ADD DEFAULT N'' FOR [Title];
2025-05-03 05:08:05.862 +03:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var6 sysname;
SELECT @var6 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Quizzes]') AND [c].[name] = N'CourseId');
IF @var6 IS NOT NULL EXEC(N'ALTER TABLE [Quizzes] DROP CONSTRAINT [' + @var6 + '];');
ALTER TABLE [Quizzes] ALTER COLUMN [CourseId] int NULL;
2025-05-03 05:08:05.887 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE());
2025-05-03 05:08:05.907 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [CreatedBy] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:08:05.914 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [Description] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:08:05.925 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [IsMandatory] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 05:08:05.934 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [LessonId] int NOT NULL DEFAULT 0;
2025-05-03 05:08:05.944 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [LessonId1] int NULL;
2025-05-03 05:08:05.955 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [MaxAttempts] int NOT NULL DEFAULT 0;
2025-05-03 05:08:05.974 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [PassingScore] int NOT NULL DEFAULT 70;
2025-05-03 05:08:05.982 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [Status] int NOT NULL DEFAULT 0;
2025-05-03 05:08:05.995 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [TimeLimitMinutes] int NOT NULL DEFAULT 0;
2025-05-03 05:08:06.153 +03:00 [INF] Executed DbCommand (153ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var7 sysname;
SELECT @var7 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[QuizResults]') AND [c].[name] = N'UserId');
IF @var7 IS NOT NULL EXEC(N'ALTER TABLE [QuizResults] DROP CONSTRAINT [' + @var7 + '];');
ALTER TABLE [QuizResults] ALTER COLUMN [UserId] nvarchar(450) NOT NULL;
2025-05-03 05:08:06.166 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [CompletedAt] datetime2 NULL;
2025-05-03 05:08:06.189 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [IsPassed] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 05:08:06.218 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [Score] decimal(5,2) NOT NULL DEFAULT 0.0;
2025-05-03 05:08:06.232 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [UserGuid] nvarchar(36) NOT NULL DEFAULT N'';
2025-05-03 05:08:06.287 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var8 sysname;
SELECT @var8 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Questions]') AND [c].[name] = N'Text');
IF @var8 IS NOT NULL EXEC(N'ALTER TABLE [Questions] DROP CONSTRAINT [' + @var8 + '];');
UPDATE [Questions] SET [Text] = N'' WHERE [Text] IS NULL;
ALTER TABLE [Questions] ALTER COLUMN [Text] nvarchar(max) NOT NULL;
ALTER TABLE [Questions] ADD DEFAULT N'' FOR [Text];
2025-05-03 05:08:06.295 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Questions] ADD [Points] int NOT NULL DEFAULT 0;
2025-05-03 05:08:06.304 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Questions] ADD [Type] int NOT NULL DEFAULT 0;
2025-05-03 05:08:06.332 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var9 sysname;
SELECT @var9 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Lessons]') AND [c].[name] = N'VideoUrl');
IF @var9 IS NOT NULL EXEC(N'ALTER TABLE [Lessons] DROP CONSTRAINT [' + @var9 + '];');
UPDATE [Lessons] SET [VideoUrl] = N'' WHERE [VideoUrl] IS NULL;
ALTER TABLE [Lessons] ALTER COLUMN [VideoUrl] nvarchar(max) NOT NULL;
ALTER TABLE [Lessons] ADD DEFAULT N'' FOR [VideoUrl];
2025-05-03 05:08:06.375 +03:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var10 sysname;
SELECT @var10 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Lessons]') AND [c].[name] = N'Title');
IF @var10 IS NOT NULL EXEC(N'ALTER TABLE [Lessons] DROP CONSTRAINT [' + @var10 + '];');
UPDATE [Lessons] SET [Title] = N'' WHERE [Title] IS NULL;
ALTER TABLE [Lessons] ALTER COLUMN [Title] nvarchar(200) NOT NULL;
ALTER TABLE [Lessons] ADD DEFAULT N'' FOR [Title];
2025-05-03 05:08:06.390 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Content] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:08:06.401 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE());
2025-05-03 05:08:06.410 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [CreatedBy] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:08:06.421 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Description] nvarchar(1000) NOT NULL DEFAULT N'';
2025-05-03 05:08:06.430 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Duration] int NOT NULL DEFAULT 0;
2025-05-03 05:08:06.442 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [IsFree] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 05:08:06.456 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [IsSequential] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 05:08:06.490 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Order] int NOT NULL DEFAULT 0;
2025-05-03 05:08:06.509 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [PdfUrl] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:08:06.517 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Type] nvarchar(20) NOT NULL DEFAULT N'';
2025-05-03 05:08:06.529 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [UpdatedAt] datetime2 NULL;
2025-05-03 05:08:06.596 +03:00 [INF] Executed DbCommand (64ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var11 sysname;
SELECT @var11 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Courses]') AND [c].[name] = N'Title');
IF @var11 IS NOT NULL EXEC(N'ALTER TABLE [Courses] DROP CONSTRAINT [' + @var11 + '];');
ALTER TABLE [Courses] ALTER COLUMN [Title] nvarchar(450) NULL;
2025-05-03 05:08:06.606 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Courses] ADD [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE());
2025-05-03 05:08:06.626 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Courses] ADD [CreatedBy] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:08:06.636 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Courses] ADD [UpdatedAt] datetime2 NULL;
2025-05-03 05:08:06.688 +03:00 [ERR] Failed executing DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD CONSTRAINT [AK_Users_UserGuid] UNIQUE ([UserGuid]);
2025-05-03 05:12:07.439 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 05:12:07.558 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 05:12:08.290 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 05:12:08.329 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 05:12:08.340 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 05:12:08.358 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 05:12:08.391 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 05:12:08.434 +03:00 [INF] Applying migration '20250503015621_addLessons'.
2025-05-03 05:12:08.705 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] DROP CONSTRAINT [FK_Payments_Courses_CourseId];
2025-05-03 05:12:08.728 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] DROP CONSTRAINT [FK_Payments_Courses_CourseId1];
2025-05-03 05:12:08.741 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] DROP CONSTRAINT [FK_Payments_Users_UserId];
2025-05-03 05:12:08.753 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] DROP CONSTRAINT [FK_QuizResults_Quizzes_QuizId];
2025-05-03 05:12:08.761 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] DROP CONSTRAINT [FK_QuizResults_Quizzes_QuizId1];
2025-05-03 05:12:08.769 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] DROP CONSTRAINT [FK_QuizResults_Users_UserId];
2025-05-03 05:12:08.777 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] DROP CONSTRAINT [FK_Quizzes_Courses_CourseId];
2025-05-03 05:12:08.788 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Reviews] DROP CONSTRAINT [FK_Reviews_Courses_CourseId];
2025-05-03 05:12:08.799 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Reviews] DROP CONSTRAINT [FK_Reviews_Users_UserId];
2025-05-03 05:12:08.807 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [UserRefreshTokens] DROP CONSTRAINT [FK_UserRefreshTokens_Users_UserId];
2025-05-03 05:12:08.835 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP TABLE [Choices];
2025-05-03 05:12:08.861 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_UserRefreshTokens_UserId] ON [UserRefreshTokens];
2025-05-03 05:12:08.883 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_QuizResults_QuizId] ON [QuizResults];
2025-05-03 05:12:08.902 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_QuizResults_QuizId1] ON [QuizResults];
2025-05-03 05:12:08.919 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_QuizResults_UserId] ON [QuizResults];
2025-05-03 05:12:08.939 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Payments_CourseId1] ON [Payments];
2025-05-03 05:12:08.988 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Lessons_CourseId] ON [Lessons];
2025-05-03 05:12:09.068 +03:00 [INF] Executed DbCommand (60ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[QuizResults]') AND [c].[name] = N'CorrectAnswers');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [QuizResults] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [QuizResults] DROP COLUMN [CorrectAnswers];
2025-05-03 05:12:09.110 +03:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var1 sysname;
SELECT @var1 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[QuizResults]') AND [c].[name] = N'QuizId1');
IF @var1 IS NOT NULL EXEC(N'ALTER TABLE [QuizResults] DROP CONSTRAINT [' + @var1 + '];');
ALTER TABLE [QuizResults] DROP COLUMN [QuizId1];
2025-05-03 05:12:09.146 +03:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var2 sysname;
SELECT @var2 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Payments]') AND [c].[name] = N'CourseId1');
IF @var2 IS NOT NULL EXEC(N'ALTER TABLE [Payments] DROP CONSTRAINT [' + @var2 + '];');
ALTER TABLE [Payments] DROP COLUMN [CourseId1];
2025-05-03 05:12:09.174 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var3 sysname;
SELECT @var3 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Lessons]') AND [c].[name] = N'AttachmentUrl');
IF @var3 IS NOT NULL EXEC(N'ALTER TABLE [Lessons] DROP CONSTRAINT [' + @var3 + '];');
ALTER TABLE [Lessons] DROP COLUMN [AttachmentUrl];
2025-05-03 05:12:09.663 +03:00 [INF] Executed DbCommand (485ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[QuizResults].[TotalQuestions]', N'Status', N'COLUMN';
2025-05-03 05:12:09.670 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[QuizResults].[SubmittedAt]', N'StartedAt', N'COLUMN';
2025-05-03 05:12:09.712 +03:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var4 sysname;
SELECT @var4 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Users]') AND [c].[name] = N'Email');
IF @var4 IS NOT NULL EXEC(N'ALTER TABLE [Users] DROP CONSTRAINT [' + @var4 + '];');
ALTER TABLE [Users] ALTER COLUMN [Email] nvarchar(450) NULL;
2025-05-03 05:12:09.721 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD [UserGuid] nvarchar(36) NOT NULL DEFAULT N'';
2025-05-03 05:12:09.732 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [UserRefreshTokens] ADD [UserGuid] nvarchar(36) NOT NULL DEFAULT N'';
2025-05-03 05:12:09.786 +03:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var5 sysname;
SELECT @var5 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Quizzes]') AND [c].[name] = N'Title');
IF @var5 IS NOT NULL EXEC(N'ALTER TABLE [Quizzes] DROP CONSTRAINT [' + @var5 + '];');
UPDATE [Quizzes] SET [Title] = N'' WHERE [Title] IS NULL;
ALTER TABLE [Quizzes] ALTER COLUMN [Title] nvarchar(max) NOT NULL;
ALTER TABLE [Quizzes] ADD DEFAULT N'' FOR [Title];
2025-05-03 05:12:09.827 +03:00 [INF] Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var6 sysname;
SELECT @var6 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Quizzes]') AND [c].[name] = N'CourseId');
IF @var6 IS NOT NULL EXEC(N'ALTER TABLE [Quizzes] DROP CONSTRAINT [' + @var6 + '];');
ALTER TABLE [Quizzes] ALTER COLUMN [CourseId] int NULL;
2025-05-03 05:12:09.838 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE());
2025-05-03 05:12:09.845 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [CreatedBy] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:12:09.855 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [Description] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:12:09.867 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [IsMandatory] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 05:12:09.874 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [LessonId] int NOT NULL DEFAULT 0;
2025-05-03 05:12:09.884 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [LessonId1] int NULL;
2025-05-03 05:12:09.890 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [MaxAttempts] int NOT NULL DEFAULT 0;
2025-05-03 05:12:09.899 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [PassingScore] int NOT NULL DEFAULT 70;
2025-05-03 05:12:09.907 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [Status] int NOT NULL DEFAULT 0;
2025-05-03 05:12:09.916 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [TimeLimitMinutes] int NOT NULL DEFAULT 0;
2025-05-03 05:12:09.963 +03:00 [INF] Executed DbCommand (43ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var7 sysname;
SELECT @var7 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[QuizResults]') AND [c].[name] = N'UserId');
IF @var7 IS NOT NULL EXEC(N'ALTER TABLE [QuizResults] DROP CONSTRAINT [' + @var7 + '];');
ALTER TABLE [QuizResults] ALTER COLUMN [UserId] nvarchar(450) NOT NULL;
2025-05-03 05:12:09.970 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [CompletedAt] datetime2 NULL;
2025-05-03 05:12:09.979 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [IsPassed] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 05:12:09.988 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [Score] decimal(5,2) NOT NULL DEFAULT 0.0;
2025-05-03 05:12:10.004 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [UserGuid] nvarchar(36) NOT NULL DEFAULT N'';
2025-05-03 05:12:10.055 +03:00 [INF] Executed DbCommand (47ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var8 sysname;
SELECT @var8 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Questions]') AND [c].[name] = N'Text');
IF @var8 IS NOT NULL EXEC(N'ALTER TABLE [Questions] DROP CONSTRAINT [' + @var8 + '];');
UPDATE [Questions] SET [Text] = N'' WHERE [Text] IS NULL;
ALTER TABLE [Questions] ALTER COLUMN [Text] nvarchar(max) NOT NULL;
ALTER TABLE [Questions] ADD DEFAULT N'' FOR [Text];
2025-05-03 05:12:10.068 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Questions] ADD [Points] int NOT NULL DEFAULT 0;
2025-05-03 05:12:10.076 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Questions] ADD [Type] int NOT NULL DEFAULT 0;
2025-05-03 05:12:10.129 +03:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var9 sysname;
SELECT @var9 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Lessons]') AND [c].[name] = N'VideoUrl');
IF @var9 IS NOT NULL EXEC(N'ALTER TABLE [Lessons] DROP CONSTRAINT [' + @var9 + '];');
UPDATE [Lessons] SET [VideoUrl] = N'' WHERE [VideoUrl] IS NULL;
ALTER TABLE [Lessons] ALTER COLUMN [VideoUrl] nvarchar(max) NOT NULL;
ALTER TABLE [Lessons] ADD DEFAULT N'' FOR [VideoUrl];
2025-05-03 05:12:10.187 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var10 sysname;
SELECT @var10 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Lessons]') AND [c].[name] = N'Title');
IF @var10 IS NOT NULL EXEC(N'ALTER TABLE [Lessons] DROP CONSTRAINT [' + @var10 + '];');
UPDATE [Lessons] SET [Title] = N'' WHERE [Title] IS NULL;
ALTER TABLE [Lessons] ALTER COLUMN [Title] nvarchar(200) NOT NULL;
ALTER TABLE [Lessons] ADD DEFAULT N'' FOR [Title];
2025-05-03 05:12:10.194 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Content] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:12:10.202 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE());
2025-05-03 05:12:10.209 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [CreatedBy] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:12:10.219 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Description] nvarchar(1000) NOT NULL DEFAULT N'';
2025-05-03 05:12:10.226 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Duration] int NOT NULL DEFAULT 0;
2025-05-03 05:12:10.237 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [IsFree] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 05:12:10.246 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [IsSequential] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 05:12:10.256 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Order] int NOT NULL DEFAULT 0;
2025-05-03 05:12:10.266 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [PdfUrl] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:12:10.273 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Type] nvarchar(20) NOT NULL DEFAULT N'';
2025-05-03 05:12:10.281 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [UpdatedAt] datetime2 NULL;
2025-05-03 05:12:10.323 +03:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var11 sysname;
SELECT @var11 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Courses]') AND [c].[name] = N'Title');
IF @var11 IS NOT NULL EXEC(N'ALTER TABLE [Courses] DROP CONSTRAINT [' + @var11 + '];');
ALTER TABLE [Courses] ALTER COLUMN [Title] nvarchar(450) NULL;
2025-05-03 05:12:10.331 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Courses] ADD [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE());
2025-05-03 05:12:10.344 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Courses] ADD [CreatedBy] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:12:10.353 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Courses] ADD [UpdatedAt] datetime2 NULL;
2025-05-03 05:12:10.395 +03:00 [ERR] Failed executing DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD CONSTRAINT [AK_Users_UserGuid] UNIQUE ([UserGuid]);
2025-05-03 05:15:56.099 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 05:15:56.222 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 05:15:56.952 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 05:16:00.210 +03:00 [INF] Executed DbCommand (3,176ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [E_LearningDB] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2025-05-03 05:16:00.688 +03:00 [INF] Executed DbCommand (464ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [E_LearningDB];
2025-05-03 05:18:32.951 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 05:18:33.071 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 05:18:34.207 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 05:18:34.991 +03:00 [INF] Executed DbCommand (612ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [E_LearningDB];
2025-05-03 05:18:35.248 +03:00 [INF] Executed DbCommand (245ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [E_LearningDB] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-05-03 05:18:35.320 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 05:18:35.452 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-05-03 05:18:35.462 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 05:18:35.489 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 05:18:35.512 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 05:18:35.543 +03:00 [INF] Applying migration '20250502160239_UpadateNotifications'.
2025-05-03 05:18:35.735 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-05-03 05:18:35.750 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [EmailConfirmationCodes] (
    [Id] int NOT NULL IDENTITY,
    [Email] nvarchar(450) NOT NULL,
    [Code] nvarchar(6) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_EmailConfirmationCodes] PRIMARY KEY ([Id])
);
2025-05-03 05:18:35.761 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PasswordResetCodes] (
    [Id] int NOT NULL IDENTITY,
    [Email] nvarchar(450) NOT NULL,
    [Code] nvarchar(6) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_PasswordResetCodes] PRIMARY KEY ([Id])
);
2025-05-03 05:18:35.769 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] int NOT NULL IDENTITY,
    [FullName] nvarchar(max) NULL,
    [Email] nvarchar(max) NULL,
    [PasswordHash] nvarchar(max) NULL,
    [Role] nvarchar(max) NOT NULL,
    [IsEmailConfirmed] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id])
);
2025-05-03 05:18:35.786 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Courses] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    [Title] nvarchar(max) NULL,
    [Description] nvarchar(max) NULL,
    [Price] decimal(18,2) NOT NULL,
    [ImageUrl] nvarchar(max) NULL,
    [IsActive] bit NULL,
    [CategoryId] int NOT NULL,
    [InstructorId] int NOT NULL,
    CONSTRAINT [PK_Courses] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Courses_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Courses_Users_InstructorId] FOREIGN KEY ([InstructorId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 05:18:35.800 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Notifications] (
    [Id] uniqueidentifier NOT NULL,
    [Title] nvarchar(100) NOT NULL,
    [Message] nvarchar(max) NOT NULL,
    [UserId] int NOT NULL,
    [SenderId] nvarchar(max) NULL,
    [IsRead] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NULL,
    [NotificationType] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Notifications] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Notifications_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:18:35.811 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Profiles] (
    [Id] int NOT NULL IDENTITY,
    [Bio] nvarchar(max) NULL,
    [ProfilePicture] nvarchar(max) NULL,
    [Address] nvarchar(max) NULL,
    [Phone] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_Profiles] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Profiles_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:18:35.826 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserRefreshTokens] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [RefreshToken] nvarchar(450) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_UserRefreshTokens] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_UserRefreshTokens_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:18:35.839 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Enrollments] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [CourseId] int NOT NULL,
    CONSTRAINT [PK_Enrollments] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Enrollments_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Enrollments_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 05:18:35.850 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Lessons] (
    [Id] int NOT NULL IDENTITY,
    [Title] nvarchar(max) NULL,
    [VideoUrl] nvarchar(max) NULL,
    [AttachmentUrl] nvarchar(max) NULL,
    [CourseId] int NOT NULL,
    CONSTRAINT [PK_Lessons] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Lessons_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:18:35.861 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Messages] (
    [Id] int NOT NULL IDENTITY,
    [SenderId] int NOT NULL,
    [CourseId] int NOT NULL,
    [Text] nvarchar(max) NULL,
    [AttachmentUrl] nvarchar(max) NULL,
    [SentAt] datetime2 NOT NULL,
    [ReplyToMessageId] int NULL,
    [IsSeen] bit NOT NULL,
    CONSTRAINT [PK_Messages] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Messages_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Messages_Messages_ReplyToMessageId] FOREIGN KEY ([ReplyToMessageId]) REFERENCES [Messages] ([Id]),
    CONSTRAINT [FK_Messages_Users_SenderId] FOREIGN KEY ([SenderId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:18:35.873 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Payments] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [CourseId] int NOT NULL,
    [Amount] decimal(18,2) NOT NULL,
    [PaymentMethod] nvarchar(max) NULL,
    [IsSuccessful] bit NOT NULL,
    [PaidAt] datetime2 NOT NULL,
    [TransactionId] nvarchar(max) NULL,
    [CourseId1] int NULL,
    CONSTRAINT [PK_Payments] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Payments_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Payments_Courses_CourseId1] FOREIGN KEY ([CourseId1]) REFERENCES [Courses] ([Id]),
    CONSTRAINT [FK_Payments_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 05:18:35.881 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Quizzes] (
    [Id] int NOT NULL IDENTITY,
    [Title] nvarchar(max) NULL,
    [CourseId] int NOT NULL,
    CONSTRAINT [PK_Quizzes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Quizzes_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:18:35.891 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Reviews] (
    [Id] int NOT NULL IDENTITY,
    [CourseId] int NOT NULL,
    [UserId] int NOT NULL,
    [Rating] int NOT NULL,
    [Comment] nvarchar(max) NULL,
    CONSTRAINT [PK_Reviews] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Reviews_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Reviews_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 05:18:35.899 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Questions] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NULL,
    [QuizId] int NOT NULL,
    CONSTRAINT [PK_Questions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Questions_Quizzes_QuizId] FOREIGN KEY ([QuizId]) REFERENCES [Quizzes] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:18:35.908 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [QuizResults] (
    [Id] int NOT NULL IDENTITY,
    [QuizId] int NOT NULL,
    [UserId] int NOT NULL,
    [TotalQuestions] int NOT NULL,
    [CorrectAnswers] int NOT NULL,
    [SubmittedAt] datetime2 NOT NULL,
    [QuizId1] int NULL,
    CONSTRAINT [PK_QuizResults] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_QuizResults_Quizzes_QuizId] FOREIGN KEY ([QuizId]) REFERENCES [Quizzes] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_QuizResults_Quizzes_QuizId1] FOREIGN KEY ([QuizId1]) REFERENCES [Quizzes] ([Id]),
    CONSTRAINT [FK_QuizResults_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:18:35.917 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Choices] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NULL,
    [IsCorrect] bit NOT NULL,
    [QuestionId] int NOT NULL,
    CONSTRAINT [PK_Choices] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Choices_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:18:35.929 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Choices_QuestionId] ON [Choices] ([QuestionId]);
2025-05-03 05:18:35.935 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_CategoryId] ON [Courses] ([CategoryId]);
2025-05-03 05:18:35.940 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_InstructorId] ON [Courses] ([InstructorId]);
2025-05-03 05:18:35.945 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_EmailConfirmationCodes_Email] ON [EmailConfirmationCodes] ([Email]);
2025-05-03 05:18:35.951 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Enrollments_CourseId] ON [Enrollments] ([CourseId]);
2025-05-03 05:18:35.956 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Enrollments_UserId] ON [Enrollments] ([UserId]);
2025-05-03 05:18:35.961 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Lessons_CourseId] ON [Lessons] ([CourseId]);
2025-05-03 05:18:35.967 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_CourseId] ON [Messages] ([CourseId]);
2025-05-03 05:18:35.971 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_ReplyToMessageId] ON [Messages] ([ReplyToMessageId]);
2025-05-03 05:18:35.976 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_SenderId] ON [Messages] ([SenderId]);
2025-05-03 05:18:35.982 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Notifications_UserId] ON [Notifications] ([UserId]);
2025-05-03 05:18:35.987 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PasswordResetCodes_Email] ON [PasswordResetCodes] ([Email]);
2025-05-03 05:18:35.992 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_CourseId] ON [Payments] ([CourseId]);
2025-05-03 05:18:35.998 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_CourseId1] ON [Payments] ([CourseId1]);
2025-05-03 05:18:36.004 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_UserId] ON [Payments] ([UserId]);
2025-05-03 05:18:36.009 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Profiles_UserId] ON [Profiles] ([UserId]);
2025-05-03 05:18:36.018 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Questions_QuizId] ON [Questions] ([QuizId]);
2025-05-03 05:18:36.025 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_QuizId] ON [QuizResults] ([QuizId]);
2025-05-03 05:18:36.033 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_QuizId1] ON [QuizResults] ([QuizId1]);
2025-05-03 05:18:36.040 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_UserId] ON [QuizResults] ([UserId]);
2025-05-03 05:18:36.049 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Quizzes_CourseId] ON [Quizzes] ([CourseId]);
2025-05-03 05:18:36.059 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_CourseId] ON [Reviews] ([CourseId]);
2025-05-03 05:18:36.072 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_UserId] ON [Reviews] ([UserId]);
2025-05-03 05:18:36.088 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_UserRefreshTokens_RefreshToken] ON [UserRefreshTokens] ([RefreshToken]);
2025-05-03 05:18:36.099 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserRefreshTokens_UserId] ON [UserRefreshTokens] ([UserId]);
2025-05-03 05:18:36.125 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250502160239_UpadateNotifications', N'8.0.0');
2025-05-03 05:18:36.150 +03:00 [INF] Applying migration '20250503015621_addLessons'.
2025-05-03 05:18:36.370 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] DROP CONSTRAINT [FK_Payments_Courses_CourseId];
2025-05-03 05:18:36.391 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] DROP CONSTRAINT [FK_Payments_Courses_CourseId1];
2025-05-03 05:18:36.423 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] DROP CONSTRAINT [FK_Payments_Users_UserId];
2025-05-03 05:18:36.435 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] DROP CONSTRAINT [FK_QuizResults_Quizzes_QuizId];
2025-05-03 05:18:36.448 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] DROP CONSTRAINT [FK_QuizResults_Quizzes_QuizId1];
2025-05-03 05:18:36.454 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] DROP CONSTRAINT [FK_QuizResults_Users_UserId];
2025-05-03 05:18:36.462 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] DROP CONSTRAINT [FK_Quizzes_Courses_CourseId];
2025-05-03 05:18:36.469 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Reviews] DROP CONSTRAINT [FK_Reviews_Courses_CourseId];
2025-05-03 05:18:36.474 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Reviews] DROP CONSTRAINT [FK_Reviews_Users_UserId];
2025-05-03 05:18:36.479 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [UserRefreshTokens] DROP CONSTRAINT [FK_UserRefreshTokens_Users_UserId];
2025-05-03 05:18:36.487 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP TABLE [Choices];
2025-05-03 05:18:36.491 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_UserRefreshTokens_UserId] ON [UserRefreshTokens];
2025-05-03 05:18:36.497 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_QuizResults_QuizId] ON [QuizResults];
2025-05-03 05:18:36.503 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_QuizResults_QuizId1] ON [QuizResults];
2025-05-03 05:18:36.508 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_QuizResults_UserId] ON [QuizResults];
2025-05-03 05:18:36.512 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Payments_CourseId1] ON [Payments];
2025-05-03 05:18:36.520 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Lessons_CourseId] ON [Lessons];
2025-05-03 05:18:36.739 +03:00 [INF] Executed DbCommand (216ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[QuizResults]') AND [c].[name] = N'CorrectAnswers');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [QuizResults] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [QuizResults] DROP COLUMN [CorrectAnswers];
2025-05-03 05:18:36.802 +03:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var1 sysname;
SELECT @var1 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[QuizResults]') AND [c].[name] = N'QuizId1');
IF @var1 IS NOT NULL EXEC(N'ALTER TABLE [QuizResults] DROP CONSTRAINT [' + @var1 + '];');
ALTER TABLE [QuizResults] DROP COLUMN [QuizId1];
2025-05-03 05:18:36.893 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var2 sysname;
SELECT @var2 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Payments]') AND [c].[name] = N'CourseId1');
IF @var2 IS NOT NULL EXEC(N'ALTER TABLE [Payments] DROP CONSTRAINT [' + @var2 + '];');
ALTER TABLE [Payments] DROP COLUMN [CourseId1];
2025-05-03 05:18:37.036 +03:00 [INF] Executed DbCommand (66ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var3 sysname;
SELECT @var3 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Lessons]') AND [c].[name] = N'AttachmentUrl');
IF @var3 IS NOT NULL EXEC(N'ALTER TABLE [Lessons] DROP CONSTRAINT [' + @var3 + '];');
ALTER TABLE [Lessons] DROP COLUMN [AttachmentUrl];
2025-05-03 05:18:37.761 +03:00 [INF] Executed DbCommand (703ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[QuizResults].[TotalQuestions]', N'Status', N'COLUMN';
2025-05-03 05:18:37.769 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[QuizResults].[SubmittedAt]', N'StartedAt', N'COLUMN';
2025-05-03 05:18:37.809 +03:00 [INF] Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var4 sysname;
SELECT @var4 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Users]') AND [c].[name] = N'Email');
IF @var4 IS NOT NULL EXEC(N'ALTER TABLE [Users] DROP CONSTRAINT [' + @var4 + '];');
ALTER TABLE [Users] ALTER COLUMN [Email] nvarchar(450) NULL;
2025-05-03 05:18:37.817 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD [UserGuid] nvarchar(36) NOT NULL DEFAULT N'';
2025-05-03 05:18:37.824 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [UserRefreshTokens] ADD [UserGuid] nvarchar(36) NOT NULL DEFAULT N'';
2025-05-03 05:18:37.876 +03:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var5 sysname;
SELECT @var5 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Quizzes]') AND [c].[name] = N'Title');
IF @var5 IS NOT NULL EXEC(N'ALTER TABLE [Quizzes] DROP CONSTRAINT [' + @var5 + '];');
UPDATE [Quizzes] SET [Title] = N'' WHERE [Title] IS NULL;
ALTER TABLE [Quizzes] ALTER COLUMN [Title] nvarchar(max) NOT NULL;
ALTER TABLE [Quizzes] ADD DEFAULT N'' FOR [Title];
2025-05-03 05:18:37.911 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var6 sysname;
SELECT @var6 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Quizzes]') AND [c].[name] = N'CourseId');
IF @var6 IS NOT NULL EXEC(N'ALTER TABLE [Quizzes] DROP CONSTRAINT [' + @var6 + '];');
ALTER TABLE [Quizzes] ALTER COLUMN [CourseId] int NULL;
2025-05-03 05:18:37.918 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE());
2025-05-03 05:18:37.924 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [CreatedBy] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:18:37.931 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [Description] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:18:37.938 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [IsMandatory] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 05:18:37.945 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [LessonId] int NOT NULL DEFAULT 0;
2025-05-03 05:18:37.951 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [LessonId1] int NULL;
2025-05-03 05:18:37.956 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [MaxAttempts] int NOT NULL DEFAULT 0;
2025-05-03 05:18:37.963 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [PassingScore] int NOT NULL DEFAULT 70;
2025-05-03 05:18:37.969 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [Status] int NOT NULL DEFAULT 0;
2025-05-03 05:18:37.975 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [TimeLimitMinutes] int NOT NULL DEFAULT 0;
2025-05-03 05:18:38.005 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var7 sysname;
SELECT @var7 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[QuizResults]') AND [c].[name] = N'UserId');
IF @var7 IS NOT NULL EXEC(N'ALTER TABLE [QuizResults] DROP CONSTRAINT [' + @var7 + '];');
ALTER TABLE [QuizResults] ALTER COLUMN [UserId] nvarchar(450) NOT NULL;
2025-05-03 05:18:38.010 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [CompletedAt] datetime2 NULL;
2025-05-03 05:18:38.016 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [IsPassed] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 05:18:38.021 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [Score] decimal(5,2) NOT NULL DEFAULT 0.0;
2025-05-03 05:18:38.026 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [UserGuid] nvarchar(36) NOT NULL DEFAULT N'';
2025-05-03 05:18:38.052 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var8 sysname;
SELECT @var8 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Questions]') AND [c].[name] = N'Text');
IF @var8 IS NOT NULL EXEC(N'ALTER TABLE [Questions] DROP CONSTRAINT [' + @var8 + '];');
UPDATE [Questions] SET [Text] = N'' WHERE [Text] IS NULL;
ALTER TABLE [Questions] ALTER COLUMN [Text] nvarchar(max) NOT NULL;
ALTER TABLE [Questions] ADD DEFAULT N'' FOR [Text];
2025-05-03 05:18:38.059 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Questions] ADD [Points] int NOT NULL DEFAULT 0;
2025-05-03 05:18:38.067 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Questions] ADD [Type] int NOT NULL DEFAULT 0;
2025-05-03 05:18:38.117 +03:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var9 sysname;
SELECT @var9 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Lessons]') AND [c].[name] = N'VideoUrl');
IF @var9 IS NOT NULL EXEC(N'ALTER TABLE [Lessons] DROP CONSTRAINT [' + @var9 + '];');
UPDATE [Lessons] SET [VideoUrl] = N'' WHERE [VideoUrl] IS NULL;
ALTER TABLE [Lessons] ALTER COLUMN [VideoUrl] nvarchar(max) NOT NULL;
ALTER TABLE [Lessons] ADD DEFAULT N'' FOR [VideoUrl];
2025-05-03 05:18:38.173 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var10 sysname;
SELECT @var10 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Lessons]') AND [c].[name] = N'Title');
IF @var10 IS NOT NULL EXEC(N'ALTER TABLE [Lessons] DROP CONSTRAINT [' + @var10 + '];');
UPDATE [Lessons] SET [Title] = N'' WHERE [Title] IS NULL;
ALTER TABLE [Lessons] ALTER COLUMN [Title] nvarchar(200) NOT NULL;
ALTER TABLE [Lessons] ADD DEFAULT N'' FOR [Title];
2025-05-03 05:18:38.188 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Content] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:18:38.197 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE());
2025-05-03 05:18:38.207 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [CreatedBy] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:18:38.219 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Description] nvarchar(1000) NOT NULL DEFAULT N'';
2025-05-03 05:18:38.231 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Duration] int NOT NULL DEFAULT 0;
2025-05-03 05:18:38.238 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [IsFree] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 05:18:38.247 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [IsSequential] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 05:18:38.252 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Order] int NOT NULL DEFAULT 0;
2025-05-03 05:18:38.262 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [PdfUrl] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:18:38.268 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Type] nvarchar(20) NOT NULL DEFAULT N'';
2025-05-03 05:18:38.273 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [UpdatedAt] datetime2 NULL;
2025-05-03 05:18:38.308 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var11 sysname;
SELECT @var11 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Courses]') AND [c].[name] = N'Title');
IF @var11 IS NOT NULL EXEC(N'ALTER TABLE [Courses] DROP CONSTRAINT [' + @var11 + '];');
ALTER TABLE [Courses] ALTER COLUMN [Title] nvarchar(450) NULL;
2025-05-03 05:18:38.315 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Courses] ADD [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE());
2025-05-03 05:18:38.320 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Courses] ADD [CreatedBy] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:18:38.324 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Courses] ADD [UpdatedAt] datetime2 NULL;
2025-05-03 05:18:38.328 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD CONSTRAINT [AK_Users_UserGuid] UNIQUE ([UserGuid]);
2025-05-03 05:18:38.337 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Answers] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL DEFAULT CAST(0 AS bit),
    [QuestionId] int NOT NULL,
    CONSTRAINT [PK_Answers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Answers_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:18:38.342 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Choice] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL,
    [QuestionId] int NOT NULL,
    CONSTRAINT [PK_Choice] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Choice_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:18:38.351 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [LessonMaterials] (
    [Id] int NOT NULL IDENTITY,
    [FileName] nvarchar(max) NOT NULL,
    [FileUrl] nvarchar(max) NOT NULL,
    [Description] nvarchar(max) NOT NULL,
    [FileSize] bigint NOT NULL,
    [UploadedAt] datetime2 NOT NULL,
    [UploadedById] nvarchar(max) NOT NULL,
    [LessonId] int NOT NULL,
    CONSTRAINT [PK_LessonMaterials] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_LessonMaterials_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:18:38.361 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [LessonProgresses] (
    [Id] int NOT NULL IDENTITY,
    [UserGuid] nvarchar(36) NOT NULL,
    [IsCompleted] bit NOT NULL DEFAULT CAST(0 AS bit),
    [ProgressPercentage] int NOT NULL DEFAULT 0,
    [StartedAt] datetime2 NULL,
    [CompletedAt] datetime2 NULL,
    [TimeSpent] time NOT NULL,
    [LessonId] int NOT NULL,
    [UserId] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_LessonProgresses] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_LessonProgresses_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_LessonProgresses_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE CASCADE
);
2025-05-03 05:18:38.369 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserAnswers] (
    [Id] int NOT NULL IDENTITY,
    [AnswerText] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL,
    [ChoiceId] int NULL,
    [QuestionId] int NOT NULL,
    [QuizResultId] int NOT NULL,
    [AnswerId] int NOT NULL,
    CONSTRAINT [PK_UserAnswers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_UserAnswers_Answers_AnswerId] FOREIGN KEY ([AnswerId]) REFERENCES [Answers] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_UserAnswers_Choice_ChoiceId] FOREIGN KEY ([ChoiceId]) REFERENCES [Choice] ([Id]),
    CONSTRAINT [FK_UserAnswers_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_UserAnswers_QuizResults_QuizResultId] FOREIGN KEY ([QuizResultId]) REFERENCES [QuizResults] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:18:38.377 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_Email] ON [Users] ([Email]) WHERE [Email] IS NOT NULL;
2025-05-03 05:18:38.383 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_UserGuid] ON [Users] ([UserGuid]);
2025-05-03 05:18:38.388 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserRefreshTokens_UserGuid] ON [UserRefreshTokens] ([UserGuid]);
2025-05-03 05:18:38.394 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Quizzes_LessonId] ON [Quizzes] ([LessonId]);
2025-05-03 05:18:38.401 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Quizzes_LessonId1] ON [Quizzes] ([LessonId1]) WHERE [LessonId1] IS NOT NULL;
2025-05-03 05:18:38.406 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_QuizId_UserId_CompletedAt] ON [QuizResults] ([QuizId], [UserId], [CompletedAt]);
2025-05-03 05:18:38.411 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_UserGuid] ON [QuizResults] ([UserGuid]);
2025-05-03 05:18:38.417 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Lessons_CourseId_Order] ON [Lessons] ([CourseId], [Order]);
2025-05-03 05:18:38.423 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_Title] ON [Courses] ([Title]);
2025-05-03 05:18:38.429 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Answers_QuestionId] ON [Answers] ([QuestionId]);
2025-05-03 05:18:38.435 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Choice_QuestionId] ON [Choice] ([QuestionId]);
2025-05-03 05:18:38.441 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonMaterials_LessonId] ON [LessonMaterials] ([LessonId]);
2025-05-03 05:18:38.448 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonProgresses_LessonId] ON [LessonProgresses] ([LessonId]);
2025-05-03 05:18:38.454 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonProgresses_UserGuid] ON [LessonProgresses] ([UserGuid]);
2025-05-03 05:18:38.460 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_AnswerId] ON [UserAnswers] ([AnswerId]);
2025-05-03 05:18:38.466 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_ChoiceId] ON [UserAnswers] ([ChoiceId]);
2025-05-03 05:18:38.471 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_QuestionId] ON [UserAnswers] ([QuestionId]);
2025-05-03 05:18:38.476 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_QuizResultId] ON [UserAnswers] ([QuizResultId]);
2025-05-03 05:18:38.486 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] ADD CONSTRAINT [FK_Payments_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE;
2025-05-03 05:18:38.492 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] ADD CONSTRAINT [FK_Payments_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE;
2025-05-03 05:18:38.498 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD CONSTRAINT [FK_QuizResults_Quizzes_QuizId] FOREIGN KEY ([QuizId]) REFERENCES [Quizzes] ([Id]) ON DELETE NO ACTION;
2025-05-03 05:18:38.504 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD CONSTRAINT [FK_QuizResults_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE NO ACTION;
2025-05-03 05:18:38.510 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD CONSTRAINT [FK_Quizzes_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]);
2025-05-03 05:18:38.517 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD CONSTRAINT [FK_Quizzes_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE;
2025-05-03 05:18:38.522 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD CONSTRAINT [FK_Quizzes_Lessons_LessonId1] FOREIGN KEY ([LessonId1]) REFERENCES [Lessons] ([Id]);
2025-05-03 05:18:38.531 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Reviews] ADD CONSTRAINT [FK_Reviews_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE;
2025-05-03 05:18:38.537 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Reviews] ADD CONSTRAINT [FK_Reviews_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE;
2025-05-03 05:18:38.544 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [UserRefreshTokens] ADD CONSTRAINT [FK_UserRefreshTokens_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE CASCADE;
2025-05-03 05:18:38.553 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250503015621_addLessons', N'8.0.0');
2025-05-03 05:18:38.560 +03:00 [INF] Applying migration '20250503020615_AddUserGuidColumn'.
2025-05-03 05:18:38.659 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
        UPDATE [Users] 
        SET [UserGuid] = NEWID() 
        WHERE [UserGuid] IS NULL OR [UserGuid] = ''
2025-05-03 05:18:38.701 +03:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
        WITH Duplicates AS (
            SELECT [UserGuid], ROW_NUMBER() OVER (PARTITION BY [UserGuid] ORDER BY [Id]) AS RowNum
            FROM [Users]
            WHERE [UserGuid] IS NOT NULL AND [UserGuid] != ''
        )
        UPDATE Duplicates
        SET [UserGuid] = NEWID()
        WHERE RowNum > 1
2025-05-03 05:18:38.712 +03:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [AK_Users_UserGuid] ON [Users] ([UserGuid]);
2025-05-03 05:19:07.102 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 05:19:07.376 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 05:19:08.053 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 05:19:08.135 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [E_LearningDB] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2025-05-03 05:19:08.179 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [E_LearningDB];
2025-05-03 05:19:35.906 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 05:19:35.985 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 05:19:36.844 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 05:19:37.228 +03:00 [INF] Executed DbCommand (283ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [E_LearningDB];
2025-05-03 05:19:37.327 +03:00 [INF] Executed DbCommand (87ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [E_LearningDB] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-05-03 05:19:37.356 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 05:19:37.473 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-05-03 05:19:37.485 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 05:19:37.519 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 05:19:37.545 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 05:19:37.575 +03:00 [INF] Applying migration '20250502160239_UpadateNotifications'.
2025-05-03 05:19:37.713 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-05-03 05:19:37.732 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [EmailConfirmationCodes] (
    [Id] int NOT NULL IDENTITY,
    [Email] nvarchar(450) NOT NULL,
    [Code] nvarchar(6) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_EmailConfirmationCodes] PRIMARY KEY ([Id])
);
2025-05-03 05:19:37.748 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PasswordResetCodes] (
    [Id] int NOT NULL IDENTITY,
    [Email] nvarchar(450) NOT NULL,
    [Code] nvarchar(6) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_PasswordResetCodes] PRIMARY KEY ([Id])
);
2025-05-03 05:19:37.769 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] int NOT NULL IDENTITY,
    [FullName] nvarchar(max) NULL,
    [Email] nvarchar(max) NULL,
    [PasswordHash] nvarchar(max) NULL,
    [Role] nvarchar(max) NOT NULL,
    [IsEmailConfirmed] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id])
);
2025-05-03 05:19:37.790 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Courses] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    [Title] nvarchar(max) NULL,
    [Description] nvarchar(max) NULL,
    [Price] decimal(18,2) NOT NULL,
    [ImageUrl] nvarchar(max) NULL,
    [IsActive] bit NULL,
    [CategoryId] int NOT NULL,
    [InstructorId] int NOT NULL,
    CONSTRAINT [PK_Courses] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Courses_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Courses_Users_InstructorId] FOREIGN KEY ([InstructorId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 05:19:37.803 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Notifications] (
    [Id] uniqueidentifier NOT NULL,
    [Title] nvarchar(100) NOT NULL,
    [Message] nvarchar(max) NOT NULL,
    [UserId] int NOT NULL,
    [SenderId] nvarchar(max) NULL,
    [IsRead] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NULL,
    [NotificationType] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Notifications] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Notifications_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:19:37.819 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Profiles] (
    [Id] int NOT NULL IDENTITY,
    [Bio] nvarchar(max) NULL,
    [ProfilePicture] nvarchar(max) NULL,
    [Address] nvarchar(max) NULL,
    [Phone] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_Profiles] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Profiles_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:19:37.830 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserRefreshTokens] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [RefreshToken] nvarchar(450) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_UserRefreshTokens] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_UserRefreshTokens_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:19:37.843 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Enrollments] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [CourseId] int NOT NULL,
    CONSTRAINT [PK_Enrollments] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Enrollments_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Enrollments_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 05:19:37.851 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Lessons] (
    [Id] int NOT NULL IDENTITY,
    [Title] nvarchar(max) NULL,
    [VideoUrl] nvarchar(max) NULL,
    [AttachmentUrl] nvarchar(max) NULL,
    [CourseId] int NOT NULL,
    CONSTRAINT [PK_Lessons] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Lessons_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:19:37.860 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Messages] (
    [Id] int NOT NULL IDENTITY,
    [SenderId] int NOT NULL,
    [CourseId] int NOT NULL,
    [Text] nvarchar(max) NULL,
    [AttachmentUrl] nvarchar(max) NULL,
    [SentAt] datetime2 NOT NULL,
    [ReplyToMessageId] int NULL,
    [IsSeen] bit NOT NULL,
    CONSTRAINT [PK_Messages] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Messages_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Messages_Messages_ReplyToMessageId] FOREIGN KEY ([ReplyToMessageId]) REFERENCES [Messages] ([Id]),
    CONSTRAINT [FK_Messages_Users_SenderId] FOREIGN KEY ([SenderId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:19:37.869 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Payments] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [CourseId] int NOT NULL,
    [Amount] decimal(18,2) NOT NULL,
    [PaymentMethod] nvarchar(max) NULL,
    [IsSuccessful] bit NOT NULL,
    [PaidAt] datetime2 NOT NULL,
    [TransactionId] nvarchar(max) NULL,
    [CourseId1] int NULL,
    CONSTRAINT [PK_Payments] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Payments_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Payments_Courses_CourseId1] FOREIGN KEY ([CourseId1]) REFERENCES [Courses] ([Id]),
    CONSTRAINT [FK_Payments_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 05:19:37.880 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Quizzes] (
    [Id] int NOT NULL IDENTITY,
    [Title] nvarchar(max) NULL,
    [CourseId] int NOT NULL,
    CONSTRAINT [PK_Quizzes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Quizzes_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:19:37.888 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Reviews] (
    [Id] int NOT NULL IDENTITY,
    [CourseId] int NOT NULL,
    [UserId] int NOT NULL,
    [Rating] int NOT NULL,
    [Comment] nvarchar(max) NULL,
    CONSTRAINT [PK_Reviews] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Reviews_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Reviews_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 05:19:37.897 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Questions] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NULL,
    [QuizId] int NOT NULL,
    CONSTRAINT [PK_Questions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Questions_Quizzes_QuizId] FOREIGN KEY ([QuizId]) REFERENCES [Quizzes] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:19:37.906 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [QuizResults] (
    [Id] int NOT NULL IDENTITY,
    [QuizId] int NOT NULL,
    [UserId] int NOT NULL,
    [TotalQuestions] int NOT NULL,
    [CorrectAnswers] int NOT NULL,
    [SubmittedAt] datetime2 NOT NULL,
    [QuizId1] int NULL,
    CONSTRAINT [PK_QuizResults] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_QuizResults_Quizzes_QuizId] FOREIGN KEY ([QuizId]) REFERENCES [Quizzes] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_QuizResults_Quizzes_QuizId1] FOREIGN KEY ([QuizId1]) REFERENCES [Quizzes] ([Id]),
    CONSTRAINT [FK_QuizResults_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:19:37.915 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Choices] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NULL,
    [IsCorrect] bit NOT NULL,
    [QuestionId] int NOT NULL,
    CONSTRAINT [PK_Choices] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Choices_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:19:37.920 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Choices_QuestionId] ON [Choices] ([QuestionId]);
2025-05-03 05:19:37.927 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_CategoryId] ON [Courses] ([CategoryId]);
2025-05-03 05:19:37.932 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_InstructorId] ON [Courses] ([InstructorId]);
2025-05-03 05:19:37.936 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_EmailConfirmationCodes_Email] ON [EmailConfirmationCodes] ([Email]);
2025-05-03 05:19:37.942 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Enrollments_CourseId] ON [Enrollments] ([CourseId]);
2025-05-03 05:19:37.948 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Enrollments_UserId] ON [Enrollments] ([UserId]);
2025-05-03 05:19:37.955 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Lessons_CourseId] ON [Lessons] ([CourseId]);
2025-05-03 05:19:37.961 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_CourseId] ON [Messages] ([CourseId]);
2025-05-03 05:19:37.967 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_ReplyToMessageId] ON [Messages] ([ReplyToMessageId]);
2025-05-03 05:19:37.979 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_SenderId] ON [Messages] ([SenderId]);
2025-05-03 05:19:37.986 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Notifications_UserId] ON [Notifications] ([UserId]);
2025-05-03 05:19:37.990 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PasswordResetCodes_Email] ON [PasswordResetCodes] ([Email]);
2025-05-03 05:19:38.000 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_CourseId] ON [Payments] ([CourseId]);
2025-05-03 05:19:38.007 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_CourseId1] ON [Payments] ([CourseId1]);
2025-05-03 05:19:38.017 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_UserId] ON [Payments] ([UserId]);
2025-05-03 05:19:38.025 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Profiles_UserId] ON [Profiles] ([UserId]);
2025-05-03 05:19:38.034 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Questions_QuizId] ON [Questions] ([QuizId]);
2025-05-03 05:19:38.045 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_QuizId] ON [QuizResults] ([QuizId]);
2025-05-03 05:19:38.052 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_QuizId1] ON [QuizResults] ([QuizId1]);
2025-05-03 05:19:38.064 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_UserId] ON [QuizResults] ([UserId]);
2025-05-03 05:19:38.071 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Quizzes_CourseId] ON [Quizzes] ([CourseId]);
2025-05-03 05:19:38.081 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_CourseId] ON [Reviews] ([CourseId]);
2025-05-03 05:19:38.088 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_UserId] ON [Reviews] ([UserId]);
2025-05-03 05:19:38.097 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_UserRefreshTokens_RefreshToken] ON [UserRefreshTokens] ([RefreshToken]);
2025-05-03 05:19:38.103 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserRefreshTokens_UserId] ON [UserRefreshTokens] ([UserId]);
2025-05-03 05:19:38.127 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250502160239_UpadateNotifications', N'8.0.0');
2025-05-03 05:19:38.149 +03:00 [INF] Applying migration '20250503015621_addLessons'.
2025-05-03 05:19:38.273 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] DROP CONSTRAINT [FK_Payments_Courses_CourseId];
2025-05-03 05:19:38.279 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] DROP CONSTRAINT [FK_Payments_Courses_CourseId1];
2025-05-03 05:19:38.291 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] DROP CONSTRAINT [FK_Payments_Users_UserId];
2025-05-03 05:19:38.300 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] DROP CONSTRAINT [FK_QuizResults_Quizzes_QuizId];
2025-05-03 05:19:38.306 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] DROP CONSTRAINT [FK_QuizResults_Quizzes_QuizId1];
2025-05-03 05:19:38.314 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] DROP CONSTRAINT [FK_QuizResults_Users_UserId];
2025-05-03 05:19:38.323 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] DROP CONSTRAINT [FK_Quizzes_Courses_CourseId];
2025-05-03 05:19:38.334 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Reviews] DROP CONSTRAINT [FK_Reviews_Courses_CourseId];
2025-05-03 05:19:38.348 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Reviews] DROP CONSTRAINT [FK_Reviews_Users_UserId];
2025-05-03 05:19:38.357 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [UserRefreshTokens] DROP CONSTRAINT [FK_UserRefreshTokens_Users_UserId];
2025-05-03 05:19:38.368 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP TABLE [Choices];
2025-05-03 05:19:38.373 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_UserRefreshTokens_UserId] ON [UserRefreshTokens];
2025-05-03 05:19:38.380 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_QuizResults_QuizId] ON [QuizResults];
2025-05-03 05:19:38.386 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_QuizResults_QuizId1] ON [QuizResults];
2025-05-03 05:19:38.392 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_QuizResults_UserId] ON [QuizResults];
2025-05-03 05:19:38.401 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Payments_CourseId1] ON [Payments];
2025-05-03 05:19:38.406 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Lessons_CourseId] ON [Lessons];
2025-05-03 05:19:38.506 +03:00 [INF] Executed DbCommand (94ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[QuizResults]') AND [c].[name] = N'CorrectAnswers');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [QuizResults] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [QuizResults] DROP COLUMN [CorrectAnswers];
2025-05-03 05:19:38.552 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var1 sysname;
SELECT @var1 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[QuizResults]') AND [c].[name] = N'QuizId1');
IF @var1 IS NOT NULL EXEC(N'ALTER TABLE [QuizResults] DROP CONSTRAINT [' + @var1 + '];');
ALTER TABLE [QuizResults] DROP COLUMN [QuizId1];
2025-05-03 05:19:38.598 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var2 sysname;
SELECT @var2 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Payments]') AND [c].[name] = N'CourseId1');
IF @var2 IS NOT NULL EXEC(N'ALTER TABLE [Payments] DROP CONSTRAINT [' + @var2 + '];');
ALTER TABLE [Payments] DROP COLUMN [CourseId1];
2025-05-03 05:19:38.630 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var3 sysname;
SELECT @var3 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Lessons]') AND [c].[name] = N'AttachmentUrl');
IF @var3 IS NOT NULL EXEC(N'ALTER TABLE [Lessons] DROP CONSTRAINT [' + @var3 + '];');
ALTER TABLE [Lessons] DROP COLUMN [AttachmentUrl];
2025-05-03 05:19:38.957 +03:00 [INF] Executed DbCommand (324ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[QuizResults].[TotalQuestions]', N'Status', N'COLUMN';
2025-05-03 05:19:38.965 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[QuizResults].[SubmittedAt]', N'StartedAt', N'COLUMN';
2025-05-03 05:19:39.014 +03:00 [INF] Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var4 sysname;
SELECT @var4 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Users]') AND [c].[name] = N'Email');
IF @var4 IS NOT NULL EXEC(N'ALTER TABLE [Users] DROP CONSTRAINT [' + @var4 + '];');
ALTER TABLE [Users] ALTER COLUMN [Email] nvarchar(450) NULL;
2025-05-03 05:19:39.022 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD [UserGuid] nvarchar(36) NOT NULL DEFAULT N'';
2025-05-03 05:19:39.028 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [UserRefreshTokens] ADD [UserGuid] nvarchar(36) NOT NULL DEFAULT N'';
2025-05-03 05:19:39.076 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var5 sysname;
SELECT @var5 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Quizzes]') AND [c].[name] = N'Title');
IF @var5 IS NOT NULL EXEC(N'ALTER TABLE [Quizzes] DROP CONSTRAINT [' + @var5 + '];');
UPDATE [Quizzes] SET [Title] = N'' WHERE [Title] IS NULL;
ALTER TABLE [Quizzes] ALTER COLUMN [Title] nvarchar(max) NOT NULL;
ALTER TABLE [Quizzes] ADD DEFAULT N'' FOR [Title];
2025-05-03 05:19:39.119 +03:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var6 sysname;
SELECT @var6 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Quizzes]') AND [c].[name] = N'CourseId');
IF @var6 IS NOT NULL EXEC(N'ALTER TABLE [Quizzes] DROP CONSTRAINT [' + @var6 + '];');
ALTER TABLE [Quizzes] ALTER COLUMN [CourseId] int NULL;
2025-05-03 05:19:39.126 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE());
2025-05-03 05:19:39.132 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [CreatedBy] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:19:39.139 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [Description] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:19:39.146 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [IsMandatory] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 05:19:39.151 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [LessonId] int NOT NULL DEFAULT 0;
2025-05-03 05:19:39.158 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [LessonId1] int NULL;
2025-05-03 05:19:39.163 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [MaxAttempts] int NOT NULL DEFAULT 0;
2025-05-03 05:19:39.169 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [PassingScore] int NOT NULL DEFAULT 70;
2025-05-03 05:19:39.176 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [Status] int NOT NULL DEFAULT 0;
2025-05-03 05:19:39.182 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD [TimeLimitMinutes] int NOT NULL DEFAULT 0;
2025-05-03 05:19:39.230 +03:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var7 sysname;
SELECT @var7 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[QuizResults]') AND [c].[name] = N'UserId');
IF @var7 IS NOT NULL EXEC(N'ALTER TABLE [QuizResults] DROP CONSTRAINT [' + @var7 + '];');
ALTER TABLE [QuizResults] ALTER COLUMN [UserId] nvarchar(450) NOT NULL;
2025-05-03 05:19:39.244 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [CompletedAt] datetime2 NULL;
2025-05-03 05:19:39.252 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [IsPassed] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 05:19:39.263 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [Score] decimal(5,2) NOT NULL DEFAULT 0.0;
2025-05-03 05:19:39.274 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD [UserGuid] nvarchar(36) NOT NULL DEFAULT N'';
2025-05-03 05:19:39.343 +03:00 [INF] Executed DbCommand (63ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var8 sysname;
SELECT @var8 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Questions]') AND [c].[name] = N'Text');
IF @var8 IS NOT NULL EXEC(N'ALTER TABLE [Questions] DROP CONSTRAINT [' + @var8 + '];');
UPDATE [Questions] SET [Text] = N'' WHERE [Text] IS NULL;
ALTER TABLE [Questions] ALTER COLUMN [Text] nvarchar(max) NOT NULL;
ALTER TABLE [Questions] ADD DEFAULT N'' FOR [Text];
2025-05-03 05:19:39.351 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Questions] ADD [Points] int NOT NULL DEFAULT 0;
2025-05-03 05:19:39.359 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Questions] ADD [Type] int NOT NULL DEFAULT 0;
2025-05-03 05:19:39.401 +03:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var9 sysname;
SELECT @var9 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Lessons]') AND [c].[name] = N'VideoUrl');
IF @var9 IS NOT NULL EXEC(N'ALTER TABLE [Lessons] DROP CONSTRAINT [' + @var9 + '];');
UPDATE [Lessons] SET [VideoUrl] = N'' WHERE [VideoUrl] IS NULL;
ALTER TABLE [Lessons] ALTER COLUMN [VideoUrl] nvarchar(max) NOT NULL;
ALTER TABLE [Lessons] ADD DEFAULT N'' FOR [VideoUrl];
2025-05-03 05:19:39.427 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var10 sysname;
SELECT @var10 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Lessons]') AND [c].[name] = N'Title');
IF @var10 IS NOT NULL EXEC(N'ALTER TABLE [Lessons] DROP CONSTRAINT [' + @var10 + '];');
UPDATE [Lessons] SET [Title] = N'' WHERE [Title] IS NULL;
ALTER TABLE [Lessons] ALTER COLUMN [Title] nvarchar(200) NOT NULL;
ALTER TABLE [Lessons] ADD DEFAULT N'' FOR [Title];
2025-05-03 05:19:39.432 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Content] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:19:39.437 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE());
2025-05-03 05:19:39.443 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [CreatedBy] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:19:39.448 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Description] nvarchar(1000) NOT NULL DEFAULT N'';
2025-05-03 05:19:39.454 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Duration] int NOT NULL DEFAULT 0;
2025-05-03 05:19:39.462 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [IsFree] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 05:19:39.468 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [IsSequential] bit NOT NULL DEFAULT CAST(0 AS bit);
2025-05-03 05:19:39.473 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Order] int NOT NULL DEFAULT 0;
2025-05-03 05:19:39.480 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [PdfUrl] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:19:39.486 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [Type] nvarchar(20) NOT NULL DEFAULT N'';
2025-05-03 05:19:39.495 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Lessons] ADD [UpdatedAt] datetime2 NULL;
2025-05-03 05:19:39.554 +03:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var11 sysname;
SELECT @var11 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Courses]') AND [c].[name] = N'Title');
IF @var11 IS NOT NULL EXEC(N'ALTER TABLE [Courses] DROP CONSTRAINT [' + @var11 + '];');
ALTER TABLE [Courses] ALTER COLUMN [Title] nvarchar(450) NULL;
2025-05-03 05:19:39.563 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Courses] ADD [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE());
2025-05-03 05:19:39.571 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Courses] ADD [CreatedBy] nvarchar(max) NOT NULL DEFAULT N'';
2025-05-03 05:19:39.578 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Courses] ADD [UpdatedAt] datetime2 NULL;
2025-05-03 05:19:39.588 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] ADD CONSTRAINT [AK_Users_UserGuid] UNIQUE ([UserGuid]);
2025-05-03 05:19:39.605 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Answers] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL DEFAULT CAST(0 AS bit),
    [QuestionId] int NOT NULL,
    CONSTRAINT [PK_Answers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Answers_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:19:39.619 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Choice] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL,
    [QuestionId] int NOT NULL,
    CONSTRAINT [PK_Choice] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Choice_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:19:39.630 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [LessonMaterials] (
    [Id] int NOT NULL IDENTITY,
    [FileName] nvarchar(max) NOT NULL,
    [FileUrl] nvarchar(max) NOT NULL,
    [Description] nvarchar(max) NOT NULL,
    [FileSize] bigint NOT NULL,
    [UploadedAt] datetime2 NOT NULL,
    [UploadedById] nvarchar(max) NOT NULL,
    [LessonId] int NOT NULL,
    CONSTRAINT [PK_LessonMaterials] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_LessonMaterials_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:19:39.644 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [LessonProgresses] (
    [Id] int NOT NULL IDENTITY,
    [UserGuid] nvarchar(36) NOT NULL,
    [IsCompleted] bit NOT NULL DEFAULT CAST(0 AS bit),
    [ProgressPercentage] int NOT NULL DEFAULT 0,
    [StartedAt] datetime2 NULL,
    [CompletedAt] datetime2 NULL,
    [TimeSpent] time NOT NULL,
    [LessonId] int NOT NULL,
    [UserId] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_LessonProgresses] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_LessonProgresses_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_LessonProgresses_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE CASCADE
);
2025-05-03 05:19:39.654 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserAnswers] (
    [Id] int NOT NULL IDENTITY,
    [AnswerText] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL,
    [ChoiceId] int NULL,
    [QuestionId] int NOT NULL,
    [QuizResultId] int NOT NULL,
    [AnswerId] int NOT NULL,
    CONSTRAINT [PK_UserAnswers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_UserAnswers_Answers_AnswerId] FOREIGN KEY ([AnswerId]) REFERENCES [Answers] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_UserAnswers_Choice_ChoiceId] FOREIGN KEY ([ChoiceId]) REFERENCES [Choice] ([Id]),
    CONSTRAINT [FK_UserAnswers_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_UserAnswers_QuizResults_QuizResultId] FOREIGN KEY ([QuizResultId]) REFERENCES [QuizResults] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:19:39.662 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_Email] ON [Users] ([Email]) WHERE [Email] IS NOT NULL;
2025-05-03 05:19:39.667 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_UserGuid] ON [Users] ([UserGuid]);
2025-05-03 05:19:39.673 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserRefreshTokens_UserGuid] ON [UserRefreshTokens] ([UserGuid]);
2025-05-03 05:19:39.680 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Quizzes_LessonId] ON [Quizzes] ([LessonId]);
2025-05-03 05:19:39.685 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Quizzes_LessonId1] ON [Quizzes] ([LessonId1]) WHERE [LessonId1] IS NOT NULL;
2025-05-03 05:19:39.692 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_QuizId_UserId_CompletedAt] ON [QuizResults] ([QuizId], [UserId], [CompletedAt]);
2025-05-03 05:19:39.697 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_UserGuid] ON [QuizResults] ([UserGuid]);
2025-05-03 05:19:39.703 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Lessons_CourseId_Order] ON [Lessons] ([CourseId], [Order]);
2025-05-03 05:19:39.711 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_Title] ON [Courses] ([Title]);
2025-05-03 05:19:39.718 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Answers_QuestionId] ON [Answers] ([QuestionId]);
2025-05-03 05:19:39.723 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Choice_QuestionId] ON [Choice] ([QuestionId]);
2025-05-03 05:19:39.730 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonMaterials_LessonId] ON [LessonMaterials] ([LessonId]);
2025-05-03 05:19:39.744 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonProgresses_LessonId] ON [LessonProgresses] ([LessonId]);
2025-05-03 05:19:39.755 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonProgresses_UserGuid] ON [LessonProgresses] ([UserGuid]);
2025-05-03 05:19:39.770 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_AnswerId] ON [UserAnswers] ([AnswerId]);
2025-05-03 05:19:39.782 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_ChoiceId] ON [UserAnswers] ([ChoiceId]);
2025-05-03 05:19:39.790 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_QuestionId] ON [UserAnswers] ([QuestionId]);
2025-05-03 05:19:39.799 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_QuizResultId] ON [UserAnswers] ([QuizResultId]);
2025-05-03 05:19:39.807 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] ADD CONSTRAINT [FK_Payments_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE;
2025-05-03 05:19:39.818 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Payments] ADD CONSTRAINT [FK_Payments_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE;
2025-05-03 05:19:39.829 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD CONSTRAINT [FK_QuizResults_Quizzes_QuizId] FOREIGN KEY ([QuizId]) REFERENCES [Quizzes] ([Id]) ON DELETE NO ACTION;
2025-05-03 05:19:39.837 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] ADD CONSTRAINT [FK_QuizResults_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE NO ACTION;
2025-05-03 05:19:39.847 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD CONSTRAINT [FK_Quizzes_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]);
2025-05-03 05:19:39.856 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD CONSTRAINT [FK_Quizzes_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE;
2025-05-03 05:19:39.865 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Quizzes] ADD CONSTRAINT [FK_Quizzes_Lessons_LessonId1] FOREIGN KEY ([LessonId1]) REFERENCES [Lessons] ([Id]);
2025-05-03 05:19:39.872 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Reviews] ADD CONSTRAINT [FK_Reviews_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE;
2025-05-03 05:19:39.879 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Reviews] ADD CONSTRAINT [FK_Reviews_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE;
2025-05-03 05:19:39.886 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [UserRefreshTokens] ADD CONSTRAINT [FK_UserRefreshTokens_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE CASCADE;
2025-05-03 05:19:39.899 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250503015621_addLessons', N'8.0.0');
2025-05-03 05:19:39.903 +03:00 [INF] Applying migration '20250503020615_AddUserGuidColumn'.
2025-05-03 05:19:39.960 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
        UPDATE [Users] 
        SET [UserGuid] = NEWID() 
        WHERE [UserGuid] IS NULL OR [UserGuid] = ''
2025-05-03 05:19:39.979 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
        WITH Duplicates AS (
            SELECT [UserGuid], ROW_NUMBER() OVER (PARTITION BY [UserGuid] ORDER BY [Id]) AS RowNum
            FROM [Users]
            WHERE [UserGuid] IS NOT NULL AND [UserGuid] != ''
        )
        UPDATE Duplicates
        SET [UserGuid] = NEWID()
        WHERE RowNum > 1
2025-05-03 05:19:39.989 +03:00 [ERR] Failed executing DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [AK_Users_UserGuid] ON [Users] ([UserGuid]);
2025-05-03 05:20:44.281 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 05:20:44.373 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 05:20:45.009 +03:00 [INF] Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 05:20:48.146 +03:00 [INF] Executed DbCommand (3,021ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [E_LearningDB] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2025-05-03 05:20:48.188 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [E_LearningDB];
2025-05-03 05:21:41.224 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 05:21:41.326 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 05:21:41.921 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 05:22:03.438 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 05:22:03.605 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 05:22:04.754 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 05:22:05.493 +03:00 [INF] Executed DbCommand (493ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [E_LearningDB];
2025-05-03 05:22:05.649 +03:00 [INF] Executed DbCommand (142ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [E_LearningDB] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-05-03 05:22:05.695 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 05:22:05.827 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-05-03 05:22:05.837 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 05:22:05.869 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 05:22:05.893 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 05:22:05.928 +03:00 [INF] Applying migration '20250503022142_InitialCreate'.
2025-05-03 05:22:06.157 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-05-03 05:22:06.167 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [EmailConfirmationCodes] (
    [Id] int NOT NULL IDENTITY,
    [Email] nvarchar(450) NOT NULL,
    [Code] nvarchar(6) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_EmailConfirmationCodes] PRIMARY KEY ([Id])
);
2025-05-03 05:22:06.176 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PasswordResetCodes] (
    [Id] int NOT NULL IDENTITY,
    [Email] nvarchar(450) NOT NULL,
    [Code] nvarchar(6) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_PasswordResetCodes] PRIMARY KEY ([Id])
);
2025-05-03 05:22:06.187 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] int NOT NULL IDENTITY,
    [UserGuid] nvarchar(36) NOT NULL,
    [FullName] nvarchar(max) NULL,
    [Email] nvarchar(450) NULL,
    [PasswordHash] nvarchar(max) NULL,
    [Role] nvarchar(max) NOT NULL,
    [IsEmailConfirmed] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id]),
    CONSTRAINT [AK_Users_UserGuid] UNIQUE ([UserGuid])
);
2025-05-03 05:22:06.198 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Courses] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    [Title] nvarchar(450) NULL,
    [Description] nvarchar(max) NULL,
    [Price] decimal(18,2) NOT NULL,
    [ImageUrl] nvarchar(max) NULL,
    [IsActive] bit NULL,
    [CategoryId] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [UpdatedAt] datetime2 NULL,
    [CreatedBy] nvarchar(max) NOT NULL,
    [InstructorId] int NOT NULL,
    CONSTRAINT [PK_Courses] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Courses_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Courses_Users_InstructorId] FOREIGN KEY ([InstructorId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 05:22:06.209 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Notifications] (
    [Id] uniqueidentifier NOT NULL,
    [Title] nvarchar(100) NOT NULL,
    [Message] nvarchar(max) NOT NULL,
    [UserId] int NOT NULL,
    [SenderId] nvarchar(max) NULL,
    [IsRead] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NULL,
    [NotificationType] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Notifications] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Notifications_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:22:06.219 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Profiles] (
    [Id] int NOT NULL IDENTITY,
    [Bio] nvarchar(max) NULL,
    [ProfilePicture] nvarchar(max) NULL,
    [Address] nvarchar(max) NULL,
    [Phone] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_Profiles] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Profiles_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:22:06.229 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserRefreshTokens] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [UserGuid] nvarchar(36) NOT NULL,
    [RefreshToken] nvarchar(450) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_UserRefreshTokens] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_UserRefreshTokens_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE CASCADE
);
2025-05-03 05:22:06.238 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Enrollments] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [CourseId] int NOT NULL,
    CONSTRAINT [PK_Enrollments] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Enrollments_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Enrollments_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 05:22:06.251 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Lessons] (
    [Id] int NOT NULL IDENTITY,
    [Title] nvarchar(200) NOT NULL,
    [Description] nvarchar(1000) NOT NULL,
    [Type] nvarchar(20) NOT NULL,
    [Content] nvarchar(max) NOT NULL,
    [VideoUrl] nvarchar(max) NOT NULL,
    [PdfUrl] nvarchar(max) NOT NULL,
    [Duration] int NOT NULL,
    [IsFree] bit NOT NULL,
    [IsSequential] bit NOT NULL,
    [Order] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [UpdatedAt] datetime2 NULL,
    [CreatedBy] nvarchar(max) NOT NULL,
    [CourseId] int NOT NULL,
    CONSTRAINT [PK_Lessons] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Lessons_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:22:06.264 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Messages] (
    [Id] int NOT NULL IDENTITY,
    [SenderId] int NOT NULL,
    [CourseId] int NOT NULL,
    [Text] nvarchar(max) NULL,
    [AttachmentUrl] nvarchar(max) NULL,
    [SentAt] datetime2 NOT NULL,
    [ReplyToMessageId] int NULL,
    [IsSeen] bit NOT NULL,
    CONSTRAINT [PK_Messages] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Messages_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Messages_Messages_ReplyToMessageId] FOREIGN KEY ([ReplyToMessageId]) REFERENCES [Messages] ([Id]),
    CONSTRAINT [FK_Messages_Users_SenderId] FOREIGN KEY ([SenderId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:22:06.276 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Payments] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [CourseId] int NOT NULL,
    [Amount] decimal(18,2) NOT NULL,
    [PaymentMethod] nvarchar(max) NULL,
    [IsSuccessful] bit NOT NULL,
    [PaidAt] datetime2 NOT NULL,
    [TransactionId] nvarchar(max) NULL,
    CONSTRAINT [PK_Payments] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Payments_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Payments_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:22:06.290 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Reviews] (
    [Id] int NOT NULL IDENTITY,
    [CourseId] int NOT NULL,
    [UserId] int NOT NULL,
    [Rating] int NOT NULL,
    [Comment] nvarchar(max) NULL,
    CONSTRAINT [PK_Reviews] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Reviews_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Reviews_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:22:06.302 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [LessonMaterials] (
    [Id] int NOT NULL IDENTITY,
    [FileName] nvarchar(max) NOT NULL,
    [FileUrl] nvarchar(max) NOT NULL,
    [Description] nvarchar(max) NOT NULL,
    [FileSize] bigint NOT NULL,
    [UploadedAt] datetime2 NOT NULL,
    [UploadedById] nvarchar(max) NOT NULL,
    [LessonId] int NOT NULL,
    CONSTRAINT [PK_LessonMaterials] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_LessonMaterials_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:22:06.320 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [LessonProgresses] (
    [Id] int NOT NULL IDENTITY,
    [UserGuid] nvarchar(36) NOT NULL,
    [IsCompleted] bit NOT NULL DEFAULT CAST(0 AS bit),
    [ProgressPercentage] int NOT NULL DEFAULT 0,
    [StartedAt] datetime2 NULL,
    [CompletedAt] datetime2 NULL,
    [TimeSpent] time NOT NULL,
    [LessonId] int NOT NULL,
    [UserId] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_LessonProgresses] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_LessonProgresses_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_LessonProgresses_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE CASCADE
);
2025-05-03 05:22:06.336 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Quizzes] (
    [Id] int NOT NULL IDENTITY,
    [Title] nvarchar(max) NOT NULL,
    [Description] nvarchar(max) NOT NULL,
    [PassingScore] int NOT NULL DEFAULT 70,
    [IsMandatory] bit NOT NULL,
    [MaxAttempts] int NOT NULL,
    [TimeLimitMinutes] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [CreatedBy] nvarchar(max) NOT NULL,
    [Status] int NOT NULL,
    [LessonId] int NOT NULL,
    [CourseId] int NULL,
    [LessonId1] int NULL,
    CONSTRAINT [PK_Quizzes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Quizzes_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]),
    CONSTRAINT [FK_Quizzes_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Quizzes_Lessons_LessonId1] FOREIGN KEY ([LessonId1]) REFERENCES [Lessons] ([Id])
);
2025-05-03 05:22:06.349 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Questions] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [Type] int NOT NULL,
    [Points] int NOT NULL,
    [QuizId] int NOT NULL,
    CONSTRAINT [PK_Questions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Questions_Quizzes_QuizId] FOREIGN KEY ([QuizId]) REFERENCES [Quizzes] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:22:06.368 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [QuizResults] (
    [Id] int NOT NULL IDENTITY,
    [UserGuid] nvarchar(36) NOT NULL,
    [Score] decimal(5,2) NOT NULL,
    [IsPassed] bit NOT NULL,
    [StartedAt] datetime2 NOT NULL,
    [CompletedAt] datetime2 NULL,
    [Status] int NOT NULL,
    [QuizId] int NOT NULL,
    [UserId] nvarchar(450) NOT NULL,
    CONSTRAINT [PK_QuizResults] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_QuizResults_Quizzes_QuizId] FOREIGN KEY ([QuizId]) REFERENCES [Quizzes] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_QuizResults_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE NO ACTION
);
2025-05-03 05:22:06.387 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Answers] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL DEFAULT CAST(0 AS bit),
    [QuestionId] int NOT NULL,
    CONSTRAINT [PK_Answers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Answers_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:22:06.400 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Choice] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL,
    [QuestionId] int NOT NULL,
    CONSTRAINT [PK_Choice] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Choice_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:22:06.415 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserAnswers] (
    [Id] int NOT NULL IDENTITY,
    [AnswerText] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL,
    [ChoiceId] int NULL,
    [QuestionId] int NOT NULL,
    [QuizResultId] int NOT NULL,
    [AnswerId] int NOT NULL,
    CONSTRAINT [PK_UserAnswers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_UserAnswers_Answers_AnswerId] FOREIGN KEY ([AnswerId]) REFERENCES [Answers] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_UserAnswers_Choice_ChoiceId] FOREIGN KEY ([ChoiceId]) REFERENCES [Choice] ([Id]),
    CONSTRAINT [FK_UserAnswers_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_UserAnswers_QuizResults_QuizResultId] FOREIGN KEY ([QuizResultId]) REFERENCES [QuizResults] ([Id]) ON DELETE CASCADE
);
2025-05-03 05:22:06.422 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Answers_QuestionId] ON [Answers] ([QuestionId]);
2025-05-03 05:22:06.428 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Choice_QuestionId] ON [Choice] ([QuestionId]);
2025-05-03 05:22:06.434 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_CategoryId] ON [Courses] ([CategoryId]);
2025-05-03 05:22:06.439 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_InstructorId] ON [Courses] ([InstructorId]);
2025-05-03 05:22:06.446 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_Title] ON [Courses] ([Title]);
2025-05-03 05:22:06.451 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_EmailConfirmationCodes_Email] ON [EmailConfirmationCodes] ([Email]);
2025-05-03 05:22:06.457 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Enrollments_CourseId] ON [Enrollments] ([CourseId]);
2025-05-03 05:22:06.464 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Enrollments_UserId] ON [Enrollments] ([UserId]);
2025-05-03 05:22:06.470 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonMaterials_LessonId] ON [LessonMaterials] ([LessonId]);
2025-05-03 05:22:06.477 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonProgresses_LessonId] ON [LessonProgresses] ([LessonId]);
2025-05-03 05:22:06.482 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonProgresses_UserGuid] ON [LessonProgresses] ([UserGuid]);
2025-05-03 05:22:06.487 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Lessons_CourseId_Order] ON [Lessons] ([CourseId], [Order]);
2025-05-03 05:22:06.493 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_CourseId] ON [Messages] ([CourseId]);
2025-05-03 05:22:06.500 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_ReplyToMessageId] ON [Messages] ([ReplyToMessageId]);
2025-05-03 05:22:06.506 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_SenderId] ON [Messages] ([SenderId]);
2025-05-03 05:22:06.512 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Notifications_UserId] ON [Notifications] ([UserId]);
2025-05-03 05:22:06.518 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PasswordResetCodes_Email] ON [PasswordResetCodes] ([Email]);
2025-05-03 05:22:06.523 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_CourseId] ON [Payments] ([CourseId]);
2025-05-03 05:22:06.529 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_UserId] ON [Payments] ([UserId]);
2025-05-03 05:22:06.534 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Profiles_UserId] ON [Profiles] ([UserId]);
2025-05-03 05:22:06.539 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Questions_QuizId] ON [Questions] ([QuizId]);
2025-05-03 05:22:06.546 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_QuizId_UserId_CompletedAt] ON [QuizResults] ([QuizId], [UserId], [CompletedAt]);
2025-05-03 05:22:06.552 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_UserGuid] ON [QuizResults] ([UserGuid]);
2025-05-03 05:22:06.558 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Quizzes_CourseId] ON [Quizzes] ([CourseId]);
2025-05-03 05:22:06.566 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Quizzes_LessonId] ON [Quizzes] ([LessonId]);
2025-05-03 05:22:06.574 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Quizzes_LessonId1] ON [Quizzes] ([LessonId1]) WHERE [LessonId1] IS NOT NULL;
2025-05-03 05:22:06.586 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_CourseId] ON [Reviews] ([CourseId]);
2025-05-03 05:22:06.593 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_UserId] ON [Reviews] ([UserId]);
2025-05-03 05:22:06.601 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_AnswerId] ON [UserAnswers] ([AnswerId]);
2025-05-03 05:22:06.608 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_ChoiceId] ON [UserAnswers] ([ChoiceId]);
2025-05-03 05:22:06.618 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_QuestionId] ON [UserAnswers] ([QuestionId]);
2025-05-03 05:22:06.627 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_QuizResultId] ON [UserAnswers] ([QuizResultId]);
2025-05-03 05:22:06.636 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_UserRefreshTokens_RefreshToken] ON [UserRefreshTokens] ([RefreshToken]);
2025-05-03 05:22:06.642 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserRefreshTokens_UserGuid] ON [UserRefreshTokens] ([UserGuid]);
2025-05-03 05:22:06.649 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_Email] ON [Users] ([Email]) WHERE [Email] IS NOT NULL;
2025-05-03 05:22:06.653 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_UserGuid] ON [Users] ([UserGuid]);
2025-05-03 05:22:06.666 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250503022142_InitialCreate', N'8.0.0');
2025-05-03 05:22:28.731 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 05:22:28.837 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 05:22:29.653 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 05:22:29.704 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 05:22:29.713 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 05:22:29.718 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 05:22:29.747 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 05:22:29.775 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-05-03 05:22:30.377 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 05:22:31.676 +03:00 [INF] Executed DbCommand (56ms) [Parameters=[@p0='2025-05-03T02:22:30.8271964Z', @p1='admin@elearning.com' (Size = 450), @p2=' ' (Size = 4000), @p3='True', @p4='$2a$11$Y0jHfOa0iNXqmWEVrU2NWOGDJ2LTfYqZxms17K2Y8vhKA.R0CIjXa' (Size = 4000), @p5='Admin' (Nullable = false) (Size = 4000), @p6=NULL (DbType = DateTime2), @p7='796cdad0-963c-4f1f-b62b-9c7f4a4abcba' (Nullable = false) (Size = 36), @p8='2025-05-03T02:22:31.0824794Z', @p9='instructor@elearning.com' (Size = 450), @p10=' ' (Size = 4000), @p11='True', @p12='$2a$11$A7fn3noSrBxfYoEFSuB3.uo7OPrw2ndIC0BoVjIsX5KUcq4dGKSF.' (Size = 4000), @p13='Instructor' (Nullable = false) (Size = 4000), @p14=NULL (DbType = DateTime2), @p15='0b26fbe9-435f-4f22-8ac6-f3146e559e07' (Nullable = false) (Size = 36), @p16='2025-05-03T02:22:31.3191967Z', @p17='student@elearning.com' (Size = 450), @p18=' ' (Size = 4000), @p19='True', @p20='$2a$11$Km7PXvHFD7paMih6lVpfzuIVgX/dCqNn.L0c9MPSu709ehzdzi2Au' (Size = 4000), @p21='Student' (Nullable = false) (Size = 4000), @p22=NULL (DbType = DateTime2), @p23='1ecf5771-3816-4687-b2d4-2d11d2ac6948' (Nullable = false) (Size = 36)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Users] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, 0),
(@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, 1),
(@p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, 2)) AS i ([CreatedAt], [Email], [FullName], [IsEmailConfirmed], [PasswordHash], [Role], [UpdatedAt], [UserGuid], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [Email], [FullName], [IsEmailConfirmed], [PasswordHash], [Role], [UpdatedAt], [UserGuid])
VALUES (i.[CreatedAt], i.[Email], i.[FullName], i.[IsEmailConfirmed], i.[PasswordHash], i.[Role], i.[UpdatedAt], i.[UserGuid])
OUTPUT INSERTED.[Id], i._Position;
2025-05-03 05:22:31.757 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Courses] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 05:22:31.849 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Role] = N'Instructor') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 05:22:31.929 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Role] = N'Instructor'
2025-05-03 05:22:32.117 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[@p0='0', @p1='2025-05-03T02:22:31.9434877Z', @p2=NULL (Nullable = false) (Size = 4000), @p3='   ' (Size = 4000), @p4=NULL (Size = 4000), @p5='2', @p6='True' (Nullable = true), @p7=NULL (Nullable = false) (Size = 4000), @p8='0' (Precision = 18) (Scale = 2), @p9='  ' (Size = 450), @p10=NULL (DbType = DateTime2), @p11='0', @p12='2025-05-03T02:22:31.9435659Z', @p13=NULL (Nullable = false) (Size = 4000), @p14='      ASP.NET Core' (Size = 4000), @p15=NULL (Size = 4000), @p16='2', @p17='True' (Nullable = true), @p18=NULL (Nullable = false) (Size = 4000), @p19='100' (Precision = 18) (Scale = 2), @p20=' ASP.NET Core' (Size = 450), @p21=NULL (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Courses] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, 0),
(@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, 1)) AS i ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt])
VALUES (i.[CategoryId], i.[CreatedAt], i.[CreatedBy], i.[Description], i.[ImageUrl], i.[InstructorId], i.[IsActive], i.[Name], i.[Price], i.[Title], i.[UpdatedAt])
OUTPUT INSERTED.[Id], i._Position;
2025-05-03 05:22:32.155 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'e_learning.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:0a3cef66-64c5-4f3f-9437-277cc601ce00
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:0a3cef66-64c5-4f3f-9437-277cc601ce00
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-03 05:22:32.195 +03:00 [ERR] Database migration failed
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:0a3cef66-64c5-4f3f-9437-277cc601ce00
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at SeedData.Initialize(IServiceProvider serviceProvider) in C:\Users\ta\OneDrive\Desktop\e_learning\Program.cs:line 356
   at Program.<Main>$(String[] args) in C:\Users\ta\OneDrive\Desktop\e_learning\Program.cs:line 220
2025-05-03 05:22:32.594 +03:00 [INF] Starting application...
2025-05-03 05:22:32.614 +03:00 [INF] User profile is available. Using 'C:\Users\ta\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-03 05:22:32.931 +03:00 [INF] Now listening on: https://localhost:7056
2025-05-03 05:22:32.933 +03:00 [INF] Now listening on: http://localhost:5000
2025-05-03 05:22:32.939 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-03 05:22:32.942 +03:00 [INF] Hosting environment: Development
2025-05-03 05:22:32.943 +03:00 [INF] Content root path: C:\Users\ta\OneDrive\Desktop\e_learning
2025-05-03 05:22:44.470 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/index.html - null null
2025-05-03 05:22:44.623 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/index.html - 200 null text/html;charset=utf-8 155.3677ms
2025-05-03 05:22:44.725 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/swagger-ui-bundle.js - null null
2025-05-03 05:22:44.725 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/swagger-ui.css - null null
2025-05-03 05:22:44.725 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger-ui/custom.css - null null
2025-05-03 05:22:44.725 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/swagger-ui-standalone-preset.js - null null
2025-05-03 05:22:44.771 +03:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-05-03 05:22:44.772 +03:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-05-03 05:22:44.789 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/swagger-ui-standalone-preset.js - 200 230280 text/javascript 64.6032ms
2025-05-03 05:22:44.804 +03:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-05-03 05:22:44.818 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/swagger-ui.css - 200 152034 text/css 93.6185ms
2025-05-03 05:22:44.995 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/swagger-ui-bundle.js - 200 1456926 text/javascript 270.1345ms
2025-05-03 05:22:45.018 +03:00 [INF] HTTP GET /swagger-ui/custom.css responded 404 in 282.0952 ms
2025-05-03 05:22:45.021 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger-ui/custom.css - 404 0 null 297.1146ms
2025-05-03 05:22:45.029 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7056/swagger-ui/custom.css, Response status code: 404
2025-05-03 05:22:45.595 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-03 05:22:45.613 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/favicon-32x32.png - null null
2025-05-03 05:22:45.638 +03:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2025-05-03 05:22:45.639 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/favicon-32x32.png - 200 628 image/png 25.6914ms
2025-05-03 05:22:46.106 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 510.4881ms
2025-05-03 05:24:01.008 +03:00 [INF] Application is shutting down...
2025-05-03 17:26:28.246 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 17:26:28.438 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 17:26:29.678 +03:00 [INF] Executed DbCommand (76ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 17:26:29.790 +03:00 [INF] Executed DbCommand (54ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 17:26:29.802 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 17:26:29.812 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 17:26:29.908 +03:00 [INF] Executed DbCommand (61ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 17:26:30.023 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-05-03 17:26:30.875 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 17:26:31.088 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Courses] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 17:26:31.357 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Role] = N'Instructor') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 17:26:31.527 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Role] = N'Instructor'
2025-05-03 17:26:32.828 +03:00 [INF] Executed DbCommand (193ms) [Parameters=[@p0='0', @p1='2025-05-03T14:26:31.7913482Z', @p2=NULL (Nullable = false) (Size = 4000), @p3='   ' (Size = 4000), @p4=NULL (Size = 4000), @p5='2', @p6='True' (Nullable = true), @p7=NULL (Nullable = false) (Size = 4000), @p8='0' (Precision = 18) (Scale = 2), @p9='  ' (Size = 450), @p10=NULL (DbType = DateTime2), @p11='0', @p12='2025-05-03T14:26:31.7914305Z', @p13=NULL (Nullable = false) (Size = 4000), @p14='      ASP.NET Core' (Size = 4000), @p15=NULL (Size = 4000), @p16='2', @p17='True' (Nullable = true), @p18=NULL (Nullable = false) (Size = 4000), @p19='100' (Precision = 18) (Scale = 2), @p20=' ASP.NET Core' (Size = 450), @p21=NULL (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Courses] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, 0),
(@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, 1)) AS i ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt])
VALUES (i.[CategoryId], i.[CreatedAt], i.[CreatedBy], i.[Description], i.[ImageUrl], i.[InstructorId], i.[IsActive], i.[Name], i.[Price], i.[Title], i.[UpdatedAt])
OUTPUT INSERTED.[Id], i._Position;
2025-05-03 17:26:32.921 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'e_learning.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:db536469-d722-4faf-87b5-6cd078655f7f
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:db536469-d722-4faf-87b5-6cd078655f7f
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-03 17:26:33.078 +03:00 [ERR] Database migration failed
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:db536469-d722-4faf-87b5-6cd078655f7f
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at SeedData.Initialize(IServiceProvider serviceProvider) in C:\Users\ta\OneDrive\Desktop\e_learning\Program.cs:line 356
   at Program.<Main>$(String[] args) in C:\Users\ta\OneDrive\Desktop\e_learning\Program.cs:line 220
2025-05-03 17:26:33.625 +03:00 [INF] Starting application...
2025-05-03 17:26:33.708 +03:00 [INF] User profile is available. Using 'C:\Users\ta\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-03 17:26:34.151 +03:00 [INF] Now listening on: https://localhost:7056
2025-05-03 17:26:34.154 +03:00 [INF] Now listening on: http://localhost:5000
2025-05-03 17:26:34.159 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-03 17:26:34.161 +03:00 [INF] Hosting environment: Development
2025-05-03 17:26:34.163 +03:00 [INF] Content root path: C:\Users\ta\OneDrive\Desktop\e_learning
2025-05-03 17:26:40.594 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/index.html - null null
2025-05-03 17:26:41.114 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/index.html - 200 null text/html;charset=utf-8 526.444ms
2025-05-03 17:26:41.274 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger-ui/custom.css - null null
2025-05-03 17:26:41.674 +03:00 [INF] HTTP GET /swagger-ui/custom.css responded 404 in 297.2490 ms
2025-05-03 17:26:41.683 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger-ui/custom.css - 404 0 null 408.9094ms
2025-05-03 17:26:41.700 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7056/swagger-ui/custom.css, Response status code: 404
2025-05-03 17:26:42.445 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-03 17:26:43.700 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 1255.5971ms
2025-05-03 17:28:17.526 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/register - application/json 116
2025-05-03 17:28:17.539 +03:00 [INF] CORS policy execution failed.
2025-05-03 17:28:17.540 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 17:28:17.591 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.Register (e_learning)'
2025-05-03 17:28:17.624 +03:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(e_learning.DTOs.UserRegisterDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 17:28:17.845 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[@__dto_Email_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__dto_Email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 17:28:18.286 +03:00 [INF] Executed DbCommand (31ms) [Parameters=[@p0='2025-05-03T14:28:18.2393280Z', @p1='abdomoka2018@gmail.com' (Size = 450), @p2='Abdelrahman' (Size = 4000), @p3='False', @p4='$2a$11$LZFjROcztvdrwduHbJANpua4j/pNfRosz1cQDiH6MuhdMr1PwbWEK' (Size = 4000), @p5='Student' (Nullable = false) (Size = 4000), @p6=NULL (DbType = DateTime2), @p7='8232cd02-1b94-4fa7-b6a8-09aa9f5c4fa4' (Nullable = false) (Size = 36)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedAt], [Email], [FullName], [IsEmailConfirmed], [PasswordHash], [Role], [UpdatedAt], [UserGuid])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-05-03 17:28:18.377 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@p0='956429' (Nullable = false) (Size = 6), @p1='2025-05-03T14:28:18.3321905Z', @p2='abdomoka2018@gmail.com' (Nullable = false) (Size = 450), @p3='2025-05-03T14:38:18.3322821Z'], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [EmailConfirmationCodes] ([Code], [CreatedAt], [Email], [ExpiryDate])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-05-03 17:28:22.229 +03:00 [INF]     abdomoka2018@gmail.com 
2025-05-03 17:28:22.237 +03:00 [INF]     - ID: 4
2025-05-03 17:28:22.268 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[e_learning.DTOs.Responses.RegisterResponse, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-03 17:28:22.304 +03:00 [INF] Executed action e_learning.Controllers.AuthController.Register (e_learning) in 4675.0906ms
2025-05-03 17:28:22.306 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.Register (e_learning)'
2025-05-03 17:28:22.308 +03:00 [INF] HTTP POST /api/Auth/register responded 200 in 4778.3711 ms
2025-05-03 17:28:22.328 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/register - 200 null application/json; charset=utf-8 4801.4557ms
2025-05-03 17:29:03.753 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/confirm-email - application/json 59
2025-05-03 17:29:03.852 +03:00 [INF] CORS policy execution failed.
2025-05-03 17:29:03.857 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 17:29:03.865 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.ConfirmEmail (e_learning)'
2025-05-03 17:29:03.890 +03:00 [INF] Route matched with {action = "ConfirmEmail", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ConfirmEmail(e_learning.DTOs.ConfirmEmailDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 17:29:04.075 +03:00 [INF] Executed DbCommand (35ms) [Parameters=[@__ToLower_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Code], [e].[CreatedAt], [e].[Email], [e].[ExpiryDate]
FROM [EmailConfirmationCodes] AS [e]
WHERE [e].[Email] = @__ToLower_0 AND [e].[ExpiryDate] > GETUTCDATE()
ORDER BY [e].[ExpiryDate] DESC
2025-05-03 17:29:04.118 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__dto_Email_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Email] = @__dto_Email_0
2025-05-03 17:29:04.152 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@p1='4', @p0='True'], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [IsEmailConfirmed] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2025-05-03 17:29:04.205 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__ToLower_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[Id], [e].[Code], [e].[CreatedAt], [e].[Email], [e].[ExpiryDate]
FROM [EmailConfirmationCodes] AS [e]
WHERE [e].[Email] = @__ToLower_0
2025-05-03 17:29:04.354 +03:00 [INF] Executed DbCommand (100ms) [Parameters=[@p0='1'], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [EmailConfirmationCodes]
OUTPUT 1
WHERE [Id] = @p0;
2025-05-03 17:29:04.374 +03:00 [INF]     : abdomoka2018@gmail.com
2025-05-03 17:29:04.380 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse'.
2025-05-03 17:29:04.391 +03:00 [INF] Executed action e_learning.Controllers.AuthController.ConfirmEmail (e_learning) in 488.3513ms
2025-05-03 17:29:04.399 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.ConfirmEmail (e_learning)'
2025-05-03 17:29:04.403 +03:00 [INF] HTTP POST /api/Auth/confirm-email responded 200 in 557.8337 ms
2025-05-03 17:29:04.411 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/confirm-email - 200 null application/json; charset=utf-8 657.6952ms
2025-05-03 17:29:26.396 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/login - application/json 67
2025-05-03 17:29:26.433 +03:00 [INF] CORS policy execution failed.
2025-05-03 17:29:26.434 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 17:29:26.436 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 17:29:26.449 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(e_learning.DTOs.UserLoginDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 17:29:26.513 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__dto_Email_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Email] = @__dto_Email_0
2025-05-03 17:29:26.923 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@p0='2025-05-03T14:29:26.8735579Z', @p1='2025-05-10T14:29:26.8734916Z', @p2='BGqms71bgiDVcS762I5hFWi5tzqmGvPH6RhnaUtat8RPe58i56dk2vEtvScV/YUcz5ahOozAAAzpCdnOmXT+gA==' (Nullable = false) (Size = 450), @p3=NULL (Nullable = false) (Size = 36), @p4='4'], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserRefreshTokens] ([CreatedAt], [ExpiryDate], [RefreshToken], [UserGuid], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-05-03 17:29:26.942 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'e_learning.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserGuid', table 'E_LearningDB.dbo.UserRefreshTokens'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:db536469-d722-4faf-87b5-6cd078655f7f
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserGuid', table 'E_LearningDB.dbo.UserRefreshTokens'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:db536469-d722-4faf-87b5-6cd078655f7f
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-03 17:29:26.990 +03:00 [ERR]    
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserGuid', table 'E_LearningDB.dbo.UserRefreshTokens'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:db536469-d722-4faf-87b5-6cd078655f7f
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at e_learning.Controllers.AuthController.StoreRefreshToken(Int32 userId, String refreshToken) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\AuthController .cs:line 434
   at e_learning.Controllers.AuthController.Login(UserLoginDto dto) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\AuthController .cs:line 136
2025-05-03 17:29:27.009 +03:00 [INF] Executing ObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse'.
2025-05-03 17:29:27.011 +03:00 [INF] Executed action e_learning.Controllers.AuthController.Login (e_learning) in 547.1147ms
2025-05-03 17:29:27.013 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 17:29:27.014 +03:00 [ERR] HTTP POST /api/Auth/login responded 500 in 580.8262 ms
2025-05-03 17:29:27.019 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/login - 500 null application/json; charset=utf-8 622.9139ms
2025-05-03 17:29:34.295 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/login - application/json 67
2025-05-03 17:29:34.301 +03:00 [INF] CORS policy execution failed.
2025-05-03 17:29:34.304 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 17:29:34.356 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 17:29:34.367 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(e_learning.DTOs.UserLoginDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 17:29:34.406 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__dto_Email_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Email] = @__dto_Email_0
2025-05-03 17:29:34.706 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='2025-05-03T14:29:34.6958448Z', @p1='2025-05-10T14:29:34.6958257Z', @p2='NZSfa4GrGUxQ3ezfxwAG2SgFxizj/rY6fGS7BuRJaPF/zs7x+m5bbvjvdS2i0q8tAxgwT8PZKVvfYirnUPvNqg==' (Nullable = false) (Size = 450), @p3=NULL (Nullable = false) (Size = 36), @p4='4'], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserRefreshTokens] ([CreatedAt], [ExpiryDate], [RefreshToken], [UserGuid], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-05-03 17:29:34.715 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'e_learning.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserGuid', table 'E_LearningDB.dbo.UserRefreshTokens'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:db536469-d722-4faf-87b5-6cd078655f7f
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserGuid', table 'E_LearningDB.dbo.UserRefreshTokens'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:db536469-d722-4faf-87b5-6cd078655f7f
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-03 17:29:34.801 +03:00 [ERR]    
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserGuid', table 'E_LearningDB.dbo.UserRefreshTokens'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:db536469-d722-4faf-87b5-6cd078655f7f
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at e_learning.Controllers.AuthController.StoreRefreshToken(Int32 userId, String refreshToken) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\AuthController .cs:line 434
   at e_learning.Controllers.AuthController.Login(UserLoginDto dto) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\AuthController .cs:line 136
2025-05-03 17:29:34.831 +03:00 [INF] Executing ObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse'.
2025-05-03 17:29:34.833 +03:00 [INF] Executed action e_learning.Controllers.AuthController.Login (e_learning) in 462.5015ms
2025-05-03 17:29:34.839 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 17:29:34.843 +03:00 [ERR] HTTP POST /api/Auth/login responded 500 in 541.2270 ms
2025-05-03 17:29:34.880 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/login - 500 null application/json; charset=utf-8 584.7025ms
2025-05-03 17:29:55.106 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/login - application/json 66
2025-05-03 17:29:55.110 +03:00 [INF] CORS policy execution failed.
2025-05-03 17:29:55.111 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 17:29:55.113 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 17:29:55.114 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(e_learning.DTOs.UserLoginDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 17:29:55.164 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@__dto_Email_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Email] = @__dto_Email_0
2025-05-03 17:29:55.404 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='2025-05-03T14:29:55.3920938Z', @p1='2025-05-10T14:29:55.3920813Z', @p2='N90Q7YsC9cJGVzmpFzwVuPx7Hght1udetfgtv3glPbYEv+OYmYVN5msBhwPhPFHWnPZT0Mw4rmZ4jbmL3OYWkQ==' (Nullable = false) (Size = 450), @p3=NULL (Nullable = false) (Size = 36), @p4='4'], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserRefreshTokens] ([CreatedAt], [ExpiryDate], [RefreshToken], [UserGuid], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-05-03 17:29:55.425 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'e_learning.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserGuid', table 'E_LearningDB.dbo.UserRefreshTokens'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:db536469-d722-4faf-87b5-6cd078655f7f
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserGuid', table 'E_LearningDB.dbo.UserRefreshTokens'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:db536469-d722-4faf-87b5-6cd078655f7f
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-03 17:29:55.468 +03:00 [ERR]    
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'UserGuid', table 'E_LearningDB.dbo.UserRefreshTokens'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:db536469-d722-4faf-87b5-6cd078655f7f
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at e_learning.Controllers.AuthController.StoreRefreshToken(Int32 userId, String refreshToken) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\AuthController .cs:line 434
   at e_learning.Controllers.AuthController.Login(UserLoginDto dto) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\AuthController .cs:line 136
2025-05-03 17:29:55.496 +03:00 [INF] Executing ObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse'.
2025-05-03 17:29:55.499 +03:00 [INF] Executed action e_learning.Controllers.AuthController.Login (e_learning) in 373.3941ms
2025-05-03 17:29:55.501 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 17:29:55.502 +03:00 [ERR] HTTP POST /api/Auth/login responded 500 in 392.5151 ms
2025-05-03 17:29:55.507 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/login - 500 null application/json; charset=utf-8 401.3445ms
2025-05-03 17:52:50.538 +03:00 [INF] Application is shutting down...
2025-05-03 18:40:34.879 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 18:40:35.024 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 18:40:35.596 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 18:41:02.966 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 18:41:03.046 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 18:41:04.087 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 18:41:04.127 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 18:41:04.138 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 18:41:04.145 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 18:41:04.253 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 18:41:04.285 +03:00 [INF] Applying migration '20250503154036_Updates'.
2025-05-03 18:41:05.104 +03:00 [INF] Executed DbCommand (734ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[UserRefreshTokens].[UserId]', N'ExpiresIn', N'COLUMN';
2025-05-03 18:41:05.124 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250503154036_Updates', N'8.0.0');
2025-05-03 18:41:39.200 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 18:41:39.277 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 18:41:39.911 +03:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 18:41:39.957 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 18:41:39.967 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 18:41:39.973 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 18:41:40.002 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 18:41:40.037 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-05-03 18:41:40.390 +03:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 18:41:40.449 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Courses] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 18:41:40.525 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Role] = N'Instructor') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 18:41:40.633 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Role] = N'Instructor'
2025-05-03 18:41:41.118 +03:00 [INF] Executed DbCommand (92ms) [Parameters=[@p0='0', @p1='2025-05-03T15:41:40.7881881Z', @p2=NULL (Nullable = false) (Size = 4000), @p3='   ' (Size = 4000), @p4=NULL (Size = 4000), @p5='2', @p6='True' (Nullable = true), @p7=NULL (Nullable = false) (Size = 4000), @p8='0' (Precision = 18) (Scale = 2), @p9='  ' (Size = 450), @p10=NULL (DbType = DateTime2), @p11='0', @p12='2025-05-03T15:41:40.7882414Z', @p13=NULL (Nullable = false) (Size = 4000), @p14='      ASP.NET Core' (Size = 4000), @p15=NULL (Size = 4000), @p16='2', @p17='True' (Nullable = true), @p18=NULL (Nullable = false) (Size = 4000), @p19='100' (Precision = 18) (Scale = 2), @p20=' ASP.NET Core' (Size = 450), @p21=NULL (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Courses] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, 0),
(@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, 1)) AS i ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt])
VALUES (i.[CategoryId], i.[CreatedAt], i.[CreatedBy], i.[Description], i.[ImageUrl], i.[InstructorId], i.[IsActive], i.[Name], i.[Price], i.[Title], i.[UpdatedAt])
OUTPUT INSERTED.[Id], i._Position;
2025-05-03 18:41:41.184 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'e_learning.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:904df989-dcce-4ea7-b4de-02bf69e73cd3
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:904df989-dcce-4ea7-b4de-02bf69e73cd3
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-03 18:41:41.213 +03:00 [ERR] Database migration failed
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:904df989-dcce-4ea7-b4de-02bf69e73cd3
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at SeedData.Initialize(IServiceProvider serviceProvider) in C:\Users\ta\OneDrive\Desktop\e_learning\Program.cs:line 357
   at Program.<Main>$(String[] args) in C:\Users\ta\OneDrive\Desktop\e_learning\Program.cs:line 221
2025-05-03 18:41:41.543 +03:00 [INF] Starting application...
2025-05-03 18:41:41.574 +03:00 [INF] User profile is available. Using 'C:\Users\ta\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-03 18:41:41.799 +03:00 [INF] Now listening on: https://localhost:7056
2025-05-03 18:41:41.801 +03:00 [INF] Now listening on: http://localhost:5000
2025-05-03 18:41:41.806 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-03 18:41:41.807 +03:00 [INF] Hosting environment: Development
2025-05-03 18:41:41.808 +03:00 [INF] Content root path: C:\Users\ta\OneDrive\Desktop\e_learning
2025-05-03 18:41:52.527 +03:00 [INF] Application is shutting down...
2025-05-03 18:42:13.882 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 18:42:13.997 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 18:42:14.705 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 18:42:14.849 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [E_LearningDB] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2025-05-03 18:42:15.324 +03:00 [INF] Executed DbCommand (471ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [E_LearningDB];
2025-05-03 18:42:32.756 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 18:42:32.840 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 18:42:33.336 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 18:42:43.712 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 18:42:43.839 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 18:42:44.568 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 18:42:45.054 +03:00 [INF] Executed DbCommand (366ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [E_LearningDB];
2025-05-03 18:42:45.167 +03:00 [INF] Executed DbCommand (102ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [E_LearningDB] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-05-03 18:42:45.208 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 18:42:45.298 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-05-03 18:42:45.305 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 18:42:45.328 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 18:42:45.501 +03:00 [INF] Executed DbCommand (165ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 18:42:45.552 +03:00 [INF] Applying migration '20250503022142_InitialCreate'.
2025-05-03 18:42:45.798 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-05-03 18:42:45.814 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [EmailConfirmationCodes] (
    [Id] int NOT NULL IDENTITY,
    [Email] nvarchar(450) NOT NULL,
    [Code] nvarchar(6) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_EmailConfirmationCodes] PRIMARY KEY ([Id])
);
2025-05-03 18:42:45.822 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PasswordResetCodes] (
    [Id] int NOT NULL IDENTITY,
    [Email] nvarchar(450) NOT NULL,
    [Code] nvarchar(6) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_PasswordResetCodes] PRIMARY KEY ([Id])
);
2025-05-03 18:42:45.838 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] int NOT NULL IDENTITY,
    [UserGuid] nvarchar(36) NOT NULL,
    [FullName] nvarchar(max) NULL,
    [Email] nvarchar(450) NULL,
    [PasswordHash] nvarchar(max) NULL,
    [Role] nvarchar(max) NOT NULL,
    [IsEmailConfirmed] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id]),
    CONSTRAINT [AK_Users_UserGuid] UNIQUE ([UserGuid])
);
2025-05-03 18:42:45.854 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Courses] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    [Title] nvarchar(450) NULL,
    [Description] nvarchar(max) NULL,
    [Price] decimal(18,2) NOT NULL,
    [ImageUrl] nvarchar(max) NULL,
    [IsActive] bit NULL,
    [CategoryId] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [UpdatedAt] datetime2 NULL,
    [CreatedBy] nvarchar(max) NOT NULL,
    [InstructorId] int NOT NULL,
    CONSTRAINT [PK_Courses] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Courses_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Courses_Users_InstructorId] FOREIGN KEY ([InstructorId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 18:42:45.870 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Notifications] (
    [Id] uniqueidentifier NOT NULL,
    [Title] nvarchar(100) NOT NULL,
    [Message] nvarchar(max) NOT NULL,
    [UserId] int NOT NULL,
    [SenderId] nvarchar(max) NULL,
    [IsRead] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NULL,
    [NotificationType] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Notifications] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Notifications_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 18:42:45.884 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Profiles] (
    [Id] int NOT NULL IDENTITY,
    [Bio] nvarchar(max) NULL,
    [ProfilePicture] nvarchar(max) NULL,
    [Address] nvarchar(max) NULL,
    [Phone] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_Profiles] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Profiles_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 18:42:45.898 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserRefreshTokens] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [UserGuid] nvarchar(36) NOT NULL,
    [RefreshToken] nvarchar(450) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_UserRefreshTokens] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_UserRefreshTokens_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE CASCADE
);
2025-05-03 18:42:45.912 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Enrollments] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [CourseId] int NOT NULL,
    CONSTRAINT [PK_Enrollments] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Enrollments_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Enrollments_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 18:42:45.927 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Lessons] (
    [Id] int NOT NULL IDENTITY,
    [Title] nvarchar(200) NOT NULL,
    [Description] nvarchar(1000) NOT NULL,
    [Type] nvarchar(20) NOT NULL,
    [Content] nvarchar(max) NOT NULL,
    [VideoUrl] nvarchar(max) NOT NULL,
    [PdfUrl] nvarchar(max) NOT NULL,
    [Duration] int NOT NULL,
    [IsFree] bit NOT NULL,
    [IsSequential] bit NOT NULL,
    [Order] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [UpdatedAt] datetime2 NULL,
    [CreatedBy] nvarchar(max) NOT NULL,
    [CourseId] int NOT NULL,
    CONSTRAINT [PK_Lessons] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Lessons_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE
);
2025-05-03 18:42:45.936 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Messages] (
    [Id] int NOT NULL IDENTITY,
    [SenderId] int NOT NULL,
    [CourseId] int NOT NULL,
    [Text] nvarchar(max) NULL,
    [AttachmentUrl] nvarchar(max) NULL,
    [SentAt] datetime2 NOT NULL,
    [ReplyToMessageId] int NULL,
    [IsSeen] bit NOT NULL,
    CONSTRAINT [PK_Messages] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Messages_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Messages_Messages_ReplyToMessageId] FOREIGN KEY ([ReplyToMessageId]) REFERENCES [Messages] ([Id]),
    CONSTRAINT [FK_Messages_Users_SenderId] FOREIGN KEY ([SenderId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 18:42:45.948 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Payments] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [CourseId] int NOT NULL,
    [Amount] decimal(18,2) NOT NULL,
    [PaymentMethod] nvarchar(max) NULL,
    [IsSuccessful] bit NOT NULL,
    [PaidAt] datetime2 NOT NULL,
    [TransactionId] nvarchar(max) NULL,
    CONSTRAINT [PK_Payments] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Payments_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Payments_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 18:42:45.962 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Reviews] (
    [Id] int NOT NULL IDENTITY,
    [CourseId] int NOT NULL,
    [UserId] int NOT NULL,
    [Rating] int NOT NULL,
    [Comment] nvarchar(max) NULL,
    CONSTRAINT [PK_Reviews] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Reviews_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Reviews_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 18:42:45.978 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [LessonMaterials] (
    [Id] int NOT NULL IDENTITY,
    [FileName] nvarchar(max) NOT NULL,
    [FileUrl] nvarchar(max) NOT NULL,
    [Description] nvarchar(max) NOT NULL,
    [FileSize] bigint NOT NULL,
    [UploadedAt] datetime2 NOT NULL,
    [UploadedById] nvarchar(max) NOT NULL,
    [LessonId] int NOT NULL,
    CONSTRAINT [PK_LessonMaterials] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_LessonMaterials_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE
);
2025-05-03 18:42:45.990 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [LessonProgresses] (
    [Id] int NOT NULL IDENTITY,
    [UserGuid] nvarchar(36) NOT NULL,
    [IsCompleted] bit NOT NULL DEFAULT CAST(0 AS bit),
    [ProgressPercentage] int NOT NULL DEFAULT 0,
    [StartedAt] datetime2 NULL,
    [CompletedAt] datetime2 NULL,
    [TimeSpent] time NOT NULL,
    [LessonId] int NOT NULL,
    [UserId] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_LessonProgresses] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_LessonProgresses_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_LessonProgresses_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE CASCADE
);
2025-05-03 18:42:46.001 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Quizzes] (
    [Id] int NOT NULL IDENTITY,
    [Title] nvarchar(max) NOT NULL,
    [Description] nvarchar(max) NOT NULL,
    [PassingScore] int NOT NULL DEFAULT 70,
    [IsMandatory] bit NOT NULL,
    [MaxAttempts] int NOT NULL,
    [TimeLimitMinutes] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [CreatedBy] nvarchar(max) NOT NULL,
    [Status] int NOT NULL,
    [LessonId] int NOT NULL,
    [CourseId] int NULL,
    [LessonId1] int NULL,
    CONSTRAINT [PK_Quizzes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Quizzes_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]),
    CONSTRAINT [FK_Quizzes_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Quizzes_Lessons_LessonId1] FOREIGN KEY ([LessonId1]) REFERENCES [Lessons] ([Id])
);
2025-05-03 18:42:46.011 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Questions] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [Type] int NOT NULL,
    [Points] int NOT NULL,
    [QuizId] int NOT NULL,
    CONSTRAINT [PK_Questions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Questions_Quizzes_QuizId] FOREIGN KEY ([QuizId]) REFERENCES [Quizzes] ([Id]) ON DELETE CASCADE
);
2025-05-03 18:42:46.017 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [QuizResults] (
    [Id] int NOT NULL IDENTITY,
    [UserGuid] nvarchar(36) NOT NULL,
    [Score] decimal(5,2) NOT NULL,
    [IsPassed] bit NOT NULL,
    [StartedAt] datetime2 NOT NULL,
    [CompletedAt] datetime2 NULL,
    [Status] int NOT NULL,
    [QuizId] int NOT NULL,
    [UserId] nvarchar(450) NOT NULL,
    CONSTRAINT [PK_QuizResults] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_QuizResults_Quizzes_QuizId] FOREIGN KEY ([QuizId]) REFERENCES [Quizzes] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_QuizResults_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE NO ACTION
);
2025-05-03 18:42:46.024 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Answers] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL DEFAULT CAST(0 AS bit),
    [QuestionId] int NOT NULL,
    CONSTRAINT [PK_Answers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Answers_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE CASCADE
);
2025-05-03 18:42:46.032 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Choice] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL,
    [QuestionId] int NOT NULL,
    CONSTRAINT [PK_Choice] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Choice_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE CASCADE
);
2025-05-03 18:42:46.040 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserAnswers] (
    [Id] int NOT NULL IDENTITY,
    [AnswerText] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL,
    [ChoiceId] int NULL,
    [QuestionId] int NOT NULL,
    [QuizResultId] int NOT NULL,
    [AnswerId] int NOT NULL,
    CONSTRAINT [PK_UserAnswers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_UserAnswers_Answers_AnswerId] FOREIGN KEY ([AnswerId]) REFERENCES [Answers] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_UserAnswers_Choice_ChoiceId] FOREIGN KEY ([ChoiceId]) REFERENCES [Choice] ([Id]),
    CONSTRAINT [FK_UserAnswers_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_UserAnswers_QuizResults_QuizResultId] FOREIGN KEY ([QuizResultId]) REFERENCES [QuizResults] ([Id]) ON DELETE CASCADE
);
2025-05-03 18:42:46.052 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Answers_QuestionId] ON [Answers] ([QuestionId]);
2025-05-03 18:42:46.061 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Choice_QuestionId] ON [Choice] ([QuestionId]);
2025-05-03 18:42:46.066 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_CategoryId] ON [Courses] ([CategoryId]);
2025-05-03 18:42:46.072 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_InstructorId] ON [Courses] ([InstructorId]);
2025-05-03 18:42:46.079 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_Title] ON [Courses] ([Title]);
2025-05-03 18:42:46.084 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_EmailConfirmationCodes_Email] ON [EmailConfirmationCodes] ([Email]);
2025-05-03 18:42:46.089 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Enrollments_CourseId] ON [Enrollments] ([CourseId]);
2025-05-03 18:42:46.097 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Enrollments_UserId] ON [Enrollments] ([UserId]);
2025-05-03 18:42:46.103 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonMaterials_LessonId] ON [LessonMaterials] ([LessonId]);
2025-05-03 18:42:46.113 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonProgresses_LessonId] ON [LessonProgresses] ([LessonId]);
2025-05-03 18:42:46.118 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonProgresses_UserGuid] ON [LessonProgresses] ([UserGuid]);
2025-05-03 18:42:46.124 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Lessons_CourseId_Order] ON [Lessons] ([CourseId], [Order]);
2025-05-03 18:42:46.132 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_CourseId] ON [Messages] ([CourseId]);
2025-05-03 18:42:46.139 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_ReplyToMessageId] ON [Messages] ([ReplyToMessageId]);
2025-05-03 18:42:46.147 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_SenderId] ON [Messages] ([SenderId]);
2025-05-03 18:42:46.152 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Notifications_UserId] ON [Notifications] ([UserId]);
2025-05-03 18:42:46.159 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PasswordResetCodes_Email] ON [PasswordResetCodes] ([Email]);
2025-05-03 18:42:46.167 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_CourseId] ON [Payments] ([CourseId]);
2025-05-03 18:42:46.172 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_UserId] ON [Payments] ([UserId]);
2025-05-03 18:42:46.180 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Profiles_UserId] ON [Profiles] ([UserId]);
2025-05-03 18:42:46.187 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Questions_QuizId] ON [Questions] ([QuizId]);
2025-05-03 18:42:46.196 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_QuizId_UserId_CompletedAt] ON [QuizResults] ([QuizId], [UserId], [CompletedAt]);
2025-05-03 18:42:46.202 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_UserGuid] ON [QuizResults] ([UserGuid]);
2025-05-03 18:42:46.212 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Quizzes_CourseId] ON [Quizzes] ([CourseId]);
2025-05-03 18:42:46.218 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Quizzes_LessonId] ON [Quizzes] ([LessonId]);
2025-05-03 18:42:46.227 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Quizzes_LessonId1] ON [Quizzes] ([LessonId1]) WHERE [LessonId1] IS NOT NULL;
2025-05-03 18:42:46.232 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_CourseId] ON [Reviews] ([CourseId]);
2025-05-03 18:42:46.238 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_UserId] ON [Reviews] ([UserId]);
2025-05-03 18:42:46.245 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_AnswerId] ON [UserAnswers] ([AnswerId]);
2025-05-03 18:42:46.251 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_ChoiceId] ON [UserAnswers] ([ChoiceId]);
2025-05-03 18:42:46.256 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_QuestionId] ON [UserAnswers] ([QuestionId]);
2025-05-03 18:42:46.262 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_QuizResultId] ON [UserAnswers] ([QuizResultId]);
2025-05-03 18:42:46.266 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_UserRefreshTokens_RefreshToken] ON [UserRefreshTokens] ([RefreshToken]);
2025-05-03 18:42:46.270 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserRefreshTokens_UserGuid] ON [UserRefreshTokens] ([UserGuid]);
2025-05-03 18:42:46.276 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_Email] ON [Users] ([Email]) WHERE [Email] IS NOT NULL;
2025-05-03 18:42:46.280 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_UserGuid] ON [Users] ([UserGuid]);
2025-05-03 18:42:46.292 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250503022142_InitialCreate', N'8.0.0');
2025-05-03 18:42:46.302 +03:00 [INF] Applying migration '20250503154036_Updates'.
2025-05-03 18:42:46.775 +03:00 [INF] Executed DbCommand (414ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
EXEC sp_rename N'[UserRefreshTokens].[UserId]', N'ExpiresIn', N'COLUMN';
2025-05-03 18:42:46.783 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250503154036_Updates', N'8.0.0');
2025-05-03 18:42:58.118 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 18:42:58.197 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 18:42:58.806 +03:00 [INF] Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 18:42:58.899 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 18:42:58.910 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 18:42:58.917 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 18:42:58.938 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 18:42:58.963 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-05-03 18:42:59.293 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 18:43:00.677 +03:00 [INF] Executed DbCommand (78ms) [Parameters=[@p0='2025-05-03T15:42:59.7170350Z', @p1='admin@elearning.com' (Size = 450), @p2=' ' (Size = 4000), @p3='True', @p4='$2a$11$wKkTPr3wrszbRzflIecr4.rq1tMQWNEdYTaXlap5o8ggakYB/j6rq' (Size = 4000), @p5='Admin' (Nullable = false) (Size = 4000), @p6=NULL (DbType = DateTime2), @p7='602fe447-cfb4-4ad9-9337-401537a8ff1d' (Nullable = false) (Size = 36), @p8='2025-05-03T15:42:59.9603251Z', @p9='instructor@elearning.com' (Size = 450), @p10=' ' (Size = 4000), @p11='True', @p12='$2a$11$TGV4O7R1cReGn1P/2/rlnOgJqyy6txQW52O4gG3/sWN2WIdPweyLi' (Size = 4000), @p13='Instructor' (Nullable = false) (Size = 4000), @p14=NULL (DbType = DateTime2), @p15='d23c947b-7ad7-44ff-af4b-621f2e54384b' (Nullable = false) (Size = 36), @p16='2025-05-03T15:43:00.2296455Z', @p17='student@elearning.com' (Size = 450), @p18=' ' (Size = 4000), @p19='True', @p20='$2a$11$mfzyJfz0H4mosFohbD4rl.3ExA5vzvC2Wbhurf0BrhByrjzv/XTzO' (Size = 4000), @p21='Student' (Nullable = false) (Size = 4000), @p22=NULL (DbType = DateTime2), @p23='efe68bc0-41d7-4ff6-9be1-ba341e628e11' (Nullable = false) (Size = 36)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Users] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, 0),
(@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, 1),
(@p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, 2)) AS i ([CreatedAt], [Email], [FullName], [IsEmailConfirmed], [PasswordHash], [Role], [UpdatedAt], [UserGuid], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [Email], [FullName], [IsEmailConfirmed], [PasswordHash], [Role], [UpdatedAt], [UserGuid])
VALUES (i.[CreatedAt], i.[Email], i.[FullName], i.[IsEmailConfirmed], i.[PasswordHash], i.[Role], i.[UpdatedAt], i.[UserGuid])
OUTPUT INSERTED.[Id], i._Position;
2025-05-03 18:43:00.912 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Courses] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 18:43:01.004 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Role] = N'Instructor') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 18:43:01.117 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Role] = N'Instructor'
2025-05-03 18:43:01.379 +03:00 [INF] Executed DbCommand (47ms) [Parameters=[@p0='0', @p1='2025-05-03T15:43:01.1443307Z', @p2=NULL (Nullable = false) (Size = 4000), @p3='   ' (Size = 4000), @p4=NULL (Size = 4000), @p5='2', @p6='True' (Nullable = true), @p7=NULL (Nullable = false) (Size = 4000), @p8='0' (Precision = 18) (Scale = 2), @p9='  ' (Size = 450), @p10=NULL (DbType = DateTime2), @p11='0', @p12='2025-05-03T15:43:01.1444167Z', @p13=NULL (Nullable = false) (Size = 4000), @p14='      ASP.NET Core' (Size = 4000), @p15=NULL (Size = 4000), @p16='2', @p17='True' (Nullable = true), @p18=NULL (Nullable = false) (Size = 4000), @p19='100' (Precision = 18) (Scale = 2), @p20=' ASP.NET Core' (Size = 450), @p21=NULL (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Courses] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, 0),
(@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, 1)) AS i ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt])
VALUES (i.[CategoryId], i.[CreatedAt], i.[CreatedBy], i.[Description], i.[ImageUrl], i.[InstructorId], i.[IsActive], i.[Name], i.[Price], i.[Title], i.[UpdatedAt])
OUTPUT INSERTED.[Id], i._Position;
2025-05-03 18:43:01.452 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'e_learning.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:cbd9f80f-ad7f-4c5c-9c9a-8c9b6013d2ef
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:cbd9f80f-ad7f-4c5c-9c9a-8c9b6013d2ef
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-03 18:43:01.714 +03:00 [ERR] Database migration failed
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:cbd9f80f-ad7f-4c5c-9c9a-8c9b6013d2ef
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at SeedData.Initialize(IServiceProvider serviceProvider) in C:\Users\ta\OneDrive\Desktop\e_learning\Program.cs:line 357
   at Program.<Main>$(String[] args) in C:\Users\ta\OneDrive\Desktop\e_learning\Program.cs:line 221
2025-05-03 18:43:02.114 +03:00 [INF] Starting application...
2025-05-03 18:43:02.138 +03:00 [INF] User profile is available. Using 'C:\Users\ta\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-03 18:43:02.327 +03:00 [INF] Now listening on: https://localhost:7056
2025-05-03 18:43:02.353 +03:00 [INF] Now listening on: http://localhost:5000
2025-05-03 18:43:02.362 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-03 18:43:02.366 +03:00 [INF] Hosting environment: Development
2025-05-03 18:43:02.378 +03:00 [INF] Content root path: C:\Users\ta\OneDrive\Desktop\e_learning
2025-05-03 18:57:06.658 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 18:57:06.791 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 18:57:07.528 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 18:57:28.312 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 18:57:28.428 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 18:57:29.170 +03:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 18:57:29.227 +03:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 18:57:29.239 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 18:57:29.247 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 18:57:29.276 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 18:57:29.297 +03:00 [INF] Applying migration '20250503155708_InitialCreate'.
2025-05-03 18:57:29.483 +03:00 [ERR] Failed executing DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-05-03 18:59:10.780 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 18:59:10.854 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 18:59:11.743 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 18:59:11.948 +03:00 [INF] Executed DbCommand (69ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [E_LearningDB] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2025-05-03 18:59:12.125 +03:00 [INF] Executed DbCommand (173ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [E_LearningDB];
2025-05-03 18:59:30.836 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 18:59:30.924 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 18:59:31.945 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 18:59:32.359 +03:00 [INF] Executed DbCommand (313ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [E_LearningDB];
2025-05-03 18:59:32.435 +03:00 [INF] Executed DbCommand (66ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [E_LearningDB] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-05-03 18:59:32.476 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 18:59:32.610 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-05-03 18:59:32.625 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 18:59:32.652 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 18:59:32.678 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 18:59:32.711 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-05-03 18:59:47.945 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 18:59:48.034 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 18:59:48.581 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 19:00:04.170 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 19:00:04.288 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 19:00:05.030 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 19:00:05.103 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 19:00:05.175 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 19:00:05.191 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 19:00:05.251 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 19:00:05.285 +03:00 [INF] Applying migration '20250503155949_InitialCreate'.
2025-05-03 19:00:05.481 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-05-03 19:00:05.499 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [EmailConfirmationCodes] (
    [Id] int NOT NULL IDENTITY,
    [Email] nvarchar(450) NOT NULL,
    [Code] nvarchar(6) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_EmailConfirmationCodes] PRIMARY KEY ([Id])
);
2025-05-03 19:00:05.511 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PasswordResetCodes] (
    [Id] int NOT NULL IDENTITY,
    [Email] nvarchar(450) NOT NULL,
    [Code] nvarchar(6) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_PasswordResetCodes] PRIMARY KEY ([Id])
);
2025-05-03 19:00:05.527 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] int NOT NULL IDENTITY,
    [UserGuid] nvarchar(36) NOT NULL,
    [FullName] nvarchar(max) NULL,
    [Email] nvarchar(450) NULL,
    [PasswordHash] nvarchar(max) NULL,
    [Role] nvarchar(max) NOT NULL,
    [IsEmailConfirmed] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id]),
    CONSTRAINT [AK_Users_UserGuid] UNIQUE ([UserGuid])
);
2025-05-03 19:00:05.547 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Courses] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    [Title] nvarchar(450) NULL,
    [Description] nvarchar(max) NULL,
    [Price] decimal(18,2) NOT NULL,
    [ImageUrl] nvarchar(max) NULL,
    [IsActive] bit NULL,
    [CategoryId] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [UpdatedAt] datetime2 NULL,
    [CreatedBy] nvarchar(max) NOT NULL,
    [InstructorId] int NOT NULL,
    CONSTRAINT [PK_Courses] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Courses_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Courses_Users_InstructorId] FOREIGN KEY ([InstructorId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 19:00:05.565 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Notifications] (
    [Id] uniqueidentifier NOT NULL,
    [Title] nvarchar(100) NOT NULL,
    [Message] nvarchar(max) NOT NULL,
    [UserId] int NOT NULL,
    [SenderId] nvarchar(max) NULL,
    [IsRead] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NULL,
    [NotificationType] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Notifications] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Notifications_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:00:05.590 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Profiles] (
    [Id] int NOT NULL IDENTITY,
    [Bio] nvarchar(max) NULL,
    [ProfilePicture] nvarchar(max) NULL,
    [Address] nvarchar(max) NULL,
    [Phone] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_Profiles] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Profiles_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:00:05.602 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserRefreshTokens] (
    [Id] int NOT NULL IDENTITY,
    [UserGuid] nvarchar(36) NOT NULL,
    [RefreshToken] nvarchar(450) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [ExpiresIn] int NOT NULL,
    CONSTRAINT [PK_UserRefreshTokens] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_UserRefreshTokens_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE CASCADE
);
2025-05-03 19:00:05.638 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Enrollments] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [CourseId] int NOT NULL,
    CONSTRAINT [PK_Enrollments] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Enrollments_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Enrollments_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 19:00:05.731 +03:00 [INF] Executed DbCommand (82ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Lessons] (
    [Id] int NOT NULL IDENTITY,
    [Title] nvarchar(200) NOT NULL,
    [Description] nvarchar(1000) NOT NULL,
    [Type] nvarchar(20) NOT NULL,
    [Content] nvarchar(max) NOT NULL,
    [VideoUrl] nvarchar(max) NOT NULL,
    [PdfUrl] nvarchar(max) NOT NULL,
    [Duration] int NOT NULL,
    [IsFree] bit NOT NULL,
    [IsSequential] bit NOT NULL,
    [Order] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [UpdatedAt] datetime2 NULL,
    [CreatedBy] nvarchar(max) NOT NULL,
    [CourseId] int NOT NULL,
    CONSTRAINT [PK_Lessons] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Lessons_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:00:05.762 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Messages] (
    [Id] int NOT NULL IDENTITY,
    [SenderId] int NOT NULL,
    [CourseId] int NOT NULL,
    [Text] nvarchar(max) NULL,
    [AttachmentUrl] nvarchar(max) NULL,
    [SentAt] datetime2 NOT NULL,
    [ReplyToMessageId] int NULL,
    [IsSeen] bit NOT NULL,
    CONSTRAINT [PK_Messages] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Messages_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Messages_Messages_ReplyToMessageId] FOREIGN KEY ([ReplyToMessageId]) REFERENCES [Messages] ([Id]),
    CONSTRAINT [FK_Messages_Users_SenderId] FOREIGN KEY ([SenderId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:00:05.780 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Payments] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [CourseId] int NOT NULL,
    [Amount] decimal(18,2) NOT NULL,
    [PaymentMethod] nvarchar(max) NULL,
    [IsSuccessful] bit NOT NULL,
    [PaidAt] datetime2 NOT NULL,
    [TransactionId] nvarchar(max) NULL,
    CONSTRAINT [PK_Payments] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Payments_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Payments_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:00:05.793 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Reviews] (
    [Id] int NOT NULL IDENTITY,
    [CourseId] int NOT NULL,
    [UserId] int NOT NULL,
    [Rating] int NOT NULL,
    [Comment] nvarchar(max) NULL,
    CONSTRAINT [PK_Reviews] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Reviews_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Reviews_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:00:05.809 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [LessonMaterials] (
    [Id] int NOT NULL IDENTITY,
    [FileName] nvarchar(max) NOT NULL,
    [FileUrl] nvarchar(max) NOT NULL,
    [Description] nvarchar(max) NOT NULL,
    [FileSize] bigint NOT NULL,
    [UploadedAt] datetime2 NOT NULL,
    [UploadedById] nvarchar(max) NOT NULL,
    [LessonId] int NOT NULL,
    CONSTRAINT [PK_LessonMaterials] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_LessonMaterials_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:00:05.824 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [LessonProgresses] (
    [Id] int NOT NULL IDENTITY,
    [UserGuid] nvarchar(36) NOT NULL,
    [IsCompleted] bit NOT NULL DEFAULT CAST(0 AS bit),
    [ProgressPercentage] int NOT NULL DEFAULT 0,
    [StartedAt] datetime2 NULL,
    [CompletedAt] datetime2 NULL,
    [TimeSpent] time NOT NULL,
    [LessonId] int NOT NULL,
    [UserId] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_LessonProgresses] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_LessonProgresses_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_LessonProgresses_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE CASCADE
);
2025-05-03 19:00:05.838 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Quizzes] (
    [Id] int NOT NULL IDENTITY,
    [Title] nvarchar(max) NOT NULL,
    [Description] nvarchar(max) NOT NULL,
    [PassingScore] int NOT NULL DEFAULT 70,
    [IsMandatory] bit NOT NULL,
    [MaxAttempts] int NOT NULL,
    [TimeLimitMinutes] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [CreatedBy] nvarchar(max) NOT NULL,
    [Status] int NOT NULL,
    [LessonId] int NOT NULL,
    [CourseId] int NULL,
    [LessonId1] int NULL,
    CONSTRAINT [PK_Quizzes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Quizzes_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]),
    CONSTRAINT [FK_Quizzes_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Quizzes_Lessons_LessonId1] FOREIGN KEY ([LessonId1]) REFERENCES [Lessons] ([Id])
);
2025-05-03 19:00:05.848 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Questions] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [Type] int NOT NULL,
    [Points] int NOT NULL,
    [QuizId] int NOT NULL,
    CONSTRAINT [PK_Questions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Questions_Quizzes_QuizId] FOREIGN KEY ([QuizId]) REFERENCES [Quizzes] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:00:05.861 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [QuizResults] (
    [Id] int NOT NULL IDENTITY,
    [UserGuid] nvarchar(36) NOT NULL,
    [Score] decimal(5,2) NOT NULL,
    [IsPassed] bit NOT NULL,
    [StartedAt] datetime2 NOT NULL,
    [CompletedAt] datetime2 NULL,
    [Status] int NOT NULL,
    [QuizId] int NOT NULL,
    [UserId] nvarchar(450) NOT NULL,
    CONSTRAINT [PK_QuizResults] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_QuizResults_Quizzes_QuizId] FOREIGN KEY ([QuizId]) REFERENCES [Quizzes] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_QuizResults_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE NO ACTION
);
2025-05-03 19:00:05.873 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Answers] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL DEFAULT CAST(0 AS bit),
    [QuestionId] int NOT NULL,
    CONSTRAINT [PK_Answers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Answers_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:00:05.881 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Choice] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL,
    [QuestionId] int NOT NULL,
    CONSTRAINT [PK_Choice] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Choice_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:00:05.895 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserAnswers] (
    [Id] int NOT NULL IDENTITY,
    [AnswerText] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL,
    [ChoiceId] int NULL,
    [QuestionId] int NOT NULL,
    [QuizResultId] int NOT NULL,
    [AnswerId] int NOT NULL,
    CONSTRAINT [PK_UserAnswers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_UserAnswers_Answers_AnswerId] FOREIGN KEY ([AnswerId]) REFERENCES [Answers] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_UserAnswers_Choice_ChoiceId] FOREIGN KEY ([ChoiceId]) REFERENCES [Choice] ([Id]),
    CONSTRAINT [FK_UserAnswers_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_UserAnswers_QuizResults_QuizResultId] FOREIGN KEY ([QuizResultId]) REFERENCES [QuizResults] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:00:05.911 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Answers_QuestionId] ON [Answers] ([QuestionId]);
2025-05-03 19:00:05.923 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Choice_QuestionId] ON [Choice] ([QuestionId]);
2025-05-03 19:00:05.931 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_CategoryId] ON [Courses] ([CategoryId]);
2025-05-03 19:00:05.940 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_InstructorId] ON [Courses] ([InstructorId]);
2025-05-03 19:00:05.954 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_Title] ON [Courses] ([Title]);
2025-05-03 19:00:05.964 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_EmailConfirmationCodes_Email] ON [EmailConfirmationCodes] ([Email]);
2025-05-03 19:00:05.976 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Enrollments_CourseId] ON [Enrollments] ([CourseId]);
2025-05-03 19:00:05.985 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Enrollments_UserId] ON [Enrollments] ([UserId]);
2025-05-03 19:00:05.993 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonMaterials_LessonId] ON [LessonMaterials] ([LessonId]);
2025-05-03 19:00:06.005 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonProgresses_LessonId] ON [LessonProgresses] ([LessonId]);
2025-05-03 19:00:06.012 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonProgresses_UserGuid] ON [LessonProgresses] ([UserGuid]);
2025-05-03 19:00:06.027 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Lessons_CourseId_Order] ON [Lessons] ([CourseId], [Order]);
2025-05-03 19:00:06.034 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_CourseId] ON [Messages] ([CourseId]);
2025-05-03 19:00:06.058 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_ReplyToMessageId] ON [Messages] ([ReplyToMessageId]);
2025-05-03 19:00:06.064 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_SenderId] ON [Messages] ([SenderId]);
2025-05-03 19:00:06.073 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Notifications_UserId] ON [Notifications] ([UserId]);
2025-05-03 19:00:06.079 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PasswordResetCodes_Email] ON [PasswordResetCodes] ([Email]);
2025-05-03 19:00:06.087 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_CourseId] ON [Payments] ([CourseId]);
2025-05-03 19:00:06.093 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_UserId] ON [Payments] ([UserId]);
2025-05-03 19:00:06.099 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Profiles_UserId] ON [Profiles] ([UserId]);
2025-05-03 19:00:06.183 +03:00 [INF] Executed DbCommand (77ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Questions_QuizId] ON [Questions] ([QuizId]);
2025-05-03 19:00:06.356 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_QuizId_UserId_CompletedAt] ON [QuizResults] ([QuizId], [UserId], [CompletedAt]);
2025-05-03 19:00:06.363 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_UserGuid] ON [QuizResults] ([UserGuid]);
2025-05-03 19:00:06.376 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Quizzes_CourseId] ON [Quizzes] ([CourseId]);
2025-05-03 19:00:06.383 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Quizzes_LessonId] ON [Quizzes] ([LessonId]);
2025-05-03 19:00:06.396 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Quizzes_LessonId1] ON [Quizzes] ([LessonId1]) WHERE [LessonId1] IS NOT NULL;
2025-05-03 19:00:06.408 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_CourseId] ON [Reviews] ([CourseId]);
2025-05-03 19:00:06.416 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_UserId] ON [Reviews] ([UserId]);
2025-05-03 19:00:06.425 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_AnswerId] ON [UserAnswers] ([AnswerId]);
2025-05-03 19:00:06.431 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_ChoiceId] ON [UserAnswers] ([ChoiceId]);
2025-05-03 19:00:06.443 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_QuestionId] ON [UserAnswers] ([QuestionId]);
2025-05-03 19:00:06.449 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_QuizResultId] ON [UserAnswers] ([QuizResultId]);
2025-05-03 19:00:06.460 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_UserRefreshTokens_RefreshToken] ON [UserRefreshTokens] ([RefreshToken]);
2025-05-03 19:00:06.466 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserRefreshTokens_UserGuid] ON [UserRefreshTokens] ([UserGuid]);
2025-05-03 19:00:06.475 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_Email] ON [Users] ([Email]) WHERE [Email] IS NOT NULL;
2025-05-03 19:00:06.480 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_UserGuid] ON [Users] ([UserGuid]);
2025-05-03 19:00:06.507 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250503155949_InitialCreate', N'8.0.0');
2025-05-03 19:00:58.680 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 19:00:58.750 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 19:00:59.474 +03:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 19:00:59.525 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 19:00:59.536 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 19:00:59.540 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 19:00:59.603 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 19:00:59.657 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-05-03 19:01:00.094 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 19:01:01.516 +03:00 [INF] Executed DbCommand (123ms) [Parameters=[@p0='2025-05-03T16:01:00.4319868Z', @p1='admin@elearning.com' (Size = 450), @p2=' ' (Size = 4000), @p3='True', @p4='$2a$11$dbZnVA6B6nopylKIy3Ih1.YtfJGNV5AufFjHpCT4cP.qQXbWTXYAS' (Size = 4000), @p5='Admin' (Nullable = false) (Size = 4000), @p6=NULL (DbType = DateTime2), @p7='140398d0-9218-4a9e-85d8-f7740d5a69eb' (Nullable = false) (Size = 36), @p8='2025-05-03T16:01:00.6495592Z', @p9='instructor@elearning.com' (Size = 450), @p10=' ' (Size = 4000), @p11='True', @p12='$2a$11$5PTOQOQRuqOAcK/ESh9VKuvSPQvhMOV6hTtbvGI.gr1Z0sxCtH0la' (Size = 4000), @p13='Instructor' (Nullable = false) (Size = 4000), @p14=NULL (DbType = DateTime2), @p15='6b907a2a-210b-4e68-8f79-3960619457c1' (Nullable = false) (Size = 36), @p16='2025-05-03T16:01:00.8752157Z', @p17='student@elearning.com' (Size = 450), @p18=' ' (Size = 4000), @p19='True', @p20='$2a$11$3T6EYD814iW.oIgCs6RsPePZPU5XxQogWsoc/NbXzd3CfKdnZsTza' (Size = 4000), @p21='Student' (Nullable = false) (Size = 4000), @p22=NULL (DbType = DateTime2), @p23='71b567a7-76f2-490f-ad0f-6d7b1a760ed9' (Nullable = false) (Size = 36)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Users] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, 0),
(@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, 1),
(@p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, 2)) AS i ([CreatedAt], [Email], [FullName], [IsEmailConfirmed], [PasswordHash], [Role], [UpdatedAt], [UserGuid], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [Email], [FullName], [IsEmailConfirmed], [PasswordHash], [Role], [UpdatedAt], [UserGuid])
VALUES (i.[CreatedAt], i.[Email], i.[FullName], i.[IsEmailConfirmed], i.[PasswordHash], i.[Role], i.[UpdatedAt], i.[UserGuid])
OUTPUT INSERTED.[Id], i._Position;
2025-05-03 19:01:01.698 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Courses] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 19:01:01.807 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Role] = N'Instructor') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 19:01:01.873 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Role] = N'Instructor'
2025-05-03 19:01:02.162 +03:00 [INF] Executed DbCommand (29ms) [Parameters=[@p0='0', @p1='2025-05-03T16:01:01.9873781Z', @p2=NULL (Nullable = false) (Size = 4000), @p3='   ' (Size = 4000), @p4=NULL (Size = 4000), @p5='2', @p6='True' (Nullable = true), @p7=NULL (Nullable = false) (Size = 4000), @p8='0' (Precision = 18) (Scale = 2), @p9='  ' (Size = 450), @p10=NULL (DbType = DateTime2), @p11='0', @p12='2025-05-03T16:01:01.9874279Z', @p13=NULL (Nullable = false) (Size = 4000), @p14='      ASP.NET Core' (Size = 4000), @p15=NULL (Size = 4000), @p16='2', @p17='True' (Nullable = true), @p18=NULL (Nullable = false) (Size = 4000), @p19='100' (Precision = 18) (Scale = 2), @p20=' ASP.NET Core' (Size = 450), @p21=NULL (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Courses] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, 0),
(@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, 1)) AS i ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt])
VALUES (i.[CategoryId], i.[CreatedAt], i.[CreatedBy], i.[Description], i.[ImageUrl], i.[InstructorId], i.[IsActive], i.[Name], i.[Price], i.[Title], i.[UpdatedAt])
OUTPUT INSERTED.[Id], i._Position;
2025-05-03 19:01:02.221 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'e_learning.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edc16902-1028-4f71-bdc2-a465eaf53322
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edc16902-1028-4f71-bdc2-a465eaf53322
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-03 19:01:02.270 +03:00 [ERR] Database migration failed
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edc16902-1028-4f71-bdc2-a465eaf53322
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at SeedData.Initialize(IServiceProvider serviceProvider) in C:\Users\ta\OneDrive\Desktop\e_learning\Program.cs:line 357
   at Program.<Main>$(String[] args) in C:\Users\ta\OneDrive\Desktop\e_learning\Program.cs:line 221
2025-05-03 19:01:02.716 +03:00 [INF] Starting application...
2025-05-03 19:01:02.742 +03:00 [INF] User profile is available. Using 'C:\Users\ta\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-03 19:01:03.057 +03:00 [INF] Now listening on: https://localhost:7056
2025-05-03 19:01:03.058 +03:00 [INF] Now listening on: http://localhost:5000
2025-05-03 19:01:03.063 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-03 19:01:03.071 +03:00 [INF] Hosting environment: Development
2025-05-03 19:01:03.083 +03:00 [INF] Content root path: C:\Users\ta\OneDrive\Desktop\e_learning
2025-05-03 19:21:09.241 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/login - application/json 66
2025-05-03 19:21:09.324 +03:00 [INF] CORS policy execution failed.
2025-05-03 19:21:09.326 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 19:21:09.574 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 19:21:09.610 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(e_learning.DTOs.UserLoginDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 19:21:09.965 +03:00 [INF] Executed DbCommand (73ms) [Parameters=[@__dto_Email_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Email] = @__dto_Email_0
2025-05-03 19:21:09.984 +03:00 [WRN]    : abdomoka2018@gmail.com
2025-05-03 19:21:10.001 +03:00 [INF] Executing UnauthorizedObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse'.
2025-05-03 19:21:10.101 +03:00 [INF] Executed action e_learning.Controllers.AuthController.Login (e_learning) in 480.8441ms
2025-05-03 19:21:10.105 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 19:21:10.112 +03:00 [INF] HTTP POST /api/Auth/login responded 401 in 835.5148 ms
2025-05-03 19:21:10.154 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/login - 401 null application/json; charset=utf-8 917.2394ms
2025-05-03 19:21:15.645 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/login - application/json 66
2025-05-03 19:21:15.706 +03:00 [INF] CORS policy execution failed.
2025-05-03 19:21:15.708 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 19:21:15.716 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 19:21:15.718 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(e_learning.DTOs.UserLoginDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 19:21:15.763 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__dto_Email_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Email] = @__dto_Email_0
2025-05-03 19:21:15.773 +03:00 [WRN]    : abdomoka2018@gmail.com
2025-05-03 19:21:15.778 +03:00 [INF] Executing UnauthorizedObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse'.
2025-05-03 19:21:15.781 +03:00 [INF] Executed action e_learning.Controllers.AuthController.Login (e_learning) in 56.7676ms
2025-05-03 19:21:15.784 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 19:21:15.787 +03:00 [INF] HTTP POST /api/Auth/login responded 401 in 88.0516 ms
2025-05-03 19:21:15.806 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/login - 401 null application/json; charset=utf-8 161.2299ms
2025-05-03 19:21:16.766 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/login - application/json 66
2025-05-03 19:21:16.770 +03:00 [INF] CORS policy execution failed.
2025-05-03 19:21:16.773 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 19:21:16.778 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 19:21:16.779 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(e_learning.DTOs.UserLoginDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 19:21:16.823 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__dto_Email_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Email] = @__dto_Email_0
2025-05-03 19:21:16.870 +03:00 [WRN]    : abdomoka2018@gmail.com
2025-05-03 19:21:16.875 +03:00 [INF] Executing UnauthorizedObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse'.
2025-05-03 19:21:16.886 +03:00 [INF] Executed action e_learning.Controllers.AuthController.Login (e_learning) in 88.2005ms
2025-05-03 19:21:16.900 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 19:21:16.906 +03:00 [INF] HTTP POST /api/Auth/login responded 401 in 136.8943 ms
2025-05-03 19:21:16.934 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/login - 401 null application/json; charset=utf-8 168.1491ms
2025-05-03 19:21:17.747 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/login - application/json 66
2025-05-03 19:21:17.750 +03:00 [INF] CORS policy execution failed.
2025-05-03 19:21:17.751 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 19:21:17.754 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 19:21:17.755 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(e_learning.DTOs.UserLoginDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 19:21:17.814 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__dto_Email_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Email] = @__dto_Email_0
2025-05-03 19:21:17.819 +03:00 [WRN]    : abdomoka2018@gmail.com
2025-05-03 19:21:17.820 +03:00 [INF] Executing UnauthorizedObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse'.
2025-05-03 19:21:17.823 +03:00 [INF] Executed action e_learning.Controllers.AuthController.Login (e_learning) in 62.7103ms
2025-05-03 19:21:17.828 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 19:21:17.829 +03:00 [INF] HTTP POST /api/Auth/login responded 401 in 78.8643 ms
2025-05-03 19:21:17.834 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/login - 401 null application/json; charset=utf-8 86.3643ms
2025-05-03 19:21:20.432 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/index.html - null null
2025-05-03 19:21:20.537 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/index.html - 200 null text/html;charset=utf-8 105.4467ms
2025-05-03 19:21:20.578 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger-ui/custom.css - null null
2025-05-03 19:21:20.594 +03:00 [INF] HTTP GET /swagger-ui/custom.css responded 404 in 6.2223 ms
2025-05-03 19:21:20.599 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger-ui/custom.css - 404 0 null 21.1565ms
2025-05-03 19:21:20.608 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7056/swagger-ui/custom.css, Response status code: 404
2025-05-03 19:21:20.976 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-03 19:21:21.392 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 415.4677ms
2025-05-03 19:21:25.773 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/login - application/json 57
2025-05-03 19:21:25.798 +03:00 [INF] CORS policy execution failed.
2025-05-03 19:21:25.799 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 19:21:25.800 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 19:21:25.801 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(e_learning.DTOs.UserLoginDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 19:21:25.829 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__dto_Email_0='user@example.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Email] = @__dto_Email_0
2025-05-03 19:21:25.837 +03:00 [WRN]    : user@example.com
2025-05-03 19:21:25.841 +03:00 [INF] Executing UnauthorizedObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse'.
2025-05-03 19:21:25.847 +03:00 [INF] Executed action e_learning.Controllers.AuthController.Login (e_learning) in 44.0367ms
2025-05-03 19:21:25.850 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 19:21:25.852 +03:00 [INF] HTTP POST /api/Auth/login responded 401 in 53.9323 ms
2025-05-03 19:21:25.872 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/login - 401 null application/json; charset=utf-8 98.7346ms
2025-05-03 19:22:53.966 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/register - application/json 116
2025-05-03 19:22:53.970 +03:00 [INF] CORS policy execution failed.
2025-05-03 19:22:54.011 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 19:22:54.024 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.Register (e_learning)'
2025-05-03 19:22:54.062 +03:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(e_learning.DTOs.UserRegisterDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 19:22:54.161 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__dto_Email_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__dto_Email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 19:22:54.471 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[@p0='2025-05-03T16:22:54.4159473Z', @p1='abdomoka2018@gmail.com' (Size = 450), @p2='Abdelrahman' (Size = 4000), @p3='False', @p4='$2a$11$7wYfMrj8yHTD2YS2CH1Hd.l/UT71RzXdKMg.5cszucQ0bOeGPjqbK' (Size = 4000), @p5='Student' (Nullable = false) (Size = 4000), @p6=NULL (DbType = DateTime2), @p7='5ad68e78-bf6d-4124-933b-850e01a7cd57' (Nullable = false) (Size = 36)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedAt], [Email], [FullName], [IsEmailConfirmed], [PasswordHash], [Role], [UpdatedAt], [UserGuid])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-05-03 19:22:54.593 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='389060' (Nullable = false) (Size = 6), @p1='2025-05-03T16:22:54.5299298Z', @p2='abdomoka2018@gmail.com' (Nullable = false) (Size = 450), @p3='2025-05-03T16:32:54.5300238Z'], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [EmailConfirmationCodes] ([Code], [CreatedAt], [Email], [ExpiryDate])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-05-03 19:22:58.373 +03:00 [INF]     abdomoka2018@gmail.com 
2025-05-03 19:22:58.378 +03:00 [INF]     - ID: 4
2025-05-03 19:22:58.389 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[e_learning.DTOs.Responses.RegisterResponse, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-03 19:22:58.417 +03:00 [INF] Executed action e_learning.Controllers.AuthController.Register (e_learning) in 4350.9123ms
2025-05-03 19:22:58.423 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.Register (e_learning)'
2025-05-03 19:22:58.425 +03:00 [INF] HTTP POST /api/Auth/register responded 200 in 4455.8080 ms
2025-05-03 19:22:58.448 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/register - 200 null application/json; charset=utf-8 4482.0975ms
2025-05-03 19:23:57.232 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/confirm-email - application/json 59
2025-05-03 19:23:57.235 +03:00 [INF] CORS policy execution failed.
2025-05-03 19:23:57.236 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 19:23:57.239 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.ConfirmEmail (e_learning)'
2025-05-03 19:23:57.249 +03:00 [INF] Route matched with {action = "ConfirmEmail", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ConfirmEmail(e_learning.DTOs.ConfirmEmailDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 19:23:57.451 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[@__ToLower_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Code], [e].[CreatedAt], [e].[Email], [e].[ExpiryDate]
FROM [EmailConfirmationCodes] AS [e]
WHERE [e].[Email] = @__ToLower_0 AND [e].[ExpiryDate] > GETUTCDATE()
ORDER BY [e].[ExpiryDate] DESC
2025-05-03 19:23:57.505 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__dto_Email_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Email] = @__dto_Email_0
2025-05-03 19:23:57.556 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[@p1='4', @p0='True'], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [IsEmailConfirmed] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2025-05-03 19:23:57.608 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__ToLower_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[Id], [e].[Code], [e].[CreatedAt], [e].[Email], [e].[ExpiryDate]
FROM [EmailConfirmationCodes] AS [e]
WHERE [e].[Email] = @__ToLower_0
2025-05-03 19:23:57.638 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@p0='1'], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [EmailConfirmationCodes]
OUTPUT 1
WHERE [Id] = @p0;
2025-05-03 19:23:57.653 +03:00 [INF]     : abdomoka2018@gmail.com
2025-05-03 19:23:57.654 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse'.
2025-05-03 19:23:57.657 +03:00 [INF] Executed action e_learning.Controllers.AuthController.ConfirmEmail (e_learning) in 383.9687ms
2025-05-03 19:23:57.659 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.ConfirmEmail (e_learning)'
2025-05-03 19:23:57.660 +03:00 [INF] HTTP POST /api/Auth/confirm-email responded 200 in 424.8210 ms
2025-05-03 19:23:57.666 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/confirm-email - 200 null application/json; charset=utf-8 434.3588ms
2025-05-03 19:24:10.030 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/login - application/json 66
2025-05-03 19:24:10.051 +03:00 [INF] CORS policy execution failed.
2025-05-03 19:24:10.051 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 19:24:10.054 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 19:24:10.055 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(e_learning.DTOs.UserLoginDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 19:24:10.104 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[@__dto_Email_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Email] = @__dto_Email_0
2025-05-03 19:24:10.477 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='2025-05-03T16:24:10.4367717Z', @p1='0', @p2='2025-05-10T16:24:10.4367026Z', @p3='qN1sYTywEt2AfJYQNTcgE9c2USZigm8t2SgwF/SpzNsXemas5I6opfHJ2cm5UUu82MpD+nCY4DPNEf/8he4f5Q==' (Nullable = false) (Size = 450), @p4='5ad68e78-bf6d-4124-933b-850e01a7cd57' (Nullable = false) (Size = 36)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserRefreshTokens] ([CreatedAt], [ExpiresIn], [ExpiryDate], [RefreshToken], [UserGuid])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-05-03 19:24:10.497 +03:00 [INF]     : abdomoka2018@gmail.com
2025-05-03 19:24:10.500 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[e_learning.DTOs.Responses.LoginResponse, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-03 19:24:10.522 +03:00 [INF] Executed action e_learning.Controllers.AuthController.Login (e_learning) in 465.9447ms
2025-05-03 19:24:10.523 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 19:24:10.525 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 474.7435 ms
2025-05-03 19:24:10.530 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/login - 200 null application/json; charset=utf-8 499.495ms
2025-05-03 19:25:57.633 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Course - application/json 123
2025-05-03 19:25:57.642 +03:00 [INF] CORS policy execution failed.
2025-05-03 19:25:57.698 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 19:25:57.801 +03:00 [INF] Executing endpoint 'e_learning.Controllers.CourseController.AddCourse (e_learning)'
2025-05-03 19:25:57.810 +03:00 [INF] Route matched with {action = "AddCourse", controller = "Course"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddCourse(e_learning.DTOs.Courses.CourseCreateDto) on controller e_learning.Controllers.CourseController (e_learning).
2025-05-03 19:25:57.893 +03:00 [INF] Executed DbCommand (37ms) [Parameters=[@p0='1', @p1='2025-05-03T16:25:57.8388693Z', @p2=NULL (Nullable = false) (Size = 4000), @p3='string' (Size = 4000), @p4=NULL (Size = 4000), @p5='1', @p6='True' (Nullable = true), @p7='string' (Nullable = false) (Size = 4000), @p8='0' (Precision = 18) (Scale = 2), @p9=NULL (Size = 450), @p10=NULL (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Courses] ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-05-03 19:25:57.927 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'e_learning.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'CreatedBy', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2322ee2a-6949-417b-8949-6ea5efc9f173
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'CreatedBy', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2322ee2a-6949-417b-8949-6ea5efc9f173
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-03 19:25:57.971 +03:00 [INF] Executed action e_learning.Controllers.CourseController.AddCourse (e_learning) in 156.4051ms
2025-05-03 19:25:57.978 +03:00 [INF] Executed endpoint 'e_learning.Controllers.CourseController.AddCourse (e_learning)'
2025-05-03 19:25:57.982 +03:00 [ERR] HTTP POST /api/Course responded 500 in 340.8860 ms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'CreatedBy', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2322ee2a-6949-417b-8949-6ea5efc9f173
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at e_learning.Controllers.CourseController.AddCourse(CourseCreateDto dto) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\CourseController.cs:line 46
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-03 19:25:58.030 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'CreatedBy', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2322ee2a-6949-417b-8949-6ea5efc9f173
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at e_learning.Controllers.CourseController.AddCourse(CourseCreateDto dto) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\CourseController.cs:line 46
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-03 19:25:58.090 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Course - 500 null text/plain; charset=utf-8 456.689ms
2025-05-03 19:26:18.125 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/courses/1/Lessons - application/json 208
2025-05-03 19:26:18.186 +03:00 [INF] CORS policy execution failed.
2025-05-03 19:26:18.187 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 19:26:18.208 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Instructor|Admin)
2025-05-03 19:26:18.213 +03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-05-03 19:26:18.215 +03:00 [INF] HTTP POST /api/courses/1/Lessons responded 403 in 35.8151 ms
2025-05-03 19:26:18.219 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/courses/1/Lessons - 403 0 null 94.5927ms
2025-05-03 19:26:32.515 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Messages/send/1 - multipart/form-data; boundary=----WebKitFormBoundaryAuBADkqLAJMsUJAn 336
2025-05-03 19:26:32.542 +03:00 [INF] CORS policy execution failed.
2025-05-03 19:26:32.544 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 19:26:32.552 +03:00 [INF] Executing endpoint 'e_learning.Controllers.MessagesController.SendMessage (e_learning)'
2025-05-03 19:26:32.573 +03:00 [INF] Route matched with {action = "SendMessage", controller = "Messages"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendMessage(Int32, e_learning.DTOs.MessageCreateDto) on controller e_learning.Controllers.MessagesController (e_learning).
2025-05-03 19:26:32.921 +03:00 [INF] Executed DbCommand (57ms) [Parameters=[@__courseId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[CategoryId], [t].[CreatedAt], [t].[CreatedBy], [t].[Description], [t].[ImageUrl], [t].[InstructorId], [t].[IsActive], [t].[Name], [t].[Price], [t].[Title], [t].[UpdatedAt], [e].[Id], [e].[CourseId], [e].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CategoryId], [c].[CreatedAt], [c].[CreatedBy], [c].[Description], [c].[ImageUrl], [c].[InstructorId], [c].[IsActive], [c].[Name], [c].[Price], [c].[Title], [c].[UpdatedAt]
    FROM [Courses] AS [c]
    WHERE [c].[Id] = @__courseId_0
) AS [t]
LEFT JOIN [Enrollments] AS [e] ON [t].[Id] = [e].[CourseId]
ORDER BY [t].[Id]
2025-05-03 19:26:32.947 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'System.String'.
2025-05-03 19:26:32.960 +03:00 [INF] Executed action e_learning.Controllers.MessagesController.SendMessage (e_learning) in 382.4006ms
2025-05-03 19:26:32.963 +03:00 [INF] Executed endpoint 'e_learning.Controllers.MessagesController.SendMessage (e_learning)'
2025-05-03 19:26:32.964 +03:00 [INF] HTTP POST /api/Messages/send/1 responded 404 in 423.8824 ms
2025-05-03 19:26:32.973 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Messages/send/1 - 404 null text/plain; charset=utf-8 458.3981ms
2025-05-03 19:27:03.299 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/login - application/json 73
2025-05-03 19:27:03.301 +03:00 [INF] CORS policy execution failed.
2025-05-03 19:27:03.302 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 19:27:03.305 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 19:27:03.308 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(e_learning.DTOs.UserLoginDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 19:27:03.345 +03:00 [INF] Executed DbCommand (23ms) [Parameters=[@__dto_Email_0='instructor@elearning.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Email] = @__dto_Email_0
2025-05-03 19:27:03.678 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='2025-05-03T16:27:03.6590826Z', @p1='0', @p2='2025-05-10T16:27:03.6590699Z', @p3='THr3xvxIK8ON+glI8Dqcb9jOxzNPqnvjsr6Y8UMtCcQiudGNQ/ixma8+9iY7Kr/e1kEize6EE/B2pOC6VpKIaQ==' (Nullable = false) (Size = 450), @p4='6b907a2a-210b-4e68-8f79-3960619457c1' (Nullable = false) (Size = 36)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserRefreshTokens] ([CreatedAt], [ExpiresIn], [ExpiryDate], [RefreshToken], [UserGuid])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-05-03 19:27:03.694 +03:00 [INF]     : instructor@elearning.com
2025-05-03 19:27:03.703 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[e_learning.DTOs.Responses.LoginResponse, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-03 19:27:03.706 +03:00 [INF] Executed action e_learning.Controllers.AuthController.Login (e_learning) in 397.0085ms
2025-05-03 19:27:03.710 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 19:27:03.718 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 416.6425 ms
2025-05-03 19:27:03.731 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/login - 200 null application/json; charset=utf-8 432.2214ms
2025-05-03 19:27:36.389 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Course - application/json 123
2025-05-03 19:27:36.446 +03:00 [INF] CORS policy execution failed.
2025-05-03 19:27:36.481 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 19:27:36.506 +03:00 [INF] Executing endpoint 'e_learning.Controllers.CourseController.AddCourse (e_learning)'
2025-05-03 19:27:36.533 +03:00 [INF] Route matched with {action = "AddCourse", controller = "Course"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddCourse(e_learning.DTOs.Courses.CourseCreateDto) on controller e_learning.Controllers.CourseController (e_learning).
2025-05-03 19:27:36.582 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='1', @p1='2025-05-03T16:27:36.5407740Z', @p2=NULL (Nullable = false) (Size = 4000), @p3='string' (Size = 4000), @p4=NULL (Size = 4000), @p5='1', @p6='True' (Nullable = true), @p7='string' (Nullable = false) (Size = 4000), @p8='0' (Precision = 18) (Scale = 2), @p9=NULL (Size = 450), @p10=NULL (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Courses] ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-05-03 19:27:36.592 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'e_learning.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'CreatedBy', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2322ee2a-6949-417b-8949-6ea5efc9f173
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'CreatedBy', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2322ee2a-6949-417b-8949-6ea5efc9f173
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-03 19:27:36.670 +03:00 [INF] Executed action e_learning.Controllers.CourseController.AddCourse (e_learning) in 130.7146ms
2025-05-03 19:27:36.674 +03:00 [INF] Executed endpoint 'e_learning.Controllers.CourseController.AddCourse (e_learning)'
2025-05-03 19:27:36.677 +03:00 [ERR] HTTP POST /api/Course responded 500 in 231.3097 ms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'CreatedBy', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2322ee2a-6949-417b-8949-6ea5efc9f173
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at e_learning.Controllers.CourseController.AddCourse(CourseCreateDto dto) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\CourseController.cs:line 46
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-03 19:27:36.808 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'CreatedBy', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2322ee2a-6949-417b-8949-6ea5efc9f173
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at e_learning.Controllers.CourseController.AddCourse(CourseCreateDto dto) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\CourseController.cs:line 46
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-03 19:27:36.890 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Course - 500 null text/plain; charset=utf-8 501.2846ms
2025-05-03 19:27:40.170 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Course - application/json 123
2025-05-03 19:27:40.172 +03:00 [INF] CORS policy execution failed.
2025-05-03 19:27:40.173 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 19:27:40.176 +03:00 [INF] Executing endpoint 'e_learning.Controllers.CourseController.AddCourse (e_learning)'
2025-05-03 19:27:40.178 +03:00 [INF] Route matched with {action = "AddCourse", controller = "Course"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddCourse(e_learning.DTOs.Courses.CourseCreateDto) on controller e_learning.Controllers.CourseController (e_learning).
2025-05-03 19:27:40.315 +03:00 [INF] Executed DbCommand (50ms) [Parameters=[@p0='1', @p1='2025-05-03T16:27:40.1825878Z', @p2=NULL (Nullable = false) (Size = 4000), @p3='string' (Size = 4000), @p4=NULL (Size = 4000), @p5='1', @p6='True' (Nullable = true), @p7='string' (Nullable = false) (Size = 4000), @p8='0' (Precision = 18) (Scale = 2), @p9=NULL (Size = 450), @p10=NULL (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Courses] ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-05-03 19:27:40.366 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'e_learning.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'CreatedBy', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2322ee2a-6949-417b-8949-6ea5efc9f173
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'CreatedBy', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2322ee2a-6949-417b-8949-6ea5efc9f173
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-03 19:27:40.454 +03:00 [INF] Executed action e_learning.Controllers.CourseController.AddCourse (e_learning) in 274.2074ms
2025-05-03 19:27:40.456 +03:00 [INF] Executed endpoint 'e_learning.Controllers.CourseController.AddCourse (e_learning)'
2025-05-03 19:27:40.458 +03:00 [ERR] HTTP POST /api/Course responded 500 in 286.2093 ms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'CreatedBy', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2322ee2a-6949-417b-8949-6ea5efc9f173
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at e_learning.Controllers.CourseController.AddCourse(CourseCreateDto dto) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\CourseController.cs:line 46
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-03 19:27:40.554 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'CreatedBy', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2322ee2a-6949-417b-8949-6ea5efc9f173
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at e_learning.Controllers.CourseController.AddCourse(CourseCreateDto dto) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\CourseController.cs:line 46
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-03 19:27:40.633 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Course - 500 null text/plain; charset=utf-8 463.2651ms
2025-05-03 19:35:49.191 +03:00 [INF] Application is shutting down...
2025-05-03 19:41:24.591 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 19:41:24.728 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 19:41:25.683 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 19:41:56.462 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 19:41:56.561 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 19:41:57.411 +03:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 19:41:57.481 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 19:41:57.492 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 19:41:57.504 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 19:41:57.584 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 19:41:57.611 +03:00 [INF] Applying migration '20250503164127_Updates'.
2025-05-03 19:41:58.446 +03:00 [INF] Executed DbCommand (672ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Courses]') AND [c].[name] = N'CreatedBy');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [Courses] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [Courses] ALTER COLUMN [CreatedBy] uniqueidentifier NOT NULL;
2025-05-03 19:41:58.488 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250503164127_Updates', N'8.0.0');
2025-05-03 19:42:13.929 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 19:42:14.036 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 19:42:14.906 +03:00 [INF] Executed DbCommand (48ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 19:42:14.994 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 19:42:15.006 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 19:42:15.013 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 19:42:15.046 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 19:42:15.084 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-05-03 19:42:15.559 +03:00 [INF] Executed DbCommand (30ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 19:42:15.690 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Courses] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 19:42:15.798 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Role] = N'Instructor') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 19:42:15.911 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Role] = N'Instructor'
2025-05-03 19:42:16.627 +03:00 [INF] Executed DbCommand (101ms) [Parameters=[@p0='0', @p1='2025-05-03T16:42:16.0567336Z', @p2='00000000-0000-0000-0000-000000000000', @p3='   ' (Size = 4000), @p4=NULL (Size = 4000), @p5='2', @p6='True' (Nullable = true), @p7=NULL (Nullable = false) (Size = 4000), @p8='0' (Precision = 18) (Scale = 2), @p9='  ' (Size = 450), @p10=NULL (DbType = DateTime2), @p11='0', @p12='2025-05-03T16:42:16.0567902Z', @p13='00000000-0000-0000-0000-000000000000', @p14='      ASP.NET Core' (Size = 4000), @p15=NULL (Size = 4000), @p16='2', @p17='True' (Nullable = true), @p18=NULL (Nullable = false) (Size = 4000), @p19='100' (Precision = 18) (Scale = 2), @p20=' ASP.NET Core' (Size = 450), @p21=NULL (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Courses] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, 0),
(@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, 1)) AS i ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt])
VALUES (i.[CategoryId], i.[CreatedAt], i.[CreatedBy], i.[Description], i.[ImageUrl], i.[InstructorId], i.[IsActive], i.[Name], i.[Price], i.[Title], i.[UpdatedAt])
OUTPUT INSERTED.[Id], i._Position;
2025-05-03 19:42:16.697 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'e_learning.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:dc9ac901-dbca-45a7-879a-c0ca946531c9
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:dc9ac901-dbca-45a7-879a-c0ca946531c9
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-03 19:42:16.731 +03:00 [ERR] Database migration failed
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:dc9ac901-dbca-45a7-879a-c0ca946531c9
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at SeedData.Initialize(IServiceProvider serviceProvider) in C:\Users\ta\OneDrive\Desktop\e_learning\Program.cs:line 357
   at Program.<Main>$(String[] args) in C:\Users\ta\OneDrive\Desktop\e_learning\Program.cs:line 221
2025-05-03 19:42:17.071 +03:00 [INF] Starting application...
2025-05-03 19:42:17.093 +03:00 [INF] User profile is available. Using 'C:\Users\ta\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-03 19:42:17.354 +03:00 [INF] Now listening on: https://localhost:7056
2025-05-03 19:42:17.355 +03:00 [INF] Now listening on: http://localhost:5000
2025-05-03 19:42:17.361 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-03 19:42:17.363 +03:00 [INF] Hosting environment: Development
2025-05-03 19:42:17.365 +03:00 [INF] Content root path: C:\Users\ta\OneDrive\Desktop\e_learning
2025-05-03 19:42:44.018 +03:00 [INF] Application is shutting down...
2025-05-03 19:43:13.622 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 19:43:13.750 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 19:43:14.651 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 19:43:14.883 +03:00 [INF] Executed DbCommand (156ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [E_LearningDB] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2025-05-03 19:43:15.165 +03:00 [INF] Executed DbCommand (277ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [E_LearningDB];
2025-05-03 19:47:05.939 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 19:47:06.083 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 19:47:21.422 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 19:47:21.523 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 19:47:22.373 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 19:47:22.990 +03:00 [INF] Executed DbCommand (519ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [E_LearningDB];
2025-05-03 19:47:23.194 +03:00 [INF] Executed DbCommand (196ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [E_LearningDB] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-05-03 19:47:23.234 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 19:47:23.352 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-05-03 19:47:23.365 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 19:47:23.401 +03:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 19:47:23.448 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 19:47:23.471 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-05-03 19:47:38.056 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 19:47:38.149 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 19:47:38.740 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 19:48:00.381 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 19:48:00.470 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 19:48:01.324 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 19:48:01.379 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 19:48:01.392 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 19:48:01.400 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 19:48:01.439 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 19:48:01.474 +03:00 [INF] Applying migration '20250503164739_InitialCreate'.
2025-05-03 19:48:01.711 +03:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-05-03 19:48:01.758 +03:00 [INF] Executed DbCommand (38ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [EmailConfirmationCodes] (
    [Id] int NOT NULL IDENTITY,
    [Email] nvarchar(450) NOT NULL,
    [Code] nvarchar(6) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_EmailConfirmationCodes] PRIMARY KEY ([Id])
);
2025-05-03 19:48:01.790 +03:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PasswordResetCodes] (
    [Id] int NOT NULL IDENTITY,
    [Email] nvarchar(450) NOT NULL,
    [Code] nvarchar(6) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_PasswordResetCodes] PRIMARY KEY ([Id])
);
2025-05-03 19:48:01.806 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] int NOT NULL IDENTITY,
    [UserGuid] nvarchar(36) NOT NULL,
    [FullName] nvarchar(max) NULL,
    [Email] nvarchar(450) NULL,
    [PasswordHash] nvarchar(max) NULL,
    [Role] nvarchar(max) NOT NULL,
    [IsEmailConfirmed] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id]),
    CONSTRAINT [AK_Users_UserGuid] UNIQUE ([UserGuid])
);
2025-05-03 19:48:01.821 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Courses] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    [Title] nvarchar(450) NULL,
    [Description] nvarchar(max) NULL,
    [Price] decimal(18,2) NOT NULL,
    [ImageUrl] nvarchar(max) NULL,
    [IsActive] bit NULL,
    [CategoryId] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [UpdatedAt] datetime2 NULL,
    [CreatedBy] uniqueidentifier NOT NULL,
    [InstructorId] int NOT NULL,
    CONSTRAINT [PK_Courses] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Courses_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Courses_Users_InstructorId] FOREIGN KEY ([InstructorId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 19:48:01.846 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Notifications] (
    [Id] uniqueidentifier NOT NULL,
    [Title] nvarchar(100) NOT NULL,
    [Message] nvarchar(max) NOT NULL,
    [UserId] int NOT NULL,
    [SenderId] nvarchar(max) NULL,
    [IsRead] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NULL,
    [NotificationType] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Notifications] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Notifications_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:48:01.861 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Profiles] (
    [Id] int NOT NULL IDENTITY,
    [Bio] nvarchar(max) NULL,
    [ProfilePicture] nvarchar(max) NULL,
    [Address] nvarchar(max) NULL,
    [Phone] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_Profiles] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Profiles_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:48:01.876 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserRefreshTokens] (
    [Id] int NOT NULL IDENTITY,
    [UserGuid] nvarchar(36) NOT NULL,
    [RefreshToken] nvarchar(450) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [ExpiresIn] int NOT NULL,
    CONSTRAINT [PK_UserRefreshTokens] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_UserRefreshTokens_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE CASCADE
);
2025-05-03 19:48:01.892 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Enrollments] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [CourseId] int NOT NULL,
    CONSTRAINT [PK_Enrollments] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Enrollments_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Enrollments_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 19:48:02.027 +03:00 [INF] Executed DbCommand (131ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Lessons] (
    [Id] int NOT NULL IDENTITY,
    [Title] nvarchar(200) NOT NULL,
    [Description] nvarchar(1000) NOT NULL,
    [Type] nvarchar(20) NOT NULL,
    [Content] nvarchar(max) NOT NULL,
    [VideoUrl] nvarchar(max) NOT NULL,
    [PdfUrl] nvarchar(max) NOT NULL,
    [Duration] int NOT NULL,
    [IsFree] bit NOT NULL,
    [IsSequential] bit NOT NULL,
    [Order] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [UpdatedAt] datetime2 NULL,
    [CreatedBy] nvarchar(max) NOT NULL,
    [CourseId] int NOT NULL,
    CONSTRAINT [PK_Lessons] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Lessons_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:48:02.077 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Messages] (
    [Id] int NOT NULL IDENTITY,
    [SenderId] int NOT NULL,
    [CourseId] int NOT NULL,
    [Text] nvarchar(max) NULL,
    [AttachmentUrl] nvarchar(max) NULL,
    [SentAt] datetime2 NOT NULL,
    [ReplyToMessageId] int NULL,
    [IsSeen] bit NOT NULL,
    CONSTRAINT [PK_Messages] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Messages_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Messages_Messages_ReplyToMessageId] FOREIGN KEY ([ReplyToMessageId]) REFERENCES [Messages] ([Id]),
    CONSTRAINT [FK_Messages_Users_SenderId] FOREIGN KEY ([SenderId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:48:02.097 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Payments] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [CourseId] int NOT NULL,
    [Amount] decimal(18,2) NOT NULL,
    [PaymentMethod] nvarchar(max) NULL,
    [IsSuccessful] bit NOT NULL,
    [PaidAt] datetime2 NOT NULL,
    [TransactionId] nvarchar(max) NULL,
    CONSTRAINT [PK_Payments] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Payments_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Payments_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:48:02.111 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Reviews] (
    [Id] int NOT NULL IDENTITY,
    [CourseId] int NOT NULL,
    [UserId] int NOT NULL,
    [Rating] int NOT NULL,
    [Comment] nvarchar(max) NULL,
    CONSTRAINT [PK_Reviews] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Reviews_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Reviews_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:48:02.128 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [LessonMaterials] (
    [Id] int NOT NULL IDENTITY,
    [FileName] nvarchar(max) NOT NULL,
    [FileUrl] nvarchar(max) NOT NULL,
    [Description] nvarchar(max) NOT NULL,
    [FileSize] bigint NOT NULL,
    [UploadedAt] datetime2 NOT NULL,
    [UploadedById] nvarchar(max) NOT NULL,
    [LessonId] int NOT NULL,
    CONSTRAINT [PK_LessonMaterials] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_LessonMaterials_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:48:02.150 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [LessonProgresses] (
    [Id] int NOT NULL IDENTITY,
    [UserGuid] nvarchar(36) NOT NULL,
    [IsCompleted] bit NOT NULL DEFAULT CAST(0 AS bit),
    [ProgressPercentage] int NOT NULL DEFAULT 0,
    [StartedAt] datetime2 NULL,
    [CompletedAt] datetime2 NULL,
    [TimeSpent] time NOT NULL,
    [LessonId] int NOT NULL,
    [UserId] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_LessonProgresses] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_LessonProgresses_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_LessonProgresses_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE CASCADE
);
2025-05-03 19:48:02.162 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Quizzes] (
    [Id] int NOT NULL IDENTITY,
    [Title] nvarchar(max) NOT NULL,
    [Description] nvarchar(max) NOT NULL,
    [PassingScore] int NOT NULL DEFAULT 70,
    [IsMandatory] bit NOT NULL,
    [MaxAttempts] int NOT NULL,
    [TimeLimitMinutes] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [CreatedBy] nvarchar(max) NOT NULL,
    [Status] int NOT NULL,
    [LessonId] int NOT NULL,
    [CourseId] int NULL,
    [LessonId1] int NULL,
    CONSTRAINT [PK_Quizzes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Quizzes_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]),
    CONSTRAINT [FK_Quizzes_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Quizzes_Lessons_LessonId1] FOREIGN KEY ([LessonId1]) REFERENCES [Lessons] ([Id])
);
2025-05-03 19:48:02.174 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Questions] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [Type] int NOT NULL,
    [Points] int NOT NULL,
    [QuizId] int NOT NULL,
    CONSTRAINT [PK_Questions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Questions_Quizzes_QuizId] FOREIGN KEY ([QuizId]) REFERENCES [Quizzes] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:48:02.184 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [QuizResults] (
    [Id] int NOT NULL IDENTITY,
    [UserGuid] nvarchar(36) NOT NULL,
    [Score] decimal(5,2) NOT NULL,
    [IsPassed] bit NOT NULL,
    [StartedAt] datetime2 NOT NULL,
    [CompletedAt] datetime2 NULL,
    [Status] int NOT NULL,
    [QuizId] int NOT NULL,
    [UserId] nvarchar(450) NOT NULL,
    CONSTRAINT [PK_QuizResults] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_QuizResults_Quizzes_QuizId] FOREIGN KEY ([QuizId]) REFERENCES [Quizzes] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_QuizResults_Users_UserGuid] FOREIGN KEY ([UserGuid]) REFERENCES [Users] ([UserGuid]) ON DELETE NO ACTION
);
2025-05-03 19:48:02.195 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Answers] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL DEFAULT CAST(0 AS bit),
    [QuestionId] int NOT NULL,
    CONSTRAINT [PK_Answers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Answers_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:48:02.209 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Choice] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL,
    [QuestionId] int NOT NULL,
    CONSTRAINT [PK_Choice] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Choice_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:48:02.225 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserAnswers] (
    [Id] int NOT NULL IDENTITY,
    [AnswerText] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL,
    [ChoiceId] int NULL,
    [QuestionId] int NOT NULL,
    [QuizResultId] int NOT NULL,
    [AnswerId] int NOT NULL,
    CONSTRAINT [PK_UserAnswers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_UserAnswers_Answers_AnswerId] FOREIGN KEY ([AnswerId]) REFERENCES [Answers] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_UserAnswers_Choice_ChoiceId] FOREIGN KEY ([ChoiceId]) REFERENCES [Choice] ([Id]),
    CONSTRAINT [FK_UserAnswers_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_UserAnswers_QuizResults_QuizResultId] FOREIGN KEY ([QuizResultId]) REFERENCES [QuizResults] ([Id]) ON DELETE CASCADE
);
2025-05-03 19:48:02.281 +03:00 [INF] Executed DbCommand (49ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Answers_QuestionId] ON [Answers] ([QuestionId]);
2025-05-03 19:48:02.291 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Choice_QuestionId] ON [Choice] ([QuestionId]);
2025-05-03 19:48:02.359 +03:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_CategoryId] ON [Courses] ([CategoryId]);
2025-05-03 19:48:02.369 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_InstructorId] ON [Courses] ([InstructorId]);
2025-05-03 19:48:02.394 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_Title] ON [Courses] ([Title]);
2025-05-03 19:48:02.401 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_EmailConfirmationCodes_Email] ON [EmailConfirmationCodes] ([Email]);
2025-05-03 19:48:02.410 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Enrollments_CourseId] ON [Enrollments] ([CourseId]);
2025-05-03 19:48:02.416 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Enrollments_UserId] ON [Enrollments] ([UserId]);
2025-05-03 19:48:02.424 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonMaterials_LessonId] ON [LessonMaterials] ([LessonId]);
2025-05-03 19:48:02.432 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonProgresses_LessonId] ON [LessonProgresses] ([LessonId]);
2025-05-03 19:48:02.440 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonProgresses_UserGuid] ON [LessonProgresses] ([UserGuid]);
2025-05-03 19:48:02.446 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Lessons_CourseId_Order] ON [Lessons] ([CourseId], [Order]);
2025-05-03 19:48:02.452 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_CourseId] ON [Messages] ([CourseId]);
2025-05-03 19:48:02.460 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_ReplyToMessageId] ON [Messages] ([ReplyToMessageId]);
2025-05-03 19:48:02.470 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_SenderId] ON [Messages] ([SenderId]);
2025-05-03 19:48:02.478 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Notifications_UserId] ON [Notifications] ([UserId]);
2025-05-03 19:48:02.492 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PasswordResetCodes_Email] ON [PasswordResetCodes] ([Email]);
2025-05-03 19:48:02.513 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_CourseId] ON [Payments] ([CourseId]);
2025-05-03 19:48:02.526 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_UserId] ON [Payments] ([UserId]);
2025-05-03 19:48:02.542 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Profiles_UserId] ON [Profiles] ([UserId]);
2025-05-03 19:48:02.563 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Questions_QuizId] ON [Questions] ([QuizId]);
2025-05-03 19:48:02.605 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_QuizId_UserId_CompletedAt] ON [QuizResults] ([QuizId], [UserId], [CompletedAt]);
2025-05-03 19:48:02.628 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_UserGuid] ON [QuizResults] ([UserGuid]);
2025-05-03 19:48:02.650 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Quizzes_CourseId] ON [Quizzes] ([CourseId]);
2025-05-03 19:48:02.661 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Quizzes_LessonId] ON [Quizzes] ([LessonId]);
2025-05-03 19:48:02.679 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Quizzes_LessonId1] ON [Quizzes] ([LessonId1]) WHERE [LessonId1] IS NOT NULL;
2025-05-03 19:48:02.696 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_CourseId] ON [Reviews] ([CourseId]);
2025-05-03 19:48:02.704 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_UserId] ON [Reviews] ([UserId]);
2025-05-03 19:48:02.727 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_AnswerId] ON [UserAnswers] ([AnswerId]);
2025-05-03 19:48:02.733 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_ChoiceId] ON [UserAnswers] ([ChoiceId]);
2025-05-03 19:48:02.744 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_QuestionId] ON [UserAnswers] ([QuestionId]);
2025-05-03 19:48:02.763 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_QuizResultId] ON [UserAnswers] ([QuizResultId]);
2025-05-03 19:48:02.791 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_UserRefreshTokens_RefreshToken] ON [UserRefreshTokens] ([RefreshToken]);
2025-05-03 19:48:02.812 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserRefreshTokens_UserGuid] ON [UserRefreshTokens] ([UserGuid]);
2025-05-03 19:48:02.837 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_Email] ON [Users] ([Email]) WHERE [Email] IS NOT NULL;
2025-05-03 19:48:02.883 +03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_UserGuid] ON [Users] ([UserGuid]);
2025-05-03 19:48:02.928 +03:00 [INF] Executed DbCommand (41ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250503164739_InitialCreate', N'8.0.0');
2025-05-03 19:48:48.900 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 19:48:48.991 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 19:48:49.776 +03:00 [INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 19:48:49.854 +03:00 [INF] Executed DbCommand (45ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 19:48:49.868 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 19:48:49.876 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 19:48:49.926 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 19:48:49.981 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-05-03 19:48:50.633 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 19:48:52.005 +03:00 [INF] Executed DbCommand (117ms) [Parameters=[@p0='2025-05-03T16:48:51.0628762Z', @p1='admin@elearning.com' (Size = 450), @p2=' ' (Size = 4000), @p3='True', @p4='$2a$11$qiBSTf2cLMFvmeAaStMtve0dNq0ZpJlkhh34lfhwQUIJ.06tlKEey' (Size = 4000), @p5='Admin' (Nullable = false) (Size = 4000), @p6=NULL (DbType = DateTime2), @p7='b325bd71-85a4-4c38-ba1d-ca53ce098242' (Nullable = false) (Size = 36), @p8='2025-05-03T16:48:51.3063852Z', @p9='instructor@elearning.com' (Size = 450), @p10=' ' (Size = 4000), @p11='True', @p12='$2a$11$K1AplQb8BdvYvYFG9UZTVuOUCnbJhhtnXMAGuICVOJOHoHyabxwgq' (Size = 4000), @p13='Instructor' (Nullable = false) (Size = 4000), @p14=NULL (DbType = DateTime2), @p15='2c475405-313d-4e59-af72-ffdb891e864c' (Nullable = false) (Size = 36), @p16='2025-05-03T16:48:51.5112261Z', @p17='student@elearning.com' (Size = 450), @p18=' ' (Size = 4000), @p19='True', @p20='$2a$11$EgDk4s.NXSjIVr.8Q/tviuHOVVWsWzdGdMTpMODFCM.vDzsMvy2FK' (Size = 4000), @p21='Student' (Nullable = false) (Size = 4000), @p22=NULL (DbType = DateTime2), @p23='762f99eb-f28a-4e28-9e37-d42c2ff24c07' (Nullable = false) (Size = 36)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Users] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, 0),
(@p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, 1),
(@p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, 2)) AS i ([CreatedAt], [Email], [FullName], [IsEmailConfirmed], [PasswordHash], [Role], [UpdatedAt], [UserGuid], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [Email], [FullName], [IsEmailConfirmed], [PasswordHash], [Role], [UpdatedAt], [UserGuid])
VALUES (i.[CreatedAt], i.[Email], i.[FullName], i.[IsEmailConfirmed], i.[PasswordHash], i.[Role], i.[UpdatedAt], i.[UserGuid])
OUTPUT INSERTED.[Id], i._Position;
2025-05-03 19:48:52.154 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Courses] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 19:48:52.330 +03:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Role] = N'Instructor') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 19:48:52.413 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Role] = N'Instructor'
2025-05-03 19:48:52.592 +03:00 [INF] Executed DbCommand (31ms) [Parameters=[@p0='0', @p1='2025-05-03T16:48:52.4327807Z', @p2='00000000-0000-0000-0000-000000000000', @p3='   ' (Size = 4000), @p4=NULL (Size = 4000), @p5='2', @p6='True' (Nullable = true), @p7=NULL (Nullable = false) (Size = 4000), @p8='0' (Precision = 18) (Scale = 2), @p9='  ' (Size = 450), @p10=NULL (DbType = DateTime2), @p11='0', @p12='2025-05-03T16:48:52.4328356Z', @p13='00000000-0000-0000-0000-000000000000', @p14='      ASP.NET Core' (Size = 4000), @p15=NULL (Size = 4000), @p16='2', @p17='True' (Nullable = true), @p18=NULL (Nullable = false) (Size = 4000), @p19='100' (Precision = 18) (Scale = 2), @p20=' ASP.NET Core' (Size = 450), @p21=NULL (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Courses] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, 0),
(@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, 1)) AS i ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt])
VALUES (i.[CategoryId], i.[CreatedAt], i.[CreatedBy], i.[Description], i.[ImageUrl], i.[InstructorId], i.[IsActive], i.[Name], i.[Price], i.[Title], i.[UpdatedAt])
OUTPUT INSERTED.[Id], i._Position;
2025-05-03 19:48:52.643 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'e_learning.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b525d3ee-d9e9-4b02-bded-15b9b00f470b
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b525d3ee-d9e9-4b02-bded-15b9b00f470b
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-03 19:48:52.686 +03:00 [ERR] Database migration failed
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:b525d3ee-d9e9-4b02-bded-15b9b00f470b
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at SeedData.Initialize(IServiceProvider serviceProvider) in C:\Users\ta\OneDrive\Desktop\e_learning\Program.cs:line 357
   at Program.<Main>$(String[] args) in C:\Users\ta\OneDrive\Desktop\e_learning\Program.cs:line 221
2025-05-03 19:48:53.089 +03:00 [INF] Starting application...
2025-05-03 19:48:53.108 +03:00 [INF] User profile is available. Using 'C:\Users\ta\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-03 19:48:53.380 +03:00 [INF] Now listening on: https://localhost:7056
2025-05-03 19:48:53.386 +03:00 [INF] Now listening on: http://localhost:5000
2025-05-03 19:48:53.390 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-03 19:48:53.392 +03:00 [INF] Hosting environment: Development
2025-05-03 19:48:53.394 +03:00 [INF] Content root path: C:\Users\ta\OneDrive\Desktop\e_learning
2025-05-03 19:49:01.626 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Course - application/json 123
2025-05-03 19:49:01.721 +03:00 [INF] CORS policy execution failed.
2025-05-03 19:49:01.722 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 19:49:01.884 +03:00 [INF] Executing endpoint 'e_learning.Controllers.CourseController.AddCourse (e_learning)'
2025-05-03 19:49:01.921 +03:00 [INF] Route matched with {action = "AddCourse", controller = "Course"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddCourse(e_learning.DTOs.Courses.CourseCreateDto) on controller e_learning.Controllers.CourseController (e_learning).
2025-05-03 19:49:02.032 +03:00 [INF] Executed action e_learning.Controllers.CourseController.AddCourse (e_learning) in 103.233ms
2025-05-03 19:49:02.052 +03:00 [INF] Executed endpoint 'e_learning.Controllers.CourseController.AddCourse (e_learning)'
2025-05-03 19:49:02.057 +03:00 [ERR] HTTP POST /api/Course responded 500 in 391.6427 ms
System.FormatException: Unrecognized Guid format.
   at System.Guid.GuidResult.SetFailure(ParseFailure failureKind)
   at System.Guid.TryParseGuid(ReadOnlySpan`1 guidString, GuidResult& result)
   at System.Guid.Parse(ReadOnlySpan`1 input)
   at System.Guid.Parse(String input)
   at e_learning.Controllers.CourseController.AddCourse(CourseCreateDto dto) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\CourseController.cs:line 45
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-03 19:49:02.223 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.FormatException: Unrecognized Guid format.
   at System.Guid.GuidResult.SetFailure(ParseFailure failureKind)
   at System.Guid.TryParseGuid(ReadOnlySpan`1 guidString, GuidResult& result)
   at System.Guid.Parse(ReadOnlySpan`1 input)
   at System.Guid.Parse(String input)
   at e_learning.Controllers.CourseController.AddCourse(CourseCreateDto dto) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\CourseController.cs:line 45
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-03 19:49:02.280 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Course - 500 null text/plain; charset=utf-8 660.4673ms
2025-05-03 19:49:07.673 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/index.html - null null
2025-05-03 19:49:07.832 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/index.html - 200 null text/html;charset=utf-8 159.0486ms
2025-05-03 19:49:07.872 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger-ui/custom.css - null null
2025-05-03 19:49:07.892 +03:00 [INF] HTTP GET /swagger-ui/custom.css responded 404 in 10.0906 ms
2025-05-03 19:49:07.953 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger-ui/custom.css - 404 0 null 80.8232ms
2025-05-03 19:49:07.970 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7056/swagger-ui/custom.css, Response status code: 404
2025-05-03 19:49:08.329 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-03 19:49:08.843 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 513.3167ms
2025-05-03 19:49:41.432 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/login - application/json 73
2025-05-03 19:49:41.439 +03:00 [INF] CORS policy execution failed.
2025-05-03 19:49:41.440 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 19:49:41.454 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 19:49:41.471 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(e_learning.DTOs.UserLoginDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 19:49:41.735 +03:00 [INF] Executed DbCommand (42ms) [Parameters=[@__dto_Email_0='instructor@elearning.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt], [u].[UserGuid]
FROM [Users] AS [u]
WHERE [u].[Email] = @__dto_Email_0
2025-05-03 19:49:42.044 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='2025-05-03T16:49:42.0028095Z', @p1='0', @p2='2025-05-10T16:49:42.0026814Z', @p3='lP+o5hphQN7aYtq6S4EldBy4xN1Y+DtV7CX3PLUC5DPqfxTQiOqjNjJEhIjPpVt6dgai2OSAKYffBsFI3JkqGw==' (Nullable = false) (Size = 450), @p4='2c475405-313d-4e59-af72-ffdb891e864c' (Nullable = false) (Size = 36)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserRefreshTokens] ([CreatedAt], [ExpiresIn], [ExpiryDate], [RefreshToken], [UserGuid])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-05-03 19:49:42.058 +03:00 [INF]     : instructor@elearning.com
2025-05-03 19:49:42.066 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[e_learning.DTOs.Responses.LoginResponse, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-03 19:49:42.249 +03:00 [INF] Executed action e_learning.Controllers.AuthController.Login (e_learning) in 776.7275ms
2025-05-03 19:49:42.258 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 19:49:42.264 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 829.1118 ms
2025-05-03 19:49:42.332 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/login - 200 null application/json; charset=utf-8 899.9247ms
2025-05-03 19:50:34.711 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Course - application/json 178
2025-05-03 19:50:34.723 +03:00 [INF] CORS policy execution failed.
2025-05-03 19:50:34.727 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 19:50:34.733 +03:00 [INF] Executing endpoint 'e_learning.Controllers.CourseController.AddCourse (e_learning)'
2025-05-03 19:50:34.734 +03:00 [INF] Route matched with {action = "AddCourse", controller = "Course"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddCourse(e_learning.DTOs.Courses.CourseCreateDto) on controller e_learning.Controllers.CourseController (e_learning).
2025-05-03 19:50:34.741 +03:00 [INF] Executed action e_learning.Controllers.CourseController.AddCourse (e_learning) in 4.4765ms
2025-05-03 19:50:34.745 +03:00 [INF] Executed endpoint 'e_learning.Controllers.CourseController.AddCourse (e_learning)'
2025-05-03 19:50:34.746 +03:00 [ERR] HTTP POST /api/Course responded 500 in 23.7667 ms
System.FormatException: Unrecognized Guid format.
   at System.Guid.GuidResult.SetFailure(ParseFailure failureKind)
   at System.Guid.TryParseGuid(ReadOnlySpan`1 guidString, GuidResult& result)
   at System.Guid.Parse(ReadOnlySpan`1 input)
   at System.Guid.Parse(String input)
   at e_learning.Controllers.CourseController.AddCourse(CourseCreateDto dto) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\CourseController.cs:line 45
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-03 19:50:34.767 +03:00 [ERR] An unhandled exception has occurred while executing the request.
System.FormatException: Unrecognized Guid format.
   at System.Guid.GuidResult.SetFailure(ParseFailure failureKind)
   at System.Guid.TryParseGuid(ReadOnlySpan`1 guidString, GuidResult& result)
   at System.Guid.Parse(ReadOnlySpan`1 input)
   at System.Guid.Parse(String input)
   at e_learning.Controllers.CourseController.AddCourse(CourseCreateDto dto) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\CourseController.cs:line 45
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-03 19:50:34.784 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Course - 500 null text/plain; charset=utf-8 72.8704ms
2025-05-03 19:52:02.068 +03:00 [INF] Application is shutting down...
2025-05-03 22:58:01.713 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 22:58:01.854 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 22:58:02.713 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 22:58:51.086 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 22:58:51.492 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 22:58:52.993 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 22:58:53.231 +03:00 [INF] Executed DbCommand (89ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 22:58:53.247 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 22:58:53.264 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 22:58:53.421 +03:00 [INF] Executed DbCommand (88ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 22:58:53.457 +03:00 [INF] Applying migration '20250503195804_final'.
2025-05-03 22:58:53.853 +03:00 [INF] Executed DbCommand (137ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [LessonProgresses] DROP CONSTRAINT [FK_LessonProgresses_Users_UserGuid];
2025-05-03 22:58:53.873 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [QuizResults] DROP CONSTRAINT [FK_QuizResults_Users_UserGuid];
2025-05-03 22:58:53.904 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [UserRefreshTokens] DROP CONSTRAINT [FK_UserRefreshTokens_Users_UserGuid];
2025-05-03 22:58:53.939 +03:00 [INF] Executed DbCommand (27ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Users] DROP CONSTRAINT [AK_Users_UserGuid];
2025-05-03 22:58:53.960 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_Users_UserGuid] ON [Users];
2025-05-03 22:58:53.975 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_UserRefreshTokens_UserGuid] ON [UserRefreshTokens];
2025-05-03 22:58:53.985 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_QuizResults_UserGuid] ON [QuizResults];
2025-05-03 22:58:54.037 +03:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_LessonProgresses_UserGuid] ON [LessonProgresses];
2025-05-03 22:58:54.265 +03:00 [INF] Executed DbCommand (222ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var0 sysname;
SELECT @var0 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Users]') AND [c].[name] = N'UserGuid');
IF @var0 IS NOT NULL EXEC(N'ALTER TABLE [Users] DROP CONSTRAINT [' + @var0 + '];');
ALTER TABLE [Users] DROP COLUMN [UserGuid];
2025-05-03 22:58:54.344 +03:00 [INF] Executed DbCommand (70ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var1 sysname;
SELECT @var1 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[UserRefreshTokens]') AND [c].[name] = N'UserGuid');
IF @var1 IS NOT NULL EXEC(N'ALTER TABLE [UserRefreshTokens] DROP CONSTRAINT [' + @var1 + '];');
ALTER TABLE [UserRefreshTokens] DROP COLUMN [UserGuid];
2025-05-03 22:58:54.417 +03:00 [INF] Executed DbCommand (69ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var2 sysname;
SELECT @var2 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[QuizResults]') AND [c].[name] = N'UserGuid');
IF @var2 IS NOT NULL EXEC(N'ALTER TABLE [QuizResults] DROP CONSTRAINT [' + @var2 + '];');
ALTER TABLE [QuizResults] DROP COLUMN [UserGuid];
2025-05-03 22:58:54.481 +03:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var3 sysname;
SELECT @var3 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[LessonProgresses]') AND [c].[name] = N'UserGuid');
IF @var3 IS NOT NULL EXEC(N'ALTER TABLE [LessonProgresses] DROP CONSTRAINT [' + @var3 + '];');
ALTER TABLE [LessonProgresses] DROP COLUMN [UserGuid];
2025-05-03 22:58:54.524 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [UserRefreshTokens] ADD [UserId] int NOT NULL DEFAULT 0;
2025-05-03 22:58:54.629 +03:00 [INF] Executed DbCommand (99ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var4 sysname;
SELECT @var4 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Quizzes]') AND [c].[name] = N'CreatedBy');
IF @var4 IS NOT NULL EXEC(N'ALTER TABLE [Quizzes] DROP CONSTRAINT [' + @var4 + '];');
ALTER TABLE [Quizzes] ALTER COLUMN [CreatedBy] int NOT NULL;
2025-05-03 22:58:54.696 +03:00 [INF] Executed DbCommand (59ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP INDEX [IX_QuizResults_QuizId_UserId_CompletedAt] ON [QuizResults];
DECLARE @var5 sysname;
SELECT @var5 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[QuizResults]') AND [c].[name] = N'UserId');
IF @var5 IS NOT NULL EXEC(N'ALTER TABLE [QuizResults] DROP CONSTRAINT [' + @var5 + '];');
ALTER TABLE [QuizResults] ALTER COLUMN [UserId] int NOT NULL;
CREATE INDEX [IX_QuizResults_QuizId_UserId_CompletedAt] ON [QuizResults] ([QuizId], [UserId], [CompletedAt]);
2025-05-03 22:58:54.765 +03:00 [INF] Executed DbCommand (56ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var6 sysname;
SELECT @var6 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Lessons]') AND [c].[name] = N'CreatedBy');
IF @var6 IS NOT NULL EXEC(N'ALTER TABLE [Lessons] DROP CONSTRAINT [' + @var6 + '];');
ALTER TABLE [Lessons] ALTER COLUMN [CreatedBy] int NOT NULL;
2025-05-03 22:58:54.867 +03:00 [INF] Executed DbCommand (97ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var7 sysname;
SELECT @var7 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[LessonProgresses]') AND [c].[name] = N'UserId');
IF @var7 IS NOT NULL EXEC(N'ALTER TABLE [LessonProgresses] DROP CONSTRAINT [' + @var7 + '];');
ALTER TABLE [LessonProgresses] ALTER COLUMN [UserId] int NOT NULL;
2025-05-03 22:58:54.955 +03:00 [ERR] Failed executing DbCommand (80ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @var8 sysname;
SELECT @var8 = [d].[name]
FROM [sys].[default_constraints] [d]
INNER JOIN [sys].[columns] [c] ON [d].[parent_column_id] = [c].[column_id] AND [d].[parent_object_id] = [c].[object_id]
WHERE ([d].[parent_object_id] = OBJECT_ID(N'[Courses]') AND [c].[name] = N'CreatedBy');
IF @var8 IS NOT NULL EXEC(N'ALTER TABLE [Courses] DROP CONSTRAINT [' + @var8 + '];');
ALTER TABLE [Courses] ALTER COLUMN [CreatedBy] int NOT NULL;
2025-05-03 23:00:47.963 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 23:00:48.106 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 23:00:48.881 +03:00 [INF] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 23:00:49.040 +03:00 [INF] Executed DbCommand (94ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [E_LearningDB] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2025-05-03 23:00:49.250 +03:00 [INF] Executed DbCommand (206ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [E_LearningDB];
2025-05-03 23:01:33.388 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 23:01:33.479 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 23:01:33.949 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 23:02:01.469 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 23:02:01.676 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 23:02:03.587 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 23:02:04.431 +03:00 [INF] Executed DbCommand (588ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [E_LearningDB];
2025-05-03 23:02:04.541 +03:00 [INF] Executed DbCommand (98ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [E_LearningDB] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-05-03 23:02:04.581 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 23:02:04.832 +03:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [__EFMigrationsHistory] (
    [MigrationId] nvarchar(150) NOT NULL,
    [ProductVersion] nvarchar(32) NOT NULL,
    CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
);
2025-05-03 23:02:04.843 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 23:02:04.873 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 23:02:04.901 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 23:02:04.935 +03:00 [INF] Applying migration '20250503200134_final'.
2025-05-03 23:02:05.243 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Categories] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Categories] PRIMARY KEY ([Id])
);
2025-05-03 23:02:05.257 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [EmailConfirmationCodes] (
    [Id] int NOT NULL IDENTITY,
    [Email] nvarchar(450) NOT NULL,
    [Code] nvarchar(6) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_EmailConfirmationCodes] PRIMARY KEY ([Id])
);
2025-05-03 23:02:05.267 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [PasswordResetCodes] (
    [Id] int NOT NULL IDENTITY,
    [Email] nvarchar(450) NOT NULL,
    [Code] nvarchar(6) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    CONSTRAINT [PK_PasswordResetCodes] PRIMARY KEY ([Id])
);
2025-05-03 23:02:05.281 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Users] (
    [Id] int NOT NULL IDENTITY,
    [FullName] nvarchar(max) NULL,
    [Email] nvarchar(450) NULL,
    [PasswordHash] nvarchar(max) NULL,
    [Role] nvarchar(max) NOT NULL,
    [IsEmailConfirmed] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NULL,
    CONSTRAINT [PK_Users] PRIMARY KEY ([Id])
);
2025-05-03 23:02:05.299 +03:00 [INF] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Courses] (
    [Id] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NOT NULL,
    [Title] nvarchar(450) NULL,
    [Description] nvarchar(max) NULL,
    [Price] decimal(18,2) NOT NULL,
    [ImageUrl] nvarchar(max) NULL,
    [IsActive] bit NULL,
    [CategoryId] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [UpdatedAt] datetime2 NULL,
    [CreatedBy] int NOT NULL,
    [InstructorId] int NOT NULL,
    CONSTRAINT [PK_Courses] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Courses_Categories_CategoryId] FOREIGN KEY ([CategoryId]) REFERENCES [Categories] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Courses_Users_InstructorId] FOREIGN KEY ([InstructorId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 23:02:05.315 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Notifications] (
    [Id] uniqueidentifier NOT NULL,
    [Title] nvarchar(100) NOT NULL,
    [Message] nvarchar(max) NOT NULL,
    [UserId] int NOT NULL,
    [SenderId] nvarchar(max) NULL,
    [IsRead] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NULL,
    [NotificationType] nvarchar(max) NOT NULL,
    CONSTRAINT [PK_Notifications] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Notifications_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 23:02:05.329 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Profiles] (
    [Id] int NOT NULL IDENTITY,
    [Bio] nvarchar(max) NULL,
    [ProfilePicture] nvarchar(max) NULL,
    [Address] nvarchar(max) NULL,
    [Phone] nvarchar(max) NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    [UserId] int NOT NULL,
    CONSTRAINT [PK_Profiles] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Profiles_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 23:02:05.343 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserRefreshTokens] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [RefreshToken] nvarchar(450) NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [ExpiresIn] int NOT NULL,
    CONSTRAINT [PK_UserRefreshTokens] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_UserRefreshTokens_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 23:02:05.352 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Enrollments] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [CourseId] int NOT NULL,
    CONSTRAINT [PK_Enrollments] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Enrollments_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_Enrollments_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 23:02:05.367 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Lessons] (
    [Id] int NOT NULL IDENTITY,
    [Title] nvarchar(200) NOT NULL,
    [Description] nvarchar(1000) NOT NULL,
    [Type] nvarchar(20) NOT NULL,
    [Content] nvarchar(max) NOT NULL,
    [VideoUrl] nvarchar(max) NOT NULL,
    [PdfUrl] nvarchar(max) NOT NULL,
    [Duration] int NOT NULL,
    [IsFree] bit NOT NULL,
    [IsSequential] bit NOT NULL,
    [Order] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [UpdatedAt] datetime2 NULL,
    [CreatedBy] int NOT NULL,
    [CourseId] int NOT NULL,
    CONSTRAINT [PK_Lessons] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Lessons_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE
);
2025-05-03 23:02:05.384 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Messages] (
    [Id] int NOT NULL IDENTITY,
    [SenderId] int NOT NULL,
    [CourseId] int NOT NULL,
    [Text] nvarchar(max) NULL,
    [AttachmentUrl] nvarchar(max) NULL,
    [SentAt] datetime2 NOT NULL,
    [ReplyToMessageId] int NULL,
    [IsSeen] bit NOT NULL,
    CONSTRAINT [PK_Messages] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Messages_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Messages_Messages_ReplyToMessageId] FOREIGN KEY ([ReplyToMessageId]) REFERENCES [Messages] ([Id]),
    CONSTRAINT [FK_Messages_Users_SenderId] FOREIGN KEY ([SenderId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 23:02:05.402 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Payments] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [CourseId] int NOT NULL,
    [Amount] decimal(18,2) NOT NULL,
    [PaymentMethod] nvarchar(max) NULL,
    [IsSuccessful] bit NOT NULL,
    [PaidAt] datetime2 NOT NULL,
    [TransactionId] nvarchar(max) NULL,
    CONSTRAINT [PK_Payments] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Payments_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Payments_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 23:02:05.434 +03:00 [INF] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Reviews] (
    [Id] int NOT NULL IDENTITY,
    [CourseId] int NOT NULL,
    [UserId] int NOT NULL,
    [Rating] int NOT NULL,
    [Comment] nvarchar(max) NULL,
    CONSTRAINT [PK_Reviews] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Reviews_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Reviews_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 23:02:05.611 +03:00 [INF] Executed DbCommand (108ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [LessonMaterials] (
    [Id] int NOT NULL IDENTITY,
    [FileName] nvarchar(max) NOT NULL,
    [FileUrl] nvarchar(max) NOT NULL,
    [Description] nvarchar(max) NOT NULL,
    [FileSize] bigint NOT NULL,
    [UploadedAt] datetime2 NOT NULL,
    [UploadedById] nvarchar(max) NOT NULL,
    [LessonId] int NOT NULL,
    CONSTRAINT [PK_LessonMaterials] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_LessonMaterials_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE
);
2025-05-03 23:02:05.634 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [LessonProgresses] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [IsCompleted] bit NOT NULL DEFAULT CAST(0 AS bit),
    [ProgressPercentage] int NOT NULL DEFAULT 0,
    [StartedAt] datetime2 NULL,
    [CompletedAt] datetime2 NULL,
    [TimeSpent] time NOT NULL,
    [LessonId] int NOT NULL,
    CONSTRAINT [PK_LessonProgresses] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_LessonProgresses_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_LessonProgresses_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE CASCADE
);
2025-05-03 23:02:05.752 +03:00 [INF] Executed DbCommand (110ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Quizzes] (
    [Id] int NOT NULL IDENTITY,
    [Title] nvarchar(max) NOT NULL,
    [Description] nvarchar(max) NOT NULL,
    [PassingScore] int NOT NULL DEFAULT 70,
    [IsMandatory] bit NOT NULL,
    [MaxAttempts] int NOT NULL,
    [TimeLimitMinutes] int NOT NULL,
    [CreatedAt] datetime2 NOT NULL DEFAULT (GETDATE()),
    [CreatedBy] int NOT NULL,
    [Status] int NOT NULL,
    [LessonId] int NOT NULL,
    [CourseId] int NULL,
    [LessonId1] int NULL,
    CONSTRAINT [PK_Quizzes] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Quizzes_Courses_CourseId] FOREIGN KEY ([CourseId]) REFERENCES [Courses] ([Id]),
    CONSTRAINT [FK_Quizzes_Lessons_LessonId] FOREIGN KEY ([LessonId]) REFERENCES [Lessons] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_Quizzes_Lessons_LessonId1] FOREIGN KEY ([LessonId1]) REFERENCES [Lessons] ([Id])
);
2025-05-03 23:02:05.798 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Questions] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [Type] int NOT NULL,
    [Points] int NOT NULL,
    [QuizId] int NOT NULL,
    CONSTRAINT [PK_Questions] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Questions_Quizzes_QuizId] FOREIGN KEY ([QuizId]) REFERENCES [Quizzes] ([Id]) ON DELETE CASCADE
);
2025-05-03 23:02:05.828 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [QuizResults] (
    [Id] int NOT NULL IDENTITY,
    [UserId] int NOT NULL,
    [Score] decimal(5,2) NOT NULL,
    [IsPassed] bit NOT NULL,
    [StartedAt] datetime2 NOT NULL,
    [CompletedAt] datetime2 NULL,
    [Status] int NOT NULL,
    [QuizId] int NOT NULL,
    CONSTRAINT [PK_QuizResults] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_QuizResults_Quizzes_QuizId] FOREIGN KEY ([QuizId]) REFERENCES [Quizzes] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_QuizResults_Users_UserId] FOREIGN KEY ([UserId]) REFERENCES [Users] ([Id]) ON DELETE NO ACTION
);
2025-05-03 23:02:05.845 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Answers] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL DEFAULT CAST(0 AS bit),
    [QuestionId] int NOT NULL,
    CONSTRAINT [PK_Answers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Answers_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE CASCADE
);
2025-05-03 23:02:05.864 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Choice] (
    [Id] int NOT NULL IDENTITY,
    [Text] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL,
    [QuestionId] int NOT NULL,
    CONSTRAINT [PK_Choice] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_Choice_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE CASCADE
);
2025-05-03 23:02:05.878 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [UserAnswers] (
    [Id] int NOT NULL IDENTITY,
    [AnswerText] nvarchar(max) NOT NULL,
    [IsCorrect] bit NOT NULL,
    [ChoiceId] int NULL,
    [QuestionId] int NOT NULL,
    [QuizResultId] int NOT NULL,
    [AnswerId] int NOT NULL,
    CONSTRAINT [PK_UserAnswers] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_UserAnswers_Answers_AnswerId] FOREIGN KEY ([AnswerId]) REFERENCES [Answers] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_UserAnswers_Choice_ChoiceId] FOREIGN KEY ([ChoiceId]) REFERENCES [Choice] ([Id]),
    CONSTRAINT [FK_UserAnswers_Questions_QuestionId] FOREIGN KEY ([QuestionId]) REFERENCES [Questions] ([Id]) ON DELETE NO ACTION,
    CONSTRAINT [FK_UserAnswers_QuizResults_QuizResultId] FOREIGN KEY ([QuizResultId]) REFERENCES [QuizResults] ([Id]) ON DELETE CASCADE
);
2025-05-03 23:02:05.895 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Answers_QuestionId] ON [Answers] ([QuestionId]);
2025-05-03 23:02:05.902 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Choice_QuestionId] ON [Choice] ([QuestionId]);
2025-05-03 23:02:05.911 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_CategoryId] ON [Courses] ([CategoryId]);
2025-05-03 23:02:05.917 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_InstructorId] ON [Courses] ([InstructorId]);
2025-05-03 23:02:05.931 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Courses_Title] ON [Courses] ([Title]);
2025-05-03 23:02:05.947 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_EmailConfirmationCodes_Email] ON [EmailConfirmationCodes] ([Email]);
2025-05-03 23:02:05.952 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Enrollments_CourseId] ON [Enrollments] ([CourseId]);
2025-05-03 23:02:05.963 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Enrollments_UserId] ON [Enrollments] ([UserId]);
2025-05-03 23:02:05.976 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonMaterials_LessonId] ON [LessonMaterials] ([LessonId]);
2025-05-03 23:02:05.987 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonProgresses_LessonId] ON [LessonProgresses] ([LessonId]);
2025-05-03 23:02:05.997 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_LessonProgresses_UserId] ON [LessonProgresses] ([UserId]);
2025-05-03 23:02:06.009 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Lessons_CourseId_Order] ON [Lessons] ([CourseId], [Order]);
2025-05-03 23:02:06.017 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_CourseId] ON [Messages] ([CourseId]);
2025-05-03 23:02:06.028 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_ReplyToMessageId] ON [Messages] ([ReplyToMessageId]);
2025-05-03 23:02:06.046 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Messages_SenderId] ON [Messages] ([SenderId]);
2025-05-03 23:02:06.085 +03:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Notifications_UserId] ON [Notifications] ([UserId]);
2025-05-03 23:02:06.114 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_PasswordResetCodes_Email] ON [PasswordResetCodes] ([Email]);
2025-05-03 23:02:06.130 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_CourseId] ON [Payments] ([CourseId]);
2025-05-03 23:02:06.149 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Payments_UserId] ON [Payments] ([UserId]);
2025-05-03 23:02:06.170 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Profiles_UserId] ON [Profiles] ([UserId]);
2025-05-03 23:02:06.194 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Questions_QuizId] ON [Questions] ([QuizId]);
2025-05-03 23:02:06.229 +03:00 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_QuizId_UserId_CompletedAt] ON [QuizResults] ([QuizId], [UserId], [CompletedAt]);
2025-05-03 23:02:06.243 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_QuizResults_UserId] ON [QuizResults] ([UserId]);
2025-05-03 23:02:06.249 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Quizzes_CourseId] ON [Quizzes] ([CourseId]);
2025-05-03 23:02:06.254 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Quizzes_LessonId] ON [Quizzes] ([LessonId]);
2025-05-03 23:02:06.275 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Quizzes_LessonId1] ON [Quizzes] ([LessonId1]) WHERE [LessonId1] IS NOT NULL;
2025-05-03 23:02:06.285 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_CourseId] ON [Reviews] ([CourseId]);
2025-05-03 23:02:06.299 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Reviews_UserId] ON [Reviews] ([UserId]);
2025-05-03 23:02:06.313 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_AnswerId] ON [UserAnswers] ([AnswerId]);
2025-05-03 23:02:06.321 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_ChoiceId] ON [UserAnswers] ([ChoiceId]);
2025-05-03 23:02:06.327 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_QuestionId] ON [UserAnswers] ([QuestionId]);
2025-05-03 23:02:06.333 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserAnswers_QuizResultId] ON [UserAnswers] ([QuizResultId]);
2025-05-03 23:02:06.342 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_UserRefreshTokens_RefreshToken] ON [UserRefreshTokens] ([RefreshToken]);
2025-05-03 23:02:06.350 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_UserRefreshTokens_UserId] ON [UserRefreshTokens] ([UserId]);
2025-05-03 23:02:06.358 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [IX_Users_Email] ON [Users] ([Email]) WHERE [Email] IS NOT NULL;
2025-05-03 23:02:06.378 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250503200134_final', N'8.0.0');
2025-05-03 23:03:11.328 +03:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data; this mode should only be enabled during development.
2025-05-03 23:03:11.448 +03:00 [WRN] The foreign key property 'Quiz.LessonId1' was created in shadow state because a conflicting property with the simple name 'LessonId' exists in the entity type, but is either not mapped, is already used for another relationship, or is incompatible with the associated primary key type. See https://aka.ms/efcore-relationships for information on mapping relationships in EF Core.
2025-05-03 23:03:12.618 +03:00 [INF] Executed DbCommand (148ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 23:03:12.766 +03:00 [INF] Executed DbCommand (59ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 23:03:12.790 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-03 23:03:12.811 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-03 23:03:12.934 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-03 23:03:13.189 +03:00 [INF] No migrations were applied. The database is already up to date.
2025-05-03 23:03:13.903 +03:00 [INF] Executed DbCommand (33ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 23:03:15.230 +03:00 [INF] Executed DbCommand (94ms) [Parameters=[@p0='2025-05-03T20:03:14.3105210Z', @p1='admin@elearning.com' (Size = 450), @p2=' ' (Size = 4000), @p3='True', @p4='$2a$11$EWULKNy08DMuCVdXmcLgQ.KumOkSc3oMYZG9qGBol0Tlq6I/ExvTC' (Size = 4000), @p5='Admin' (Nullable = false) (Size = 4000), @p6=NULL (DbType = DateTime2), @p7='2025-05-03T20:03:14.5647313Z', @p8='instructor@elearning.com' (Size = 450), @p9=' ' (Size = 4000), @p10='True', @p11='$2a$11$ou2sr8DinPdejB66Xg6gKOlm.r29e8xo3Fit64uacHdqLGEXeyeRe' (Size = 4000), @p12='Instructor' (Nullable = false) (Size = 4000), @p13=NULL (DbType = DateTime2), @p14='2025-05-03T20:03:14.7869147Z', @p15='student@elearning.com' (Size = 450), @p16=' ' (Size = 4000), @p17='True', @p18='$2a$11$lavjdyIwYhZdtoVXjARhbOA0n9TPwNDO5VaRTsX.pclGGEiEcdZ/i' (Size = 4000), @p19='Student' (Nullable = false) (Size = 4000), @p20=NULL (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Users] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, 0),
(@p7, @p8, @p9, @p10, @p11, @p12, @p13, 1),
(@p14, @p15, @p16, @p17, @p18, @p19, @p20, 2)) AS i ([CreatedAt], [Email], [FullName], [IsEmailConfirmed], [PasswordHash], [Role], [UpdatedAt], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [Email], [FullName], [IsEmailConfirmed], [PasswordHash], [Role], [UpdatedAt])
VALUES (i.[CreatedAt], i.[Email], i.[FullName], i.[IsEmailConfirmed], i.[PasswordHash], i.[Role], i.[UpdatedAt])
OUTPUT INSERTED.[Id], i._Position;
2025-05-03 23:03:15.324 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Courses] AS [c]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 23:03:15.403 +03:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Role] = N'Instructor') THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 23:03:15.524 +03:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt]
FROM [Users] AS [u]
WHERE [u].[Role] = N'Instructor'
2025-05-03 23:03:15.699 +03:00 [INF] Executed DbCommand (54ms) [Parameters=[@p0='0', @p1='2025-05-03T20:03:15.5447400Z', @p2='0', @p3='   ' (Size = 4000), @p4=NULL (Size = 4000), @p5='2', @p6='True' (Nullable = true), @p7=NULL (Nullable = false) (Size = 4000), @p8='0' (Precision = 18) (Scale = 2), @p9='  ' (Size = 450), @p10=NULL (DbType = DateTime2), @p11='0', @p12='2025-05-03T20:03:15.5447933Z', @p13='0', @p14='      ASP.NET Core' (Size = 4000), @p15=NULL (Size = 4000), @p16='2', @p17='True' (Nullable = true), @p18=NULL (Nullable = false) (Size = 4000), @p19='100' (Precision = 18) (Scale = 2), @p20=' ASP.NET Core' (Size = 450), @p21=NULL (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
MERGE [Courses] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, 0),
(@p11, @p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, 1)) AS i ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt])
VALUES (i.[CategoryId], i.[CreatedAt], i.[CreatedBy], i.[Description], i.[ImageUrl], i.[InstructorId], i.[IsActive], i.[Name], i.[Price], i.[Title], i.[UpdatedAt])
OUTPUT INSERTED.[Id], i._Position;
2025-05-03 23:03:15.769 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'e_learning.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4a4443f5-d15f-49b0-9abd-6655704cb653
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4a4443f5-d15f-49b0-9abd-6655704cb653
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-03 23:03:15.825 +03:00 [ERR] Database migration failed
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Name', table 'E_LearningDB.dbo.Courses'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:4a4443f5-d15f-49b0-9abd-6655704cb653
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at SeedData.Initialize(IServiceProvider serviceProvider) in C:\Users\ta\OneDrive\Desktop\e_learning\Program.cs:line 357
   at Program.<Main>$(String[] args) in C:\Users\ta\OneDrive\Desktop\e_learning\Program.cs:line 221
2025-05-03 23:03:16.209 +03:00 [INF] Starting application...
2025-05-03 23:03:16.236 +03:00 [INF] User profile is available. Using 'C:\Users\ta\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-03 23:03:16.511 +03:00 [INF] Now listening on: https://localhost:7056
2025-05-03 23:03:16.520 +03:00 [INF] Now listening on: http://localhost:5000
2025-05-03 23:03:16.526 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-03 23:03:16.529 +03:00 [INF] Hosting environment: Development
2025-05-03 23:03:16.530 +03:00 [INF] Content root path: C:\Users\ta\OneDrive\Desktop\e_learning
2025-05-03 23:03:40.309 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/index.html - null null
2025-05-03 23:03:40.635 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/index.html - 200 null text/html;charset=utf-8 333.7036ms
2025-05-03 23:03:40.745 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger-ui/custom.css - null null
2025-05-03 23:03:40.968 +03:00 [INF] HTTP GET /swagger-ui/custom.css responded 404 in 177.2370 ms
2025-05-03 23:03:40.971 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger-ui/custom.css - 404 0 null 225.8472ms
2025-05-03 23:03:40.976 +03:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7056/swagger-ui/custom.css, Response status code: 404
2025-05-03 23:03:41.482 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - null null
2025-05-03 23:03:42.040 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 558.0274ms
2025-05-03 23:04:29.907 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/register - application/json 109
2025-05-03 23:04:29.917 +03:00 [INF] CORS policy execution failed.
2025-05-03 23:04:29.919 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 23:04:29.937 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.Register (e_learning)'
2025-05-03 23:04:29.986 +03:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(e_learning.DTOs.UserRegisterDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 23:04:30.224 +03:00 [INF] Executed DbCommand (22ms) [Parameters=[@__dto_Email_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Users] AS [u]
        WHERE [u].[Email] = @__dto_Email_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-05-03 23:04:30.498 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@p0='2025-05-03T20:04:30.4574025Z', @p1='abdomoka2018@gmail.com' (Size = 450), @p2='Abdo' (Size = 4000), @p3='False', @p4='$2a$11$ytEMzSmV6ZPypBbO/gtV6uAUZjYRrqC4QeRIFFwKcdDwDhA0/fOJu' (Size = 4000), @p5='Student' (Nullable = false) (Size = 4000), @p6=NULL (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([CreatedAt], [Email], [FullName], [IsEmailConfirmed], [PasswordHash], [Role], [UpdatedAt])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-05-03 23:04:30.579 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='228752' (Nullable = false) (Size = 6), @p1='2025-05-03T20:04:30.5195294Z', @p2='abdomoka2018@gmail.com' (Nullable = false) (Size = 450), @p3='2025-05-03T20:14:30.5196295Z'], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [EmailConfirmationCodes] ([Code], [CreatedAt], [Email], [ExpiryDate])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3);
2025-05-03 23:04:33.683 +03:00 [INF]     abdomoka2018@gmail.com 
2025-05-03 23:04:33.686 +03:00 [INF]     - ID: 4
2025-05-03 23:04:33.703 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[e_learning.DTOs.Responses.RegisterResponse, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-03 23:04:33.788 +03:00 [INF] Executed action e_learning.Controllers.AuthController.Register (e_learning) in 3782.5923ms
2025-05-03 23:04:33.838 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.Register (e_learning)'
2025-05-03 23:04:33.856 +03:00 [INF] HTTP POST /api/Auth/register responded 200 in 3944.8304 ms
2025-05-03 23:04:33.879 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/register - 200 null application/json; charset=utf-8 3971.8869ms
2025-05-03 23:05:17.024 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/confirm-email - application/json 59
2025-05-03 23:05:17.034 +03:00 [INF] CORS policy execution failed.
2025-05-03 23:05:17.035 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 23:05:17.085 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.ConfirmEmail (e_learning)'
2025-05-03 23:05:17.099 +03:00 [INF] Route matched with {action = "ConfirmEmail", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ConfirmEmail(e_learning.DTOs.ConfirmEmailDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 23:05:17.181 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@__ToLower_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[Id], [e].[Code], [e].[CreatedAt], [e].[Email], [e].[ExpiryDate]
FROM [EmailConfirmationCodes] AS [e]
WHERE [e].[Email] = @__ToLower_0 AND [e].[ExpiryDate] > GETUTCDATE()
ORDER BY [e].[ExpiryDate] DESC
2025-05-03 23:05:17.216 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__dto_Email_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt]
FROM [Users] AS [u]
WHERE [u].[Email] = @__dto_Email_0
2025-05-03 23:05:17.259 +03:00 [INF] Executed DbCommand (17ms) [Parameters=[@p1='4', @p0='True'], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [IsEmailConfirmed] = @p0
OUTPUT 1
WHERE [Id] = @p1;
2025-05-03 23:05:17.295 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__ToLower_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[Id], [e].[Code], [e].[CreatedAt], [e].[Email], [e].[ExpiryDate]
FROM [EmailConfirmationCodes] AS [e]
WHERE [e].[Email] = @__ToLower_0
2025-05-03 23:05:17.323 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='1'], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [EmailConfirmationCodes]
OUTPUT 1
WHERE [Id] = @p0;
2025-05-03 23:05:17.341 +03:00 [INF]     : abdomoka2018@gmail.com
2025-05-03 23:05:17.343 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse'.
2025-05-03 23:05:17.349 +03:00 [INF] Executed action e_learning.Controllers.AuthController.ConfirmEmail (e_learning) in 247.4205ms
2025-05-03 23:05:17.351 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.ConfirmEmail (e_learning)'
2025-05-03 23:05:17.352 +03:00 [INF] HTTP POST /api/Auth/confirm-email responded 200 in 324.7725 ms
2025-05-03 23:05:17.359 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/confirm-email - 200 null application/json; charset=utf-8 334.7287ms
2025-05-03 23:05:32.874 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/login - application/json 66
2025-05-03 23:05:32.880 +03:00 [INF] CORS policy execution failed.
2025-05-03 23:05:32.882 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 23:05:32.884 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 23:05:32.927 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(e_learning.DTOs.UserLoginDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 23:05:33.015 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__dto_Email_0='abdomoka2018@gmail.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt]
FROM [Users] AS [u]
WHERE [u].[Email] = @__dto_Email_0
2025-05-03 23:05:33.357 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='2025-05-03T20:05:33.3328721Z', @p1='0', @p2='2025-05-10T20:05:33.3327944Z', @p3='lEuXLAxzxN2br+oQbkekVasaaoH2pUho6ICy73+E9zrTXqarEtZPEC+dGYclfOhW9dRSh9PFkqs5X8ogG/zQZA==' (Nullable = false) (Size = 450), @p4='4'], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserRefreshTokens] ([CreatedAt], [ExpiresIn], [ExpiryDate], [RefreshToken], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-05-03 23:05:33.364 +03:00 [INF]     : abdomoka2018@gmail.com
2025-05-03 23:05:33.367 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[e_learning.DTOs.Responses.LoginResponse, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-03 23:05:33.383 +03:00 [INF] Executed action e_learning.Controllers.AuthController.Login (e_learning) in 421.811ms
2025-05-03 23:05:33.386 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 23:05:33.390 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 509.3655 ms
2025-05-03 23:05:33.393 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/login - 200 null application/json; charset=utf-8 519.3224ms
2025-05-03 23:06:22.777 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Course - application/json 102
2025-05-03 23:06:22.780 +03:00 [INF] CORS policy execution failed.
2025-05-03 23:06:22.781 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 23:06:22.867 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Instructor)
2025-05-03 23:06:22.873 +03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-05-03 23:06:22.874 +03:00 [INF] HTTP POST /api/Course responded 403 in 94.5382 ms
2025-05-03 23:06:22.876 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Course - 403 0 null 99.1793ms
2025-05-03 23:06:40.131 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Course - null null
2025-05-03 23:06:40.137 +03:00 [INF] Executing endpoint 'e_learning.Controllers.CourseController.GetCourses (e_learning)'
2025-05-03 23:06:40.180 +03:00 [INF] Route matched with {action = "GetCourses", controller = "Course"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses() on controller e_learning.Controllers.CourseController (e_learning).
2025-05-03 23:06:40.227 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CategoryId], [c].[CreatedAt], [c].[CreatedBy], [c].[Description], [c].[ImageUrl], [c].[InstructorId], [c].[IsActive], [c].[Name], [c].[Price], [c].[Title], [c].[UpdatedAt]
FROM [Courses] AS [c]
2025-05-03 23:06:40.238 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Course, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-03 23:06:40.310 +03:00 [INF] Executed action e_learning.Controllers.CourseController.GetCourses (e_learning) in 116.8213ms
2025-05-03 23:06:40.312 +03:00 [INF] Executed endpoint 'e_learning.Controllers.CourseController.GetCourses (e_learning)'
2025-05-03 23:06:40.316 +03:00 [INF] HTTP GET /api/Course responded 200 in 181.5044 ms
2025-05-03 23:06:40.322 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Course - 200 null application/json; charset=utf-8 191.2769ms
2025-05-03 23:07:14.849 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Course/1 - null null
2025-05-03 23:07:14.854 +03:00 [INF] Executing endpoint 'e_learning.Controllers.CourseController.GetCourseById (e_learning)'
2025-05-03 23:07:14.864 +03:00 [INF] Route matched with {action = "GetCourseById", controller = "Course"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseById(Int32) on controller e_learning.Controllers.CourseController (e_learning).
2025-05-03 23:07:15.049 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__id_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[CategoryId], [t].[CreatedAt], [t].[CreatedBy], [t].[Description], [t].[ImageUrl], [t].[InstructorId], [t].[IsActive], [t].[Name], [t].[Price], [t].[Title], [t].[UpdatedAt], [t].[Id0], [t].[Name0], [t].[Id1], [t].[CreatedAt0], [t].[Email], [t].[FullName], [t].[IsEmailConfirmed], [t].[PasswordHash], [t].[Role], [t].[UpdatedAt0], [r].[Id], [r].[Comment], [r].[CourseId], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CategoryId], [c].[CreatedAt], [c].[CreatedBy], [c].[Description], [c].[ImageUrl], [c].[InstructorId], [c].[IsActive], [c].[Name], [c].[Price], [c].[Title], [c].[UpdatedAt], [c0].[Id] AS [Id0], [c0].[Name] AS [Name0], [u].[Id] AS [Id1], [u].[CreatedAt] AS [CreatedAt0], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt] AS [UpdatedAt0]
    FROM [Courses] AS [c]
    INNER JOIN [Categories] AS [c0] ON [c].[CategoryId] = [c0].[Id]
    INNER JOIN [Users] AS [u] ON [c].[InstructorId] = [u].[Id]
    WHERE [c].[Id] = @__id_0
) AS [t]
LEFT JOIN [Reviews] AS [r] ON [t].[Id] = [r].[CourseId]
ORDER BY [t].[Id], [t].[Id0], [t].[Id1]
2025-05-03 23:07:15.066 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'System.String'.
2025-05-03 23:07:15.069 +03:00 [INF] Executed action e_learning.Controllers.CourseController.GetCourseById (e_learning) in 201.0897ms
2025-05-03 23:07:15.071 +03:00 [INF] Executed endpoint 'e_learning.Controllers.CourseController.GetCourseById (e_learning)'
2025-05-03 23:07:15.073 +03:00 [INF] HTTP GET /api/Course/1 responded 404 in 220.4464 ms
2025-05-03 23:07:15.080 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Course/1 - 404 null text/plain; charset=utf-8 231.1155ms
2025-05-03 23:07:47.451 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Dashboard/student - null null
2025-05-03 23:07:47.461 +03:00 [INF] Executing endpoint 'e_learning.Controllers.DashboardController.GetStudentDashboard (e_learning)'
2025-05-03 23:07:47.483 +03:00 [INF] Route matched with {action = "GetStudentDashboard", controller = "Dashboard"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetStudentDashboard() on controller e_learning.Controllers.DashboardController (e_learning).
2025-05-03 23:07:47.557 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__userId_0='4' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[Id], [e].[CourseId], [e].[UserId], [c].[Id], [c].[CategoryId], [c].[CreatedAt], [c].[CreatedBy], [c].[Description], [c].[ImageUrl], [c].[InstructorId], [c].[IsActive], [c].[Name], [c].[Price], [c].[Title], [c].[UpdatedAt]
FROM [Enrollments] AS [e]
INNER JOIN [Courses] AS [c] ON [e].[CourseId] = [c].[Id]
WHERE [e].[UserId] = @__userId_0
2025-05-03 23:07:47.613 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='4' (Nullable = true)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([p].[Amount]), 0.0)
FROM [Payments] AS [p]
WHERE [p].[UserId] = @__userId_0
2025-05-03 23:07:47.629 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.StudentDashboardDto'.
2025-05-03 23:07:47.647 +03:00 [INF] Executed action e_learning.Controllers.DashboardController.GetStudentDashboard (e_learning) in 158.8458ms
2025-05-03 23:07:47.649 +03:00 [INF] Executed endpoint 'e_learning.Controllers.DashboardController.GetStudentDashboard (e_learning)'
2025-05-03 23:07:47.650 +03:00 [INF] HTTP GET /api/Dashboard/student responded 200 in 193.1807 ms
2025-05-03 23:07:47.680 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Dashboard/student - 200 null application/json; charset=utf-8 228.8258ms
2025-05-03 23:07:59.849 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - null null
2025-05-03 23:07:59.860 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:07:59.913 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:08:00.152 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__courseId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:08:00.162 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:08:00.171 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 255.165ms
2025-05-03 23:08:00.174 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:08:00.178 +03:00 [INF] HTTP GET /api/courses/1/Lessons responded 200 in 326.4318 ms
2025-05-03 23:08:00.184 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - 200 null application/json; charset=utf-8 334.6147ms
2025-05-03 23:08:26.793 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Course/1 - null null
2025-05-03 23:08:26.949 +03:00 [INF] Executing endpoint 'e_learning.Controllers.CourseController.GetCourseById (e_learning)'
2025-05-03 23:08:26.992 +03:00 [INF] Route matched with {action = "GetCourseById", controller = "Course"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourseById(Int32) on controller e_learning.Controllers.CourseController (e_learning).
2025-05-03 23:08:27.240 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@__id_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[Id], [t].[CategoryId], [t].[CreatedAt], [t].[CreatedBy], [t].[Description], [t].[ImageUrl], [t].[InstructorId], [t].[IsActive], [t].[Name], [t].[Price], [t].[Title], [t].[UpdatedAt], [t].[Id0], [t].[Name0], [t].[Id1], [t].[CreatedAt0], [t].[Email], [t].[FullName], [t].[IsEmailConfirmed], [t].[PasswordHash], [t].[Role], [t].[UpdatedAt0], [r].[Id], [r].[Comment], [r].[CourseId], [r].[Rating], [r].[UserId]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CategoryId], [c].[CreatedAt], [c].[CreatedBy], [c].[Description], [c].[ImageUrl], [c].[InstructorId], [c].[IsActive], [c].[Name], [c].[Price], [c].[Title], [c].[UpdatedAt], [c0].[Id] AS [Id0], [c0].[Name] AS [Name0], [u].[Id] AS [Id1], [u].[CreatedAt] AS [CreatedAt0], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt] AS [UpdatedAt0]
    FROM [Courses] AS [c]
    INNER JOIN [Categories] AS [c0] ON [c].[CategoryId] = [c0].[Id]
    INNER JOIN [Users] AS [u] ON [c].[InstructorId] = [u].[Id]
    WHERE [c].[Id] = @__id_0
) AS [t]
LEFT JOIN [Reviews] AS [r] ON [t].[Id] = [r].[CourseId]
ORDER BY [t].[Id], [t].[Id0], [t].[Id1]
2025-05-03 23:08:27.251 +03:00 [INF] Executing NotFoundObjectResult, writing value of type 'System.String'.
2025-05-03 23:08:27.253 +03:00 [INF] Executed action e_learning.Controllers.CourseController.GetCourseById (e_learning) in 50.4796ms
2025-05-03 23:08:27.262 +03:00 [INF] Executed endpoint 'e_learning.Controllers.CourseController.GetCourseById (e_learning)'
2025-05-03 23:08:27.264 +03:00 [INF] HTTP GET /api/Course/1 responded 404 in 315.0986 ms
2025-05-03 23:08:27.269 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Course/1 - 404 null text/plain; charset=utf-8 475.4908ms
2025-05-03 23:08:50.972 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/1/Lessons/1 - null null
2025-05-03 23:08:50.975 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLesson (e_learning)'
2025-05-03 23:08:50.982 +03:00 [INF] Route matched with {action = "GetLesson", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLesson(Int32, Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:08:51.059 +03:00 [INF] Executed DbCommand (8ms) [Parameters=[@__courseId_0='1', @__lessonId_1='1'], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [l].[Id], [l].[Content], [l].[CourseId], [l].[CreatedAt], [l].[CreatedBy], [l].[Description], [l].[Duration], [l].[IsFree], [l].[IsSequential], [l].[Order], [l].[PdfUrl], [l].[Title], [l].[Type], [l].[UpdatedAt], [l].[VideoUrl]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0 AND [l].[Id] = @__lessonId_1
2025-05-03 23:08:51.065 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[e_learning.DTOs.e_learning.DTOs.Lessons.LessonResponseDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-03 23:08:51.077 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLesson (e_learning) in 91.5571ms
2025-05-03 23:08:51.079 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLesson (e_learning)'
2025-05-03 23:08:51.080 +03:00 [INF] HTTP GET /api/courses/1/Lessons/1 responded 200 in 105.4809 ms
2025-05-03 23:08:51.083 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/1/Lessons/1 - 200 null application/json; charset=utf-8 111.8514ms
2025-05-03 23:09:00.718 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - null null
2025-05-03 23:09:00.723 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:00.724 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:09:00.744 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__courseId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:09:00.757 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:09:00.763 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 36.2537ms
2025-05-03 23:09:00.766 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:00.768 +03:00 [INF] HTTP GET /api/courses/1/Lessons responded 200 in 45.7876 ms
2025-05-03 23:09:00.775 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - 200 null application/json; charset=utf-8 56.753ms
2025-05-03 23:09:02.079 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - null null
2025-05-03 23:09:02.100 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:02.105 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:09:02.129 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:09:02.137 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:09:02.141 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 25.4ms
2025-05-03 23:09:02.143 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:02.145 +03:00 [INF] HTTP GET /api/courses/1/Lessons responded 200 in 45.3351 ms
2025-05-03 23:09:02.164 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - 200 null application/json; charset=utf-8 84.2044ms
2025-05-03 23:09:02.543 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - null null
2025-05-03 23:09:02.549 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:02.583 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:09:02.610 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__courseId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:09:02.623 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:09:02.626 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 33.9438ms
2025-05-03 23:09:02.638 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:02.642 +03:00 [INF] HTTP GET /api/courses/1/Lessons responded 200 in 93.5206 ms
2025-05-03 23:09:02.711 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - 200 null application/json; charset=utf-8 168.3594ms
2025-05-03 23:09:03.113 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - null null
2025-05-03 23:09:03.149 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:03.164 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:09:03.192 +03:00 [INF] Executed DbCommand (10ms) [Parameters=[@__courseId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:09:03.204 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:09:03.209 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 38.4392ms
2025-05-03 23:09:03.211 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:03.212 +03:00 [INF] HTTP GET /api/courses/1/Lessons responded 200 in 64.1788 ms
2025-05-03 23:09:03.221 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - 200 null application/json; charset=utf-8 108.041ms
2025-05-03 23:09:03.507 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - null null
2025-05-03 23:09:03.510 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:03.511 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:09:03.527 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:09:03.533 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:09:03.540 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 26.6861ms
2025-05-03 23:09:03.542 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:03.543 +03:00 [INF] HTTP GET /api/courses/1/Lessons responded 200 in 33.4233 ms
2025-05-03 23:09:03.547 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - 200 null application/json; charset=utf-8 39.2821ms
2025-05-03 23:09:03.912 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - null null
2025-05-03 23:09:03.916 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:03.920 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:09:03.941 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__courseId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:09:03.949 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:09:03.959 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 36.3312ms
2025-05-03 23:09:03.962 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:03.963 +03:00 [INF] HTTP GET /api/courses/1/Lessons responded 200 in 47.8845 ms
2025-05-03 23:09:03.976 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - 200 null application/json; charset=utf-8 64.297ms
2025-05-03 23:09:07.766 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - null null
2025-05-03 23:09:07.770 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:07.772 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:09:07.802 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:09:07.809 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:09:07.813 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 38.1629ms
2025-05-03 23:09:07.815 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:07.819 +03:00 [INF] HTTP GET /api/courses/1/Lessons responded 200 in 48.7290 ms
2025-05-03 23:09:07.827 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - 200 null application/json; charset=utf-8 61.2434ms
2025-05-03 23:09:19.685 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/2/Lessons - null null
2025-05-03 23:09:19.689 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:19.690 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:09:19.707 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__courseId_0='2'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:09:19.749 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:09:19.754 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 61.8604ms
2025-05-03 23:09:19.761 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:19.762 +03:00 [INF] HTTP GET /api/courses/2/Lessons responded 200 in 73.9978 ms
2025-05-03 23:09:19.768 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/2/Lessons - 200 null application/json; charset=utf-8 83.5846ms
2025-05-03 23:09:24.535 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/8/Lessons - null null
2025-05-03 23:09:24.538 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:24.540 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:09:24.555 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__courseId_0='8'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:09:24.564 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:09:24.568 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 26.4328ms
2025-05-03 23:09:24.571 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:24.573 +03:00 [INF] HTTP GET /api/courses/8/Lessons responded 200 in 35.3192 ms
2025-05-03 23:09:24.576 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/8/Lessons - 200 null application/json; charset=utf-8 41.7295ms
2025-05-03 23:09:27.184 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/8/Lessons - null null
2025-05-03 23:09:27.189 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:27.190 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:09:27.224 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@__courseId_0='8'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:09:27.229 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:09:27.231 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 38.7448ms
2025-05-03 23:09:27.239 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:27.241 +03:00 [INF] HTTP GET /api/courses/8/Lessons responded 200 in 52.4547 ms
2025-05-03 23:09:27.244 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/8/Lessons - 200 null application/json; charset=utf-8 60.4815ms
2025-05-03 23:09:27.520 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/8/Lessons - null null
2025-05-03 23:09:27.524 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:27.527 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:09:27.556 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__courseId_0='8'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:09:27.562 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:09:27.565 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 35.1223ms
2025-05-03 23:09:27.571 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:27.573 +03:00 [INF] HTTP GET /api/courses/8/Lessons responded 200 in 49.8256 ms
2025-05-03 23:09:27.579 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/8/Lessons - 200 null application/json; charset=utf-8 58.6802ms
2025-05-03 23:09:27.928 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/8/Lessons - null null
2025-05-03 23:09:27.931 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:27.935 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:09:27.954 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__courseId_0='8'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:09:27.962 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:09:27.964 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 26.1703ms
2025-05-03 23:09:27.975 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:27.977 +03:00 [INF] HTTP GET /api/courses/8/Lessons responded 200 in 46.4032 ms
2025-05-03 23:09:27.989 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/8/Lessons - 200 null application/json; charset=utf-8 61.6219ms
2025-05-03 23:09:28.268 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/8/Lessons - null null
2025-05-03 23:09:28.275 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:28.276 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:09:28.310 +03:00 [INF] Executed DbCommand (16ms) [Parameters=[@__courseId_0='8'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:09:28.315 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:09:28.323 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 44.2029ms
2025-05-03 23:09:28.325 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:28.326 +03:00 [INF] HTTP GET /api/courses/8/Lessons responded 200 in 51.9421 ms
2025-05-03 23:09:28.330 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/8/Lessons - 200 null application/json; charset=utf-8 61.2856ms
2025-05-03 23:09:28.647 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/8/Lessons - null null
2025-05-03 23:09:28.657 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:28.668 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:09:28.698 +03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__courseId_0='8'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:09:28.711 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:09:28.713 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 33.2151ms
2025-05-03 23:09:28.719 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:28.721 +03:00 [INF] HTTP GET /api/courses/8/Lessons responded 200 in 64.1669 ms
2025-05-03 23:09:28.724 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/8/Lessons - 200 null application/json; charset=utf-8 76.7716ms
2025-05-03 23:09:29.009 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/8/Lessons - null null
2025-05-03 23:09:29.013 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:29.015 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:09:29.030 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__courseId_0='8'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:09:29.044 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:09:29.046 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 25.1668ms
2025-05-03 23:09:29.055 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:09:29.057 +03:00 [INF] HTTP GET /api/courses/8/Lessons responded 200 in 44.1950 ms
2025-05-03 23:09:29.061 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/8/Lessons - 200 null application/json; charset=utf-8 51.8491ms
2025-05-03 23:09:50.713 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/courses/1/Lessons - application/json 208
2025-05-03 23:09:50.717 +03:00 [INF] CORS policy execution failed.
2025-05-03 23:09:50.718 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 23:09:50.721 +03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (Instructor|Admin)
2025-05-03 23:09:50.723 +03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2025-05-03 23:09:50.725 +03:00 [INF] HTTP POST /api/courses/1/Lessons responded 403 in 8.2331 ms
2025-05-03 23:09:50.727 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/courses/1/Lessons - 403 0 null 14.4097ms
2025-05-03 23:13:18.654 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Auth/login - application/json 73
2025-05-03 23:13:18.676 +03:00 [INF] CORS policy execution failed.
2025-05-03 23:13:18.725 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 23:13:18.740 +03:00 [INF] Executing endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 23:13:18.757 +03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(e_learning.DTOs.UserLoginDto) on controller e_learning.Controllers.AuthController (e_learning).
2025-05-03 23:13:18.848 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__dto_Email_0='instructor@elearning.com' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[Email], [u].[FullName], [u].[IsEmailConfirmed], [u].[PasswordHash], [u].[Role], [u].[UpdatedAt]
FROM [Users] AS [u]
WHERE [u].[Email] = @__dto_Email_0
2025-05-03 23:13:19.139 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='2025-05-03T20:13:19.1183650Z', @p1='0', @p2='2025-05-10T20:13:19.1183170Z', @p3='mp6y00C+7o5qHIHaXk40untlwfPkY66UrHS+sQaI+8BxPLYvRNRqQXd9q8jB+r96J8Itjw03mc2aHTJPrS85QQ==' (Nullable = false) (Size = 450), @p4='2'], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [UserRefreshTokens] ([CreatedAt], [ExpiresIn], [ExpiryDate], [RefreshToken], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-05-03 23:13:19.151 +03:00 [INF]     : instructor@elearning.com
2025-05-03 23:13:19.153 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[e_learning.DTOs.Responses.LoginResponse, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-03 23:13:19.155 +03:00 [INF] Executed action e_learning.Controllers.AuthController.Login (e_learning) in 386.7815ms
2025-05-03 23:13:19.157 +03:00 [INF] Executed endpoint 'e_learning.Controllers.AuthController.Login (e_learning)'
2025-05-03 23:13:19.160 +03:00 [INF] HTTP POST /api/Auth/login responded 200 in 487.3654 ms
2025-05-03 23:13:19.164 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Auth/login - 200 null application/json; charset=utf-8 519.208ms
2025-05-03 23:13:42.848 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Course - application/json 102
2025-05-03 23:13:42.851 +03:00 [INF] CORS policy execution failed.
2025-05-03 23:13:42.853 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 23:13:42.857 +03:00 [INF] Executing endpoint 'e_learning.Controllers.CourseController.AddCourse (e_learning)'
2025-05-03 23:13:42.878 +03:00 [INF] Route matched with {action = "AddCourse", controller = "Course"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddCourse(e_learning.DTOs.Courses.e_learning.DTOs.Courses.CourseCreateDto) on controller e_learning.Controllers.CourseController (e_learning).
2025-05-03 23:13:42.955 +03:00 [INF] Executed DbCommand (21ms) [Parameters=[@p0='1', @p1='2025-05-03T20:13:42.9073897Z', @p2='2', @p3='string' (Size = 4000), @p4=NULL (Size = 4000), @p5='2', @p6='True' (Nullable = true), @p7='string' (Nullable = false) (Size = 4000), @p8='0' (Precision = 18) (Scale = 2), @p9=NULL (Size = 450), @p10=NULL (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Courses] ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-05-03 23:13:42.985 +03:00 [ERR] An exception occurred in the database while saving changes for context type 'e_learning.Data.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Courses_Categories_CategoryId". The conflict occurred in database "E_LearningDB", table "dbo.Categories", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7f0894c0-ae11-4d52-8aab-0c4dba1c6931
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Courses_Categories_CategoryId". The conflict occurred in database "E_LearningDB", table "dbo.Categories", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7f0894c0-ae11-4d52-8aab-0c4dba1c6931
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-05-03 23:13:43.019 +03:00 [INF] Executed action e_learning.Controllers.CourseController.AddCourse (e_learning) in 137.8951ms
2025-05-03 23:13:43.022 +03:00 [INF] Executed endpoint 'e_learning.Controllers.CourseController.AddCourse (e_learning)'
2025-05-03 23:13:43.025 +03:00 [ERR] HTTP POST /api/Course responded 500 in 173.9980 ms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Courses_Categories_CategoryId". The conflict occurred in database "E_LearningDB", table "dbo.Categories", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7f0894c0-ae11-4d52-8aab-0c4dba1c6931
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at e_learning.Controllers.CourseController.AddCourse(CourseCreateDto dto) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\CourseController.cs:line 56
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
2025-05-03 23:13:43.067 +03:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Courses_Categories_CategoryId". The conflict occurred in database "E_LearningDB", table "dbo.Categories", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7f0894c0-ae11-4d52-8aab-0c4dba1c6931
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at e_learning.Controllers.CourseController.AddCourse(CourseCreateDto dto) in C:\Users\ta\OneDrive\Desktop\e_learning\Controllers\CourseController.cs:line 56
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Serilog.AspNetCore.RequestLoggingMiddleware.Invoke(HttpContext httpContext)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-03 23:13:43.115 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Course - 500 null text/plain; charset=utf-8 266.5211ms
2025-05-03 23:13:56.803 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/Course - null null
2025-05-03 23:13:56.809 +03:00 [INF] Executing endpoint 'e_learning.Controllers.CourseController.GetCourses (e_learning)'
2025-05-03 23:13:56.811 +03:00 [INF] Route matched with {action = "GetCourses", controller = "Course"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCourses() on controller e_learning.Controllers.CourseController (e_learning).
2025-05-03 23:13:56.885 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CategoryId], [c].[CreatedAt], [c].[CreatedBy], [c].[Description], [c].[ImageUrl], [c].[InstructorId], [c].[IsActive], [c].[Name], [c].[Price], [c].[Title], [c].[UpdatedAt]
FROM [Courses] AS [c]
2025-05-03 23:13:56.895 +03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Course, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-03 23:13:56.898 +03:00 [INF] Executed action e_learning.Controllers.CourseController.GetCourses (e_learning) in 29.2536ms
2025-05-03 23:13:56.900 +03:00 [INF] Executed endpoint 'e_learning.Controllers.CourseController.GetCourses (e_learning)'
2025-05-03 23:13:56.901 +03:00 [INF] HTTP GET /api/Course responded 200 in 93.3280 ms
2025-05-03 23:13:56.907 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/Course - 200 null application/json; charset=utf-8 103.3315ms
2025-05-03 23:18:05.816 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Category - application/json 22
2025-05-03 23:18:05.825 +03:00 [INF] CORS policy execution failed.
2025-05-03 23:18:05.869 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 23:18:05.915 +03:00 [INF] Executing endpoint 'e_learning.Controllers.CategoryController.AddCategory (e_learning)'
2025-05-03 23:18:05.964 +03:00 [INF] Route matched with {action = "AddCategory", controller = "Category"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddCategory(e_learning.DTOs.CategoryDto) on controller e_learning.Controllers.CategoryController (e_learning).
2025-05-03 23:18:06.077 +03:00 [INF] Executed DbCommand (29ms) [Parameters=[@p0='string' (Nullable = false) (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Categories] ([Name])
OUTPUT INSERTED.[Id]
VALUES (@p0);
2025-05-03 23:18:06.097 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.Models.Category'.
2025-05-03 23:18:06.100 +03:00 [INF] Executed action e_learning.Controllers.CategoryController.AddCategory (e_learning) in 132.0259ms
2025-05-03 23:18:06.102 +03:00 [INF] Executed endpoint 'e_learning.Controllers.CategoryController.AddCategory (e_learning)'
2025-05-03 23:18:06.103 +03:00 [INF] HTTP POST /api/Category responded 200 in 278.7753 ms
2025-05-03 23:18:06.109 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Category - 200 null application/json; charset=utf-8 293.2978ms
2025-05-03 23:18:14.892 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/Course - application/json 102
2025-05-03 23:18:14.909 +03:00 [INF] CORS policy execution failed.
2025-05-03 23:18:14.909 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 23:18:14.911 +03:00 [INF] Executing endpoint 'e_learning.Controllers.CourseController.AddCourse (e_learning)'
2025-05-03 23:18:14.912 +03:00 [INF] Route matched with {action = "AddCourse", controller = "Course"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddCourse(e_learning.DTOs.Courses.e_learning.DTOs.Courses.CourseCreateDto) on controller e_learning.Controllers.CourseController (e_learning).
2025-05-03 23:18:14.938 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='1', @p1='2025-05-03T20:18:14.9161524Z', @p2='2', @p3='string' (Size = 4000), @p4=NULL (Size = 4000), @p5='2', @p6='True' (Nullable = true), @p7='string' (Nullable = false) (Size = 4000), @p8='0' (Precision = 18) (Scale = 2), @p9=NULL (Size = 450), @p10=NULL (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Courses] ([CategoryId], [CreatedAt], [CreatedBy], [Description], [ImageUrl], [InstructorId], [IsActive], [Name], [Price], [Title], [UpdatedAt])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2025-05-03 23:18:14.960 +03:00 [INF] Executing OkObjectResult, writing value of type 'Course'.
2025-05-03 23:18:14.973 +03:00 [INF] Executed action e_learning.Controllers.CourseController.AddCourse (e_learning) in 58.1762ms
2025-05-03 23:18:14.974 +03:00 [INF] Executed endpoint 'e_learning.Controllers.CourseController.AddCourse (e_learning)'
2025-05-03 23:18:14.975 +03:00 [INF] HTTP POST /api/Course responded 200 in 66.7366 ms
2025-05-03 23:18:14.983 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/Course - 200 null application/json; charset=utf-8 90.4803ms
2025-05-03 23:18:58.681 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/courses/1/Lessons - application/json 208
2025-05-03 23:18:58.689 +03:00 [INF] CORS policy execution failed.
2025-05-03 23:18:58.691 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 23:18:58.693 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.CreateLesson (e_learning)'
2025-05-03 23:18:58.708 +03:00 [INF] Route matched with {action = "CreateLesson", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateLesson(Int32, e_learning.DTOs.CreateLessonDto) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:18:58.791 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-03 23:18:58.848 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.CreateLesson (e_learning) in 137.5528ms
2025-05-03 23:18:58.851 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.CreateLesson (e_learning)'
2025-05-03 23:18:58.853 +03:00 [INF] HTTP POST /api/courses/1/Lessons responded 400 in 168.4151 ms
2025-05-03 23:18:58.856 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/courses/1/Lessons - 400 null application/json; charset=utf-8 174.4223ms
2025-05-03 23:20:15.509 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/courses/1/Lessons - application/json 208
2025-05-03 23:20:15.522 +03:00 [INF] CORS policy execution failed.
2025-05-03 23:20:15.524 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 23:20:15.531 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.CreateLesson (e_learning)'
2025-05-03 23:20:15.537 +03:00 [INF] Route matched with {action = "CreateLesson", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateLesson(Int32, e_learning.DTOs.CreateLessonDto) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:20:15.551 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-03 23:20:15.558 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.CreateLesson (e_learning) in 12.0984ms
2025-05-03 23:20:15.569 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.CreateLesson (e_learning)'
2025-05-03 23:20:15.571 +03:00 [INF] HTTP POST /api/courses/1/Lessons responded 400 in 49.3499 ms
2025-05-03 23:20:15.573 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/courses/1/Lessons - 400 null application/json; charset=utf-8 64.1166ms
2025-05-03 23:21:15.771 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/courses/1/Lessons - text/json 208
2025-05-03 23:21:15.774 +03:00 [INF] CORS policy execution failed.
2025-05-03 23:21:15.775 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 23:21:15.777 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.CreateLesson (e_learning)'
2025-05-03 23:21:15.779 +03:00 [INF] Route matched with {action = "CreateLesson", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateLesson(Int32, e_learning.DTOs.CreateLessonDto) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:21:15.783 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-03 23:21:15.785 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.CreateLesson (e_learning) in 3.5513ms
2025-05-03 23:21:15.786 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.CreateLesson (e_learning)'
2025-05-03 23:21:15.788 +03:00 [INF] HTTP POST /api/courses/1/Lessons responded 400 in 14.0339 ms
2025-05-03 23:21:15.792 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/courses/1/Lessons - 400 null application/json; charset=utf-8 20.52ms
2025-05-03 23:21:19.963 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/courses/1/Lessons - application/*+json 208
2025-05-03 23:21:19.968 +03:00 [INF] CORS policy execution failed.
2025-05-03 23:21:19.968 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 23:21:19.975 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.CreateLesson (e_learning)'
2025-05-03 23:21:19.977 +03:00 [INF] Route matched with {action = "CreateLesson", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateLesson(Int32, e_learning.DTOs.CreateLessonDto) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:21:19.981 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-03 23:21:20.002 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.CreateLesson (e_learning) in 22.1318ms
2025-05-03 23:21:20.003 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.CreateLesson (e_learning)'
2025-05-03 23:21:20.013 +03:00 [INF] HTTP POST /api/courses/1/Lessons responded 400 in 45.4445 ms
2025-05-03 23:21:20.018 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/courses/1/Lessons - 400 null application/json; charset=utf-8 54.3379ms
2025-05-03 23:21:24.726 +03:00 [INF] Request starting HTTP/2 POST https://localhost:7056/api/courses/1/Lessons - application/json 208
2025-05-03 23:21:24.730 +03:00 [INF] CORS policy execution failed.
2025-05-03 23:21:24.730 +03:00 [INF] Request origin https://localhost:7056 does not have permission to access the resource.
2025-05-03 23:21:24.732 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.CreateLesson (e_learning)'
2025-05-03 23:21:24.733 +03:00 [INF] Route matched with {action = "CreateLesson", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateLesson(Int32, e_learning.DTOs.CreateLessonDto) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:21:24.743 +03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-05-03 23:21:24.798 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.CreateLesson (e_learning) in 56.9099ms
2025-05-03 23:21:24.802 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.CreateLesson (e_learning)'
2025-05-03 23:21:24.827 +03:00 [INF] HTTP POST /api/courses/1/Lessons responded 400 in 97.8326 ms
2025-05-03 23:21:24.841 +03:00 [INF] Request finished HTTP/2 POST https://localhost:7056/api/courses/1/Lessons - 400 null application/json; charset=utf-8 115.1232ms
2025-05-03 23:21:36.559 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/8/Lessons - null null
2025-05-03 23:21:36.563 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:21:36.565 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:21:36.610 +03:00 [INF] Executed DbCommand (29ms) [Parameters=[@__courseId_0='8'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:21:36.622 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:21:36.625 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 58.4231ms
2025-05-03 23:21:36.629 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:21:36.633 +03:00 [INF] HTTP GET /api/courses/8/Lessons responded 200 in 69.9721 ms
2025-05-03 23:21:36.642 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/8/Lessons - 200 null application/json; charset=utf-8 83.4912ms
2025-05-03 23:21:41.494 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - null null
2025-05-03 23:21:41.498 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:21:41.500 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:21:41.538 +03:00 [INF] Executed DbCommand (7ms) [Parameters=[@__courseId_0='1'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:21:41.543 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:21:41.545 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 41.0586ms
2025-05-03 23:21:41.547 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:21:41.549 +03:00 [INF] HTTP GET /api/courses/1/Lessons responded 200 in 51.5809 ms
2025-05-03 23:21:41.556 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/1/Lessons - 200 null application/json; charset=utf-8 61.4721ms
2025-05-03 23:21:53.562 +03:00 [INF] Request starting HTTP/2 GET https://localhost:7056/api/courses/7/Lessons - null null
2025-05-03 23:21:53.566 +03:00 [INF] Executing endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:21:53.568 +03:00 [INF] Route matched with {action = "GetLessons", controller = "Lessons"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetLessons(Int32) on controller e_learning.Controllers.LessonsController (e_learning).
2025-05-03 23:21:53.594 +03:00 [INF] Executed DbCommand (12ms) [Parameters=[@__courseId_0='7'], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[Id], [l].[Title], [l].[Description], [l].[Order], [l].[IsFree]
FROM [Lessons] AS [l]
WHERE [l].[CourseId] = @__courseId_0
2025-05-03 23:21:53.600 +03:00 [INF] Executing OkObjectResult, writing value of type 'e_learning.DTOs.Responses.ApiResponse`1[[System.Collections.Generic.List`1[[e_learning.DTOs.LessonBriefDto, e_learning, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-03 23:21:53.606 +03:00 [INF] Executed action e_learning.Controllers.LessonsController.GetLessons (e_learning) in 34.4934ms
2025-05-03 23:21:53.608 +03:00 [INF] Executed endpoint 'e_learning.Controllers.LessonsController.GetLessons (e_learning)'
2025-05-03 23:21:53.610 +03:00 [INF] HTTP GET /api/courses/7/Lessons responded 200 in 44.9360 ms
2025-05-03 23:21:53.616 +03:00 [INF] Request finished HTTP/2 GET https://localhost:7056/api/courses/7/Lessons - 200 null application/json; charset=utf-8 53.5879ms
2025-05-03 23:32:32.651 +03:00 [INF] Application is shutting down...
